(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const m of document.querySelectorAll('link[rel="modulepreload"]'))g(m);new MutationObserver(m=>{for(const _ of m)if(_.type==="childList")for(const y of _.addedNodes)y.tagName==="LINK"&&y.rel==="modulepreload"&&g(y)}).observe(document,{childList:!0,subtree:!0});function u(m){const _={};return m.integrity&&(_.integrity=m.integrity),m.referrerPolicy&&(_.referrerPolicy=m.referrerPolicy),m.crossOrigin==="use-credentials"?_.credentials="include":m.crossOrigin==="anonymous"?_.credentials="omit":_.credentials="same-origin",_}function g(m){if(m.ep)return;m.ep=!0;const _=u(m);fetch(m.href,_)}})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fr=function(r){const e=[];let u=0;for(let g=0;g<r.length;g++){let m=r.charCodeAt(g);m<128?e[u++]=m:m<2048?(e[u++]=m>>6|192,e[u++]=m&63|128):(m&64512)===55296&&g+1<r.length&&(r.charCodeAt(g+1)&64512)===56320?(m=65536+((m&1023)<<10)+(r.charCodeAt(++g)&1023),e[u++]=m>>18|240,e[u++]=m>>12&63|128,e[u++]=m>>6&63|128,e[u++]=m&63|128):(e[u++]=m>>12|224,e[u++]=m>>6&63|128,e[u++]=m&63|128)}return e},qs=function(r){const e=[];let u=0,g=0;for(;u<r.length;){const m=r[u++];if(m<128)e[g++]=String.fromCharCode(m);else if(m>191&&m<224){const _=r[u++];e[g++]=String.fromCharCode((m&31)<<6|_&63)}else if(m>239&&m<365){const _=r[u++],y=r[u++],h=r[u++],t=((m&7)<<18|(_&63)<<12|(y&63)<<6|h&63)-65536;e[g++]=String.fromCharCode(55296+(t>>10)),e[g++]=String.fromCharCode(56320+(t&1023))}else{const _=r[u++],y=r[u++];e[g++]=String.fromCharCode((m&15)<<12|(_&63)<<6|y&63)}}return e.join("")},Rr={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(r,e){if(!Array.isArray(r))throw Error("encodeByteArray takes an array as a parameter");this.init_();const u=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,g=[];for(let m=0;m<r.length;m+=3){const _=r[m],y=m+1<r.length,h=y?r[m+1]:0,t=m+2<r.length,c=t?r[m+2]:0,l=_>>2,i=(_&3)<<4|h>>4;let s=(h&15)<<2|c>>6,n=c&63;t||(n=64,y||(s=64)),g.push(u[l],u[i],u[s],u[n])}return g.join("")},encodeString(r,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(r):this.encodeByteArray(Fr(r),e)},decodeString(r,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(r):qs(this.decodeStringToByteArray(r,e))},decodeStringToByteArray(r,e){this.init_();const u=e?this.charToByteMapWebSafe_:this.charToByteMap_,g=[];for(let m=0;m<r.length;){const _=u[r.charAt(m++)],h=m<r.length?u[r.charAt(m)]:0;++m;const c=m<r.length?u[r.charAt(m)]:64;++m;const i=m<r.length?u[r.charAt(m)]:64;if(++m,_==null||h==null||c==null||i==null)throw new Ks;const s=_<<2|h>>4;if(g.push(s),c!==64){const n=h<<4&240|c>>2;if(g.push(n),i!==64){const o=c<<6&192|i;g.push(o)}}}return g},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let r=0;r<this.ENCODED_VALS.length;r++)this.byteToCharMap_[r]=this.ENCODED_VALS.charAt(r),this.charToByteMap_[this.byteToCharMap_[r]]=r,this.byteToCharMapWebSafe_[r]=this.ENCODED_VALS_WEBSAFE.charAt(r),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[r]]=r,r>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(r)]=r,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(r)]=r)}}};class Ks extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Js=function(r){const e=Fr(r);return Rr.encodeByteArray(e,!0)},Lr=function(r){return Js(r).replace(/\./g,"")},Qs=function(r){try{return Rr.decodeString(r,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zs(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $s=()=>Zs().__FIREBASE_DEFAULTS__,ea=()=>{if(typeof process>"u"||typeof process.env>"u")return;const r={}.__FIREBASE_DEFAULTS__;if(r)return JSON.parse(r)},ta=()=>{if(typeof document>"u")return;let r;try{r=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=r&&Qs(r[1]);return e&&JSON.parse(e)},ia=()=>{try{return $s()||ea()||ta()}catch(r){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${r}`);return}},na=()=>{var r;return(r=ia())===null||r===void 0?void 0:r.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ra{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,u)=>{this.resolve=e,this.reject=u})}wrapCallback(e){return(u,g)=>{u?this.reject(u):this.resolve(g),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(u):e(u,g))}}}function sa(){const r=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof r=="object"&&r.id!==void 0}function Br(){try{return typeof indexedDB=="object"}catch{return!1}}function jr(){return new Promise((r,e)=>{try{let u=!0;const g="validate-browser-context-for-indexeddb-analytics-module",m=self.indexedDB.open(g);m.onsuccess=()=>{m.result.close(),u||self.indexedDB.deleteDatabase(g),r(!0)},m.onupgradeneeded=()=>{u=!1},m.onerror=()=>{var _;e(((_=m.error)===null||_===void 0?void 0:_.message)||"")}}catch(u){e(u)}})}function aa(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oa="FirebaseError";class Et extends Error{constructor(e,u,g){super(u),this.code=e,this.customData=g,this.name=oa,Object.setPrototypeOf(this,Et.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,mi.prototype.create)}}class mi{constructor(e,u,g){this.service=e,this.serviceName=u,this.errors=g}create(e,...u){const g=u[0]||{},m=`${this.service}/${e}`,_=this.errors[e],y=_?la(_,g):"Error",h=`${this.serviceName}: ${y} (${m}).`;return new Et(m,h,g)}}function la(r,e){return r.replace(ca,(u,g)=>{const m=e[g];return m!=null?String(m):`<${g}?>`})}const ca=/\{\$([^}]+)}/g;function hi(r,e){if(r===e)return!0;const u=Object.keys(r),g=Object.keys(e);for(const m of u){if(!g.includes(m))return!1;const _=r[m],y=e[m];if(On(_)&&On(y)){if(!hi(_,y))return!1}else if(_!==y)return!1}for(const m of g)if(!u.includes(m))return!1;return!0}function On(r){return r!==null&&typeof r=="object"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ha=1e3,ua=2,fa=4*60*60*1e3,da=.5;function En(r,e=ha,u=ua){const g=e*Math.pow(u,r),m=Math.round(da*g*(Math.random()-.5)*2);return Math.min(fa,g+m)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nr(r){return r&&r._delegate?r._delegate:r}class dt{constructor(e,u,g){this.name=e,this.instanceFactory=u,this.type=g,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _t="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ga{constructor(e,u){this.name=e,this.container=u,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const u=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(u)){const g=new ra;if(this.instancesDeferred.set(u,g),this.isInitialized(u)||this.shouldAutoInitialize())try{const m=this.getOrInitializeService({instanceIdentifier:u});m&&g.resolve(m)}catch{}}return this.instancesDeferred.get(u).promise}getImmediate(e){var u;const g=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),m=(u=e==null?void 0:e.optional)!==null&&u!==void 0?u:!1;if(this.isInitialized(g)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:g})}catch(_){if(m)return null;throw _}else{if(m)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(ma(e))try{this.getOrInitializeService({instanceIdentifier:_t})}catch{}for(const[u,g]of this.instancesDeferred.entries()){const m=this.normalizeInstanceIdentifier(u);try{const _=this.getOrInitializeService({instanceIdentifier:m});g.resolve(_)}catch{}}}}clearInstance(e=_t){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(u=>"INTERNAL"in u).map(u=>u.INTERNAL.delete()),...e.filter(u=>"_delete"in u).map(u=>u._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=_t){return this.instances.has(e)}getOptions(e=_t){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:u={}}=e,g=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(g))throw Error(`${this.name}(${g}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const m=this.getOrInitializeService({instanceIdentifier:g,options:u});for(const[_,y]of this.instancesDeferred.entries()){const h=this.normalizeInstanceIdentifier(_);g===h&&y.resolve(m)}return m}onInit(e,u){var g;const m=this.normalizeInstanceIdentifier(u),_=(g=this.onInitCallbacks.get(m))!==null&&g!==void 0?g:new Set;_.add(e),this.onInitCallbacks.set(m,_);const y=this.instances.get(m);return y&&e(y,m),()=>{_.delete(e)}}invokeOnInitCallbacks(e,u){const g=this.onInitCallbacks.get(u);if(g)for(const m of g)try{m(e,u)}catch{}}getOrInitializeService({instanceIdentifier:e,options:u={}}){let g=this.instances.get(e);if(!g&&this.component&&(g=this.component.instanceFactory(this.container,{instanceIdentifier:pa(e),options:u}),this.instances.set(e,g),this.instancesOptions.set(e,u),this.invokeOnInitCallbacks(g,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,g)}catch{}return g||null}normalizeInstanceIdentifier(e=_t){return this.component?this.component.multipleInstances?e:_t:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function pa(r){return r===_t?void 0:r}function ma(r){return r.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class va{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const u=this.getProvider(e.name);if(u.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);u.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const u=new ga(e,this);return this.providers.set(e,u),u}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ke;(function(r){r[r.DEBUG=0]="DEBUG",r[r.VERBOSE=1]="VERBOSE",r[r.INFO=2]="INFO",r[r.WARN=3]="WARN",r[r.ERROR=4]="ERROR",r[r.SILENT=5]="SILENT"})(ke||(ke={}));const _a={debug:ke.DEBUG,verbose:ke.VERBOSE,info:ke.INFO,warn:ke.WARN,error:ke.ERROR,silent:ke.SILENT},ya=ke.INFO,ba={[ke.DEBUG]:"log",[ke.VERBOSE]:"log",[ke.INFO]:"info",[ke.WARN]:"warn",[ke.ERROR]:"error"},Ca=(r,e,...u)=>{if(e<r.logLevel)return;const g=new Date().toISOString(),m=ba[e];if(m)console[m](`[${g}]  ${r.name}:`,...u);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Hr{constructor(e){this.name=e,this._logLevel=ya,this._logHandler=Ca,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ke))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?_a[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ke.DEBUG,...e),this._logHandler(this,ke.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ke.VERBOSE,...e),this._logHandler(this,ke.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ke.INFO,...e),this._logHandler(this,ke.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ke.WARN,...e),this._logHandler(this,ke.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ke.ERROR,...e),this._logHandler(this,ke.ERROR,...e)}}const wa=(r,e)=>e.some(u=>r instanceof u);let An,kn;function Sa(){return An||(An=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Ta(){return kn||(kn=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Wr=new WeakMap,Ui=new WeakMap,Xr=new WeakMap,xi=new WeakMap,on=new WeakMap;function xa(r){const e=new Promise((u,g)=>{const m=()=>{r.removeEventListener("success",_),r.removeEventListener("error",y)},_=()=>{u(ht(r.result)),m()},y=()=>{g(r.error),m()};r.addEventListener("success",_),r.addEventListener("error",y)});return e.then(u=>{u instanceof IDBCursor&&Wr.set(u,r)}).catch(()=>{}),on.set(e,r),e}function Oa(r){if(Ui.has(r))return;const e=new Promise((u,g)=>{const m=()=>{r.removeEventListener("complete",_),r.removeEventListener("error",y),r.removeEventListener("abort",y)},_=()=>{u(),m()},y=()=>{g(r.error||new DOMException("AbortError","AbortError")),m()};r.addEventListener("complete",_),r.addEventListener("error",y),r.addEventListener("abort",y)});Ui.set(r,e)}let zi={get(r,e,u){if(r instanceof IDBTransaction){if(e==="done")return Ui.get(r);if(e==="objectStoreNames")return r.objectStoreNames||Xr.get(r);if(e==="store")return u.objectStoreNames[1]?void 0:u.objectStore(u.objectStoreNames[0])}return ht(r[e])},set(r,e,u){return r[e]=u,!0},has(r,e){return r instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in r}};function Ea(r){zi=r(zi)}function Aa(r){return r===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...u){const g=r.call(Oi(this),e,...u);return Xr.set(g,e.sort?e.sort():[e]),ht(g)}:Ta().includes(r)?function(...e){return r.apply(Oi(this),e),ht(Wr.get(this))}:function(...e){return ht(r.apply(Oi(this),e))}}function ka(r){return typeof r=="function"?Aa(r):(r instanceof IDBTransaction&&Oa(r),wa(r,Sa())?new Proxy(r,zi):r)}function ht(r){if(r instanceof IDBRequest)return xa(r);if(xi.has(r))return xi.get(r);const e=ka(r);return e!==r&&(xi.set(r,e),on.set(e,r)),e}const Oi=r=>on.get(r);function Ur(r,e,{blocked:u,upgrade:g,blocking:m,terminated:_}={}){const y=indexedDB.open(r,e),h=ht(y);return g&&y.addEventListener("upgradeneeded",t=>{g(ht(y.result),t.oldVersion,t.newVersion,ht(y.transaction))}),u&&y.addEventListener("blocked",()=>u()),h.then(t=>{_&&t.addEventListener("close",()=>_()),m&&t.addEventListener("versionchange",()=>m())}).catch(()=>{}),h}const Da=["get","getKey","getAll","getAllKeys","count"],Pa=["put","add","delete","clear"],Ei=new Map;function Dn(r,e){if(!(r instanceof IDBDatabase&&!(e in r)&&typeof e=="string"))return;if(Ei.get(e))return Ei.get(e);const u=e.replace(/FromIndex$/,""),g=e!==u,m=Pa.includes(u);if(!(u in(g?IDBIndex:IDBObjectStore).prototype)||!(m||Da.includes(u)))return;const _=async function(y,...h){const t=this.transaction(y,m?"readwrite":"readonly");let c=t.store;return g&&(c=c.index(h.shift())),(await Promise.all([c[u](...h),m&&t.done]))[0]};return Ei.set(e,_),_}Ea(r=>({...r,get:(e,u,g)=>Dn(e,u)||r.get(e,u,g),has:(e,u)=>!!Dn(e,u)||r.has(e,u)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ma{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(u=>{if(Ia(u)){const g=u.getImmediate();return`${g.library}/${g.version}`}else return null}).filter(u=>u).join(" ")}}function Ia(r){const e=r.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Yi="@firebase/app",Pn="0.9.5";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ct=new Hr("@firebase/app"),Fa="@firebase/app-compat",Ra="@firebase/analytics-compat",La="@firebase/analytics",Ba="@firebase/app-check-compat",ja="@firebase/app-check",Na="@firebase/auth",Ha="@firebase/auth-compat",Wa="@firebase/database",Xa="@firebase/database-compat",Ua="@firebase/functions",za="@firebase/functions-compat",Ya="@firebase/installations",Va="@firebase/installations-compat",Ga="@firebase/messaging",qa="@firebase/messaging-compat",Ka="@firebase/performance",Ja="@firebase/performance-compat",Qa="@firebase/remote-config",Za="@firebase/remote-config-compat",$a="@firebase/storage",eo="@firebase/storage-compat",to="@firebase/firestore",io="@firebase/firestore-compat",no="firebase";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vi="[DEFAULT]",ro={[Yi]:"fire-core",[Fa]:"fire-core-compat",[La]:"fire-analytics",[Ra]:"fire-analytics-compat",[ja]:"fire-app-check",[Ba]:"fire-app-check-compat",[Na]:"fire-auth",[Ha]:"fire-auth-compat",[Wa]:"fire-rtdb",[Xa]:"fire-rtdb-compat",[Ua]:"fire-fn",[za]:"fire-fn-compat",[Ya]:"fire-iid",[Va]:"fire-iid-compat",[Ga]:"fire-fcm",[qa]:"fire-fcm-compat",[Ka]:"fire-perf",[Ja]:"fire-perf-compat",[Qa]:"fire-rc",[Za]:"fire-rc-compat",[$a]:"fire-gcs",[eo]:"fire-gcs-compat",[to]:"fire-fst",[io]:"fire-fst-compat","fire-js":"fire-js",[no]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ui=new Map,Gi=new Map;function so(r,e){try{r.container.addComponent(e)}catch(u){Ct.debug(`Component ${e.name} failed to register with FirebaseApp ${r.name}`,u)}}function wt(r){const e=r.name;if(Gi.has(e))return Ct.debug(`There were multiple attempts to register component ${e}.`),!1;Gi.set(e,r);for(const u of ui.values())so(u,r);return!0}function vi(r,e){const u=r.container.getProvider("heartbeat").getImmediate({optional:!0});return u&&u.triggerHeartbeat(),r.container.getProvider(e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ao={["no-app"]:"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",["bad-app-name"]:"Illegal App name: '{$appName}",["duplicate-app"]:"Firebase App named '{$appName}' already exists with different options or config",["app-deleted"]:"Firebase App named '{$appName}' already deleted",["no-options"]:"Need to provide options, when not being deployed to hosting via source.",["invalid-app-argument"]:"firebase.{$appName}() takes either no argument or a Firebase App instance.",["invalid-log-argument"]:"First argument to `onLog` must be null or a function.",["idb-open"]:"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.",["idb-get"]:"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.",["idb-set"]:"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.",["idb-delete"]:"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},ut=new mi("app","Firebase",ao);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oo{constructor(e,u,g){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},u),this._name=u.name,this._automaticDataCollectionEnabled=u.automaticDataCollectionEnabled,this._container=g,this.container.addComponent(new dt("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ut.create("app-deleted",{appName:this._name})}}function zr(r,e={}){let u=r;typeof e!="object"&&(e={name:e});const g=Object.assign({name:Vi,automaticDataCollectionEnabled:!1},e),m=g.name;if(typeof m!="string"||!m)throw ut.create("bad-app-name",{appName:String(m)});if(u||(u=na()),!u)throw ut.create("no-options");const _=ui.get(m);if(_){if(hi(u,_.options)&&hi(g,_.config))return _;throw ut.create("duplicate-app",{appName:m})}const y=new va(m);for(const t of Gi.values())y.addComponent(t);const h=new oo(u,g,y);return ui.set(m,h),h}function lo(r=Vi){const e=ui.get(r);if(!e&&r===Vi)return zr();if(!e)throw ut.create("no-app",{appName:r});return e}function ft(r,e,u){var g;let m=(g=ro[r])!==null&&g!==void 0?g:r;u&&(m+=`-${u}`);const _=m.match(/\s|\//),y=e.match(/\s|\//);if(_||y){const h=[`Unable to register library "${m}" with version "${e}":`];_&&h.push(`library name "${m}" contains illegal characters (whitespace or "/")`),_&&y&&h.push("and"),y&&h.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ct.warn(h.join(" "));return}wt(new dt(`${m}-version`,()=>({library:m,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const co="firebase-heartbeat-database",ho=1,Kt="firebase-heartbeat-store";let Ai=null;function Yr(){return Ai||(Ai=Ur(co,ho,{upgrade:(r,e)=>{switch(e){case 0:r.createObjectStore(Kt)}}}).catch(r=>{throw ut.create("idb-open",{originalErrorMessage:r.message})})),Ai}async function uo(r){try{return(await Yr()).transaction(Kt).objectStore(Kt).get(Vr(r))}catch(e){if(e instanceof Et)Ct.warn(e.message);else{const u=ut.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Ct.warn(u.message)}}}async function Mn(r,e){try{const g=(await Yr()).transaction(Kt,"readwrite");return await g.objectStore(Kt).put(e,Vr(r)),g.done}catch(u){if(u instanceof Et)Ct.warn(u.message);else{const g=ut.create("idb-set",{originalErrorMessage:u==null?void 0:u.message});Ct.warn(g.message)}}}function Vr(r){return`${r.name}!${r.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fo=1024,go=30*24*60*60*1e3;class po{constructor(e){this.container=e,this._heartbeatsCache=null;const u=this.container.getProvider("app").getImmediate();this._storage=new vo(u),this._heartbeatsCachePromise=this._storage.read().then(g=>(this._heartbeatsCache=g,g))}async triggerHeartbeat(){const u=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),g=In();if(this._heartbeatsCache===null&&(this._heartbeatsCache=await this._heartbeatsCachePromise),!(this._heartbeatsCache.lastSentHeartbeatDate===g||this._heartbeatsCache.heartbeats.some(m=>m.date===g)))return this._heartbeatsCache.heartbeats.push({date:g,agent:u}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(m=>{const _=new Date(m.date).valueOf();return Date.now()-_<=go}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache===null||this._heartbeatsCache.heartbeats.length===0)return"";const e=In(),{heartbeatsToSend:u,unsentEntries:g}=mo(this._heartbeatsCache.heartbeats),m=Lr(JSON.stringify({version:2,heartbeats:u}));return this._heartbeatsCache.lastSentHeartbeatDate=e,g.length>0?(this._heartbeatsCache.heartbeats=g,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),m}}function In(){return new Date().toISOString().substring(0,10)}function mo(r,e=fo){const u=[];let g=r.slice();for(const m of r){const _=u.find(y=>y.agent===m.agent);if(_){if(_.dates.push(m.date),Fn(u)>e){_.dates.pop();break}}else if(u.push({agent:m.agent,dates:[m.date]}),Fn(u)>e){u.pop();break}g=g.slice(1)}return{heartbeatsToSend:u,unsentEntries:g}}class vo{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Br()?jr().then(()=>!0).catch(()=>!1):!1}async read(){return await this._canUseIndexedDBPromise?await uo(this.app)||{heartbeats:[]}:{heartbeats:[]}}async overwrite(e){var u;if(await this._canUseIndexedDBPromise){const m=await this.read();return Mn(this.app,{lastSentHeartbeatDate:(u=e.lastSentHeartbeatDate)!==null&&u!==void 0?u:m.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var u;if(await this._canUseIndexedDBPromise){const m=await this.read();return Mn(this.app,{lastSentHeartbeatDate:(u=e.lastSentHeartbeatDate)!==null&&u!==void 0?u:m.lastSentHeartbeatDate,heartbeats:[...m.heartbeats,...e.heartbeats]})}else return}}function Fn(r){return Lr(JSON.stringify({version:2,heartbeats:r})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _o(r){wt(new dt("platform-logger",e=>new Ma(e),"PRIVATE")),wt(new dt("heartbeat",e=>new po(e),"PRIVATE")),ft(Yi,Pn,r),ft(Yi,Pn,"esm2017"),ft("fire-js","")}_o("");var yo="firebase",bo="9.18.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ft(yo,bo,"app");const Gr="@firebase/installations",ln="0.6.4";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qr=1e4,Kr=`w:${ln}`,Jr="FIS_v2",Co="https://firebaseinstallations.googleapis.com/v1",wo=60*60*1e3,So="installations",To="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xo={["missing-app-config-values"]:'Missing App configuration value: "{$valueName}"',["not-registered"]:"Firebase Installation is not registered.",["installation-not-found"]:"Firebase Installation not found.",["request-failed"]:'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',["app-offline"]:"Could not process request. Application offline.",["delete-pending-registration"]:"Can't delete installation while there is a pending registration request."},St=new mi(So,To,xo);function Qr(r){return r instanceof Et&&r.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zr({projectId:r}){return`${Co}/projects/${r}/installations`}function $r(r){return{token:r.token,requestStatus:2,expiresIn:Eo(r.expiresIn),creationTime:Date.now()}}async function es(r,e){const g=(await e.json()).error;return St.create("request-failed",{requestName:r,serverCode:g.code,serverMessage:g.message,serverStatus:g.status})}function ts({apiKey:r}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":r})}function Oo(r,{refreshToken:e}){const u=ts(r);return u.append("Authorization",Ao(e)),u}async function is(r){const e=await r();return e.status>=500&&e.status<600?r():e}function Eo(r){return Number(r.replace("s","000"))}function Ao(r){return`${Jr} ${r}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ko({appConfig:r,heartbeatServiceProvider:e},{fid:u}){const g=Zr(r),m=ts(r),_=e.getImmediate({optional:!0});if(_){const c=await _.getHeartbeatsHeader();c&&m.append("x-firebase-client",c)}const y={fid:u,authVersion:Jr,appId:r.appId,sdkVersion:Kr},h={method:"POST",headers:m,body:JSON.stringify(y)},t=await is(()=>fetch(g,h));if(t.ok){const c=await t.json();return{fid:c.fid||u,registrationStatus:2,refreshToken:c.refreshToken,authToken:$r(c.authToken)}}else throw await es("Create Installation",t)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ns(r){return new Promise(e=>{setTimeout(e,r)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Do(r){return btoa(String.fromCharCode(...r)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Po=/^[cdef][\w-]{21}$/,qi="";function Mo(){try{const r=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(r),r[0]=112+r[0]%16;const u=Io(r);return Po.test(u)?u:qi}catch{return qi}}function Io(r){return Do(r).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _i(r){return`${r.appName}!${r.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rs=new Map;function ss(r,e){const u=_i(r);as(u,e),Fo(u,e)}function as(r,e){const u=rs.get(r);if(u)for(const g of u)g(e)}function Fo(r,e){const u=Ro();u&&u.postMessage({key:r,fid:e}),Lo()}let yt=null;function Ro(){return!yt&&"BroadcastChannel"in self&&(yt=new BroadcastChannel("[Firebase] FID Change"),yt.onmessage=r=>{as(r.data.key,r.data.fid)}),yt}function Lo(){rs.size===0&&yt&&(yt.close(),yt=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bo="firebase-installations-database",jo=1,Tt="firebase-installations-store";let ki=null;function cn(){return ki||(ki=Ur(Bo,jo,{upgrade:(r,e)=>{switch(e){case 0:r.createObjectStore(Tt)}}})),ki}async function fi(r,e){const u=_i(r),m=(await cn()).transaction(Tt,"readwrite"),_=m.objectStore(Tt),y=await _.get(u);return await _.put(e,u),await m.done,(!y||y.fid!==e.fid)&&ss(r,e.fid),e}async function os(r){const e=_i(r),g=(await cn()).transaction(Tt,"readwrite");await g.objectStore(Tt).delete(e),await g.done}async function yi(r,e){const u=_i(r),m=(await cn()).transaction(Tt,"readwrite"),_=m.objectStore(Tt),y=await _.get(u),h=e(y);return h===void 0?await _.delete(u):await _.put(h,u),await m.done,h&&(!y||y.fid!==h.fid)&&ss(r,h.fid),h}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hn(r){let e;const u=await yi(r.appConfig,g=>{const m=No(g),_=Ho(r,m);return e=_.registrationPromise,_.installationEntry});return u.fid===qi?{installationEntry:await e}:{installationEntry:u,registrationPromise:e}}function No(r){const e=r||{fid:Mo(),registrationStatus:0};return ls(e)}function Ho(r,e){if(e.registrationStatus===0){if(!navigator.onLine){const m=Promise.reject(St.create("app-offline"));return{installationEntry:e,registrationPromise:m}}const u={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},g=Wo(r,u);return{installationEntry:u,registrationPromise:g}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:Xo(r)}:{installationEntry:e}}async function Wo(r,e){try{const u=await ko(r,e);return fi(r.appConfig,u)}catch(u){throw Qr(u)&&u.customData.serverCode===409?await os(r.appConfig):await fi(r.appConfig,{fid:e.fid,registrationStatus:0}),u}}async function Xo(r){let e=await Rn(r.appConfig);for(;e.registrationStatus===1;)await ns(100),e=await Rn(r.appConfig);if(e.registrationStatus===0){const{installationEntry:u,registrationPromise:g}=await hn(r);return g||u}return e}function Rn(r){return yi(r,e=>{if(!e)throw St.create("installation-not-found");return ls(e)})}function ls(r){return Uo(r)?{fid:r.fid,registrationStatus:0}:r}function Uo(r){return r.registrationStatus===1&&r.registrationTime+qr<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zo({appConfig:r,heartbeatServiceProvider:e},u){const g=Yo(r,u),m=Oo(r,u),_=e.getImmediate({optional:!0});if(_){const c=await _.getHeartbeatsHeader();c&&m.append("x-firebase-client",c)}const y={installation:{sdkVersion:Kr,appId:r.appId}},h={method:"POST",headers:m,body:JSON.stringify(y)},t=await is(()=>fetch(g,h));if(t.ok){const c=await t.json();return $r(c)}else throw await es("Generate Auth Token",t)}function Yo(r,{fid:e}){return`${Zr(r)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function un(r,e=!1){let u;const g=await yi(r.appConfig,_=>{if(!cs(_))throw St.create("not-registered");const y=_.authToken;if(!e&&qo(y))return _;if(y.requestStatus===1)return u=Vo(r,e),_;{if(!navigator.onLine)throw St.create("app-offline");const h=Jo(_);return u=Go(r,h),h}});return u?await u:g.authToken}async function Vo(r,e){let u=await Ln(r.appConfig);for(;u.authToken.requestStatus===1;)await ns(100),u=await Ln(r.appConfig);const g=u.authToken;return g.requestStatus===0?un(r,e):g}function Ln(r){return yi(r,e=>{if(!cs(e))throw St.create("not-registered");const u=e.authToken;return Qo(u)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}async function Go(r,e){try{const u=await zo(r,e),g=Object.assign(Object.assign({},e),{authToken:u});return await fi(r.appConfig,g),u}catch(u){if(Qr(u)&&(u.customData.serverCode===401||u.customData.serverCode===404))await os(r.appConfig);else{const g=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await fi(r.appConfig,g)}throw u}}function cs(r){return r!==void 0&&r.registrationStatus===2}function qo(r){return r.requestStatus===2&&!Ko(r)}function Ko(r){const e=Date.now();return e<r.creationTime||r.creationTime+r.expiresIn<e+wo}function Jo(r){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},r),{authToken:e})}function Qo(r){return r.requestStatus===1&&r.requestTime+qr<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Zo(r){const e=r,{installationEntry:u,registrationPromise:g}=await hn(e);return g?g.catch(console.error):un(e).catch(console.error),u.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $o(r,e=!1){const u=r;return await el(u),(await un(u,e)).token}async function el(r){const{registrationPromise:e}=await hn(r);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tl(r){if(!r||!r.options)throw Di("App Configuration");if(!r.name)throw Di("App Name");const e=["projectId","apiKey","appId"];for(const u of e)if(!r.options[u])throw Di(u);return{appName:r.name,projectId:r.options.projectId,apiKey:r.options.apiKey,appId:r.options.appId}}function Di(r){return St.create("missing-app-config-values",{valueName:r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hs="installations",il="installations-internal",nl=r=>{const e=r.getProvider("app").getImmediate(),u=tl(e),g=vi(e,"heartbeat");return{app:e,appConfig:u,heartbeatServiceProvider:g,_delete:()=>Promise.resolve()}},rl=r=>{const e=r.getProvider("app").getImmediate(),u=vi(e,hs).getImmediate();return{getId:()=>Zo(u),getToken:m=>$o(u,m)}};function sl(){wt(new dt(hs,nl,"PUBLIC")),wt(new dt(il,rl,"PRIVATE"))}sl();ft(Gr,ln);ft(Gr,ln,"esm2017");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const di="analytics",al="firebase_id",ol="origin",ll=60*1e3,cl="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",us="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ve=new Hr("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fs(r){return Promise.all(r.map(e=>e.catch(u=>u)))}function hl(r,e){const u=document.createElement("script");u.src=`${us}?l=${r}&id=${e}`,u.async=!0,document.head.appendChild(u)}function ul(r){let e=[];return Array.isArray(window[r])?e=window[r]:window[r]=e,e}async function fl(r,e,u,g,m,_){const y=g[m];try{if(y)await e[y];else{const t=(await fs(u)).find(c=>c.measurementId===m);t&&await e[t.appId]}}catch(h){Ve.error(h)}r("config",m,_)}async function dl(r,e,u,g,m){try{let _=[];if(m&&m.send_to){let y=m.send_to;Array.isArray(y)||(y=[y]);const h=await fs(u);for(const t of y){const c=h.find(i=>i.measurementId===t),l=c&&e[c.appId];if(l)_.push(l);else{_=[];break}}}_.length===0&&(_=Object.values(e)),await Promise.all(_),r("event",g,m||{})}catch(_){Ve.error(_)}}function gl(r,e,u,g){async function m(_,y,h){try{_==="event"?await dl(r,e,u,y,h):_==="config"?await fl(r,e,u,g,y,h):_==="consent"?r("consent","update",h):r("set",y)}catch(t){Ve.error(t)}}return m}function pl(r,e,u,g,m){let _=function(...y){window[g].push(arguments)};return window[m]&&typeof window[m]=="function"&&(_=window[m]),window[m]=gl(_,r,e,u),{gtagCore:_,wrappedGtag:window[m]}}function ml(r){const e=window.document.getElementsByTagName("script");for(const u of Object.values(e))if(u.src&&u.src.includes(us)&&u.src.includes(r))return u;return null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vl={["already-exists"]:"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.",["already-initialized"]:"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.",["already-initialized-settings"]:"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.",["interop-component-reg-failed"]:"Firebase Analytics Interop Component failed to instantiate: {$reason}",["invalid-analytics-context"]:"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}",["indexeddb-unavailable"]:"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}",["fetch-throttle"]:"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.",["config-fetch-failed"]:"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}",["no-api-key"]:'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',["no-app-id"]:'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.'},qe=new mi("analytics","Analytics",vl);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _l=30,yl=1e3;class bl{constructor(e={},u=yl){this.throttleMetadata=e,this.intervalMillis=u}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,u){this.throttleMetadata[e]=u}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const ds=new bl;function Cl(r){return new Headers({Accept:"application/json","x-goog-api-key":r})}async function wl(r){var e;const{appId:u,apiKey:g}=r,m={method:"GET",headers:Cl(g)},_=cl.replace("{app-id}",u),y=await fetch(_,m);if(y.status!==200&&y.status!==304){let h="";try{const t=await y.json();!((e=t.error)===null||e===void 0)&&e.message&&(h=t.error.message)}catch{}throw qe.create("config-fetch-failed",{httpStatus:y.status,responseMessage:h})}return y.json()}async function Sl(r,e=ds,u){const{appId:g,apiKey:m,measurementId:_}=r.options;if(!g)throw qe.create("no-app-id");if(!m){if(_)return{measurementId:_,appId:g};throw qe.create("no-api-key")}const y=e.getThrottleMetadata(g)||{backoffCount:0,throttleEndTimeMillis:Date.now()},h=new Ol;return setTimeout(async()=>{h.abort()},u!==void 0?u:ll),gs({appId:g,apiKey:m,measurementId:_},y,h,e)}async function gs(r,{throttleEndTimeMillis:e,backoffCount:u},g,m=ds){var _;const{appId:y,measurementId:h}=r;try{await Tl(g,e)}catch(t){if(h)return Ve.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${h} provided in the "measurementId" field in the local Firebase config. [${t==null?void 0:t.message}]`),{appId:y,measurementId:h};throw t}try{const t=await wl(r);return m.deleteThrottleMetadata(y),t}catch(t){const c=t;if(!xl(c)){if(m.deleteThrottleMetadata(y),h)return Ve.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${h} provided in the "measurementId" field in the local Firebase config. [${c==null?void 0:c.message}]`),{appId:y,measurementId:h};throw t}const l=Number((_=c==null?void 0:c.customData)===null||_===void 0?void 0:_.httpStatus)===503?En(u,m.intervalMillis,_l):En(u,m.intervalMillis),i={throttleEndTimeMillis:Date.now()+l,backoffCount:u+1};return m.setThrottleMetadata(y,i),Ve.debug(`Calling attemptFetch again in ${l} millis`),gs(r,i,g,m)}}function Tl(r,e){return new Promise((u,g)=>{const m=Math.max(e-Date.now(),0),_=setTimeout(u,m);r.addEventListener(()=>{clearTimeout(_),g(qe.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function xl(r){if(!(r instanceof Et)||!r.customData)return!1;const e=Number(r.customData.httpStatus);return e===429||e===500||e===503||e===504}class Ol{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function El(r,e,u,g,m){if(m&&m.global){r("event",u,g);return}else{const _=await e,y=Object.assign(Object.assign({},g),{send_to:_});r("event",u,y)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Al(){if(Br())try{await jr()}catch(r){return Ve.warn(qe.create("indexeddb-unavailable",{errorInfo:r==null?void 0:r.toString()}).message),!1}else return Ve.warn(qe.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function kl(r,e,u,g,m,_,y){var h;const t=Sl(r);t.then(n=>{u[n.measurementId]=n.appId,r.options.measurementId&&n.measurementId!==r.options.measurementId&&Ve.warn(`The measurement ID in the local Firebase config (${r.options.measurementId}) does not match the measurement ID fetched from the server (${n.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(n=>Ve.error(n)),e.push(t);const c=Al().then(n=>{if(n)return g.getId()}),[l,i]=await Promise.all([t,c]);ml(_)||hl(_,l.measurementId),m("js",new Date);const s=(h=y==null?void 0:y.config)!==null&&h!==void 0?h:{};return s[ol]="firebase",s.update=!0,i!=null&&(s[al]=i),m("config",l.measurementId,s),l.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dl{constructor(e){this.app=e}_delete(){return delete Vt[this.app.options.appId],Promise.resolve()}}let Vt={},Bn=[];const jn={};let Pi="dataLayer",Pl="gtag",Nn,ps,Hn=!1;function Ml(){const r=[];if(sa()&&r.push("This is a browser extension environment."),aa()||r.push("Cookies are not available."),r.length>0){const e=r.map((g,m)=>`(${m+1}) ${g}`).join(" "),u=qe.create("invalid-analytics-context",{errorInfo:e});Ve.warn(u.message)}}function Il(r,e,u){Ml();const g=r.options.appId;if(!g)throw qe.create("no-app-id");if(!r.options.apiKey)if(r.options.measurementId)Ve.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${r.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw qe.create("no-api-key");if(Vt[g]!=null)throw qe.create("already-exists",{id:g});if(!Hn){ul(Pi);const{wrappedGtag:_,gtagCore:y}=pl(Vt,Bn,jn,Pi,Pl);ps=_,Nn=y,Hn=!0}return Vt[g]=kl(r,Bn,jn,e,Nn,Pi,u),new Dl(r)}function Fl(r=lo()){r=Nr(r);const e=vi(r,di);return e.isInitialized()?e.getImmediate():Rl(r)}function Rl(r,e={}){const u=vi(r,di);if(u.isInitialized()){const m=u.getImmediate();if(hi(e,u.getOptions()))return m;throw qe.create("already-initialized")}return u.initialize({options:e})}function st(r,e,u,g){r=Nr(r),El(ps,Vt[r.app.options.appId],e,u,g).catch(m=>Ve.error(m))}const Wn="@firebase/analytics",Xn="0.9.4";function Ll(){wt(new dt(di,(e,{options:u})=>{const g=e.getProvider("app").getImmediate(),m=e.getProvider("installations-internal").getImmediate();return Il(g,m,u)},"PUBLIC")),wt(new dt("analytics-internal",r,"PRIVATE")),ft(Wn,Xn),ft(Wn,Xn,"esm2017");function r(e){try{const u=e.getProvider(di).getImmediate();return{logEvent:(g,m,_)=>st(u,g,m,_)}}catch(u){throw qe.create("interop-component-reg-failed",{reason:u})}}}Ll();const Bl={apiKey:"AIzaSyD57hutaqXEkYVTDX5foWenR2LmG7_1jyM",authDomain:"dev-jeans-9f478.firebaseapp.com",projectId:"dev-jeans-9f478",storageBucket:"dev-jeans-9f478.appspot.com",messagingSenderId:"31771451735",appId:"1:31771451735:web:92841c507a7ee00301de12",measurementId:"G-LLL5G2XTTH"},jl=zr(Bl),ct=Fl(jl);function ye(){}function Nl(r,e){for(const u in e)r[u]=e[u];return r}function ms(r){return r()}function Un(){return Object.create(null)}function Me(r){r.forEach(ms)}function bi(r){return typeof r=="function"}function xe(r,e){return r!=r?e==e:r!==e||r&&typeof r=="object"||typeof r=="function"}let ti;function Jt(r,e){return ti||(ti=document.createElement("a")),ti.href=e,r===ti.href}function Hl(r){return Object.keys(r).length===0}function fn(r,...e){if(r==null)return ye;const u=r.subscribe(...e);return u.unsubscribe?()=>u.unsubscribe():u}function Yt(r){let e;return fn(r,u=>e=u)(),e}function De(r,e,u){r.$$.on_destroy.push(fn(e,u))}function It(r,e,u,g){if(r){const m=vs(r,e,u,g);return r[0](m)}}function vs(r,e,u,g){return r[1]&&g?Nl(u.ctx.slice(),r[1](g(e))):u.ctx}function Ft(r,e,u,g){if(r[2]&&g){const m=r[2](g(u));if(e.dirty===void 0)return m;if(typeof m=="object"){const _=[],y=Math.max(e.dirty.length,m.length);for(let h=0;h<y;h+=1)_[h]=e.dirty[h]|m[h];return _}return e.dirty|m}return e.dirty}function Rt(r,e,u,g,m,_){if(m){const y=vs(e,u,g,_);r.p(y,m)}}function Lt(r){if(r.ctx.length>32){const e=[],u=r.ctx.length/32;for(let g=0;g<u;g++)e[g]=-1;return e}return-1}function et(r){return r??""}function Xe(r,e,u){return r.set(u),e}function q(r,e){r.appendChild(e)}function ae(r,e,u){r.insertBefore(e,u||null)}function se(r){r.parentNode&&r.parentNode.removeChild(r)}function Bt(r,e){for(let u=0;u<r.length;u+=1)r[u]&&r[u].d(e)}function ee(r){return document.createElement(r)}function Ke(r){return document.createTextNode(r)}function ge(){return Ke(" ")}function tt(){return Ke("")}function ce(r,e,u,g){return r.addEventListener(e,u,g),()=>r.removeEventListener(e,u,g)}function Ze(r){return function(e){return e.preventDefault(),r.call(this,e)}}function xt(r){return function(e){return e.stopPropagation(),r.call(this,e)}}function Wl(r){return function(e){e.target===this&&r.call(this,e)}}function M(r,e,u){u==null?r.removeAttribute(e):r.getAttribute(e)!==u&&r.setAttribute(e,u)}function Xl(r){return Array.from(r.childNodes)}function Ot(r,e){e=""+e,r.wholeText!==e&&(r.data=e)}function Ye(r,e,u,g){u===null?r.style.removeProperty(e):r.style.setProperty(e,u,g?"important":"")}function Re(r,e,u){r.classList[u?"add":"remove"](e)}function Ul(r,e,{bubbles:u=!1,cancelable:g=!1}={}){const m=document.createEvent("CustomEvent");return m.initCustomEvent(r,u,g,e),m}function Oe(r,e){return new r(e)}let Qt;function Gt(r){Qt=r}function dn(){if(!Qt)throw new Error("Function called outside component initialization");return Qt}function Ht(r){dn().$$.on_mount.push(r)}function _s(r){dn().$$.on_destroy.push(r)}function zl(){const r=dn();return(e,u,{cancelable:g=!1}={})=>{const m=r.$$.callbacks[e];if(m){const _=Ul(e,u,{cancelable:g});return m.slice().forEach(y=>{y.call(r,_)}),!_.defaultPrevented}return!0}}function Yl(r,e){const u=r.$$.callbacks[e.type];u&&u.slice().forEach(g=>g.call(this,e))}const Dt=[],Se=[];let Pt=[];const Ki=[],Vl=Promise.resolve();let Ji=!1;function Gl(){Ji||(Ji=!0,Vl.then(ys))}function Qi(r){Pt.push(r)}function Ue(r){Ki.push(r)}const Mi=new Set;let At=0;function ys(){if(At!==0)return;const r=Qt;do{try{for(;At<Dt.length;){const e=Dt[At];At++,Gt(e),ql(e.$$)}}catch(e){throw Dt.length=0,At=0,e}for(Gt(null),Dt.length=0,At=0;Se.length;)Se.pop()();for(let e=0;e<Pt.length;e+=1){const u=Pt[e];Mi.has(u)||(Mi.add(u),u())}Pt.length=0}while(Dt.length);for(;Ki.length;)Ki.pop()();Ji=!1,Mi.clear(),Gt(r)}function ql(r){if(r.fragment!==null){r.update(),Me(r.before_update);const e=r.dirty;r.dirty=[-1],r.fragment&&r.fragment.p(r.ctx,e),r.after_update.forEach(Qi)}}function Kl(r){const e=[],u=[];Pt.forEach(g=>r.indexOf(g)===-1?e.push(g):u.push(g)),u.forEach(g=>g()),Pt=e}const si=new Set;let bt;function Le(){bt={r:0,c:[],p:bt}}function Be(){bt.r||Me(bt.c),bt=bt.p}function le(r,e){r&&r.i&&(si.delete(r),r.i(e))}function fe(r,e,u,g){if(r&&r.o){if(si.has(r))return;si.add(r),bt.c.push(()=>{si.delete(r),g&&(u&&r.d(1),g())}),r.o(e)}else g&&g()}const gn=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function Fe(r,e,u){const g=r.$$.props[e];g!==void 0&&(r.$$.bound[g]=u,u(r.$$.ctx[g]))}function be(r){r&&r.c()}function ve(r,e,u,g){const{fragment:m,after_update:_}=r.$$;m&&m.m(e,u),g||Qi(()=>{const y=r.$$.on_mount.map(ms).filter(bi);r.$$.on_destroy?r.$$.on_destroy.push(...y):Me(y),r.$$.on_mount=[]}),_.forEach(Qi)}function _e(r,e){const u=r.$$;u.fragment!==null&&(Kl(u.after_update),Me(u.on_destroy),u.fragment&&u.fragment.d(e),u.on_destroy=u.fragment=null,u.ctx=[])}function Jl(r,e){r.$$.dirty[0]===-1&&(Dt.push(r),Gl(),r.$$.dirty.fill(0)),r.$$.dirty[e/31|0]|=1<<e%31}function Ee(r,e,u,g,m,_,y,h=[-1]){const t=Qt;Gt(r);const c=r.$$={fragment:null,ctx:[],props:_,update:ye,not_equal:m,bound:Un(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(t?t.$$.context:[])),callbacks:Un(),dirty:h,skip_bound:!1,root:e.target||t.$$.root};y&&y(c.root);let l=!1;if(c.ctx=u?u(r,e.props||{},(i,s,...n)=>{const o=n.length?n[0]:s;return c.ctx&&m(c.ctx[i],c.ctx[i]=o)&&(!c.skip_bound&&c.bound[i]&&c.bound[i](o),l&&Jl(r,i)),s}):[],c.update(),l=!0,Me(c.before_update),c.fragment=g?g(c.ctx):!1,e.target){if(e.hydrate){const i=Xl(e.target);c.fragment&&c.fragment.l(i),i.forEach(se)}else c.fragment&&c.fragment.c();e.intro&&le(r.$$.fragment),ve(r,e.target,e.anchor,e.customElement),ys()}Gt(t)}class Ae{$destroy(){_e(this,1),this.$destroy=ye}$on(e,u){if(!bi(u))return ye;const g=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return g.push(u),()=>{const m=g.indexOf(u);m!==-1&&g.splice(m,1)}}$set(e){this.$$set&&!Hl(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const Ql="/assets/dev-jeans-a579548d.png";function Zl(r){if(r.__esModule)return r;var e=r.default;if(typeof e=="function"){var u=function g(){if(this instanceof g){var m=[null];m.push.apply(m,arguments);var _=Function.bind.apply(e,m);return new _}return e.apply(this,arguments)};u.prototype=e.prototype}else u={};return Object.defineProperty(u,"__esModule",{value:!0}),Object.keys(r).forEach(function(g){var m=Object.getOwnPropertyDescriptor(r,g);Object.defineProperty(u,g,m.get?m:{enumerable:!0,get:function(){return r[g]}})}),u}var gt={};const $l={},ec=Object.freeze(Object.defineProperty({__proto__:null,default:$l},Symbol.toStringTag,{value:"Module"})),Ii=Zl(ec);(function(r){/*! Fabric.js Copyright 2008-2015, Printio (Juriy Zaytsev, Maxim Chernyak) */var e=e||{version:"5.3.0"};if(r.fabric=e,typeof document<"u"&&typeof window<"u")document instanceof(typeof HTMLDocument<"u"?HTMLDocument:Document)?e.document=document:e.document=document.implementation.createHTMLDocument(""),e.window=window;else{var u=Ii,g=new u.JSDOM(decodeURIComponent("%3C!DOCTYPE%20html%3E%3Chtml%3E%3Chead%3E%3C%2Fhead%3E%3Cbody%3E%3C%2Fbody%3E%3C%2Fhtml%3E"),{features:{FetchExternalResources:["img"]},resources:"usable"}).window;e.document=g.document,e.jsdomImplForWrapper=Ii.implForWrapper,e.nodeCanvas=Ii.Canvas,e.window=g,DOMParser=e.window.DOMParser}e.isTouchSupported="ontouchstart"in e.window||"ontouchstart"in e.document||e.window&&e.window.navigator&&e.window.navigator.maxTouchPoints>0,e.isLikelyNode=typeof Buffer<"u"&&typeof window>"u",e.SHARED_ATTRIBUTES=["display","transform","fill","fill-opacity","fill-rule","opacity","stroke","stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"],e.DPI=96,e.reNum="(?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:[eE][-+]?\\d+)?)",e.commaWsp="(?:\\s+,?\\s*|,\\s*)",e.rePathCommand=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:[eE][-+]?\d+)?)/ig,e.reNonWord=/[ \n\.,;!\?\-]/,e.fontPaths={},e.iMatrix=[1,0,0,1,0,0],e.svgNS="http://www.w3.org/2000/svg",e.perfLimitSizeTotal=2097152,e.maxCacheSideLimit=4096,e.minCacheSideLimit=256,e.charWidthsCache={},e.textureSize=2048,e.disableStyleCopyPaste=!1,e.enableGLFiltering=!0,e.devicePixelRatio=e.window.devicePixelRatio||e.window.webkitDevicePixelRatio||e.window.mozDevicePixelRatio||1,e.browserShadowBlurConstant=1,e.arcToSegmentsCache={},e.boundsOfCurveCache={},e.cachesBoundsOfCurve=!0,e.forceGLPutImageData=!1,e.initFilterBackend=function(){if(e.enableGLFiltering&&e.isWebglSupported&&e.isWebglSupported(e.textureSize))return console.log("max texture size: "+e.maxTextureSize),new e.WebglFilterBackend({tileSize:e.textureSize});if(e.Canvas2dFilterBackend)return new e.Canvas2dFilterBackend},typeof document<"u"&&typeof window<"u"&&(window.fabric=e),function(){function h(n,o){if(this.__eventListeners[n]){var f=this.__eventListeners[n];o?f[f.indexOf(o)]=!1:e.util.array.fill(f,!1)}}function t(n,o){if(this.__eventListeners||(this.__eventListeners={}),arguments.length===1)for(var f in n)this.on(f,n[f]);else this.__eventListeners[n]||(this.__eventListeners[n]=[]),this.__eventListeners[n].push(o);return this}function c(n,o){var f=function(){o.apply(this,arguments),this.off(n,f)}.bind(this);this.on(n,f)}function l(n,o){if(arguments.length===1)for(var f in n)c.call(this,f,n[f]);else c.call(this,n,o);return this}function i(n,o){if(!this.__eventListeners)return this;if(arguments.length===0)for(n in this.__eventListeners)h.call(this,n);else if(arguments.length===1&&typeof arguments[0]=="object")for(var f in n)h.call(this,f,n[f]);else h.call(this,n,o);return this}function s(n,o){if(!this.__eventListeners)return this;var f=this.__eventListeners[n];if(!f)return this;for(var a=0,d=f.length;a<d;a++)f[a]&&f[a].call(this,o||{});return this.__eventListeners[n]=f.filter(function(p){return p!==!1}),this}e.Observable={fire:s,on:t,once:l,off:i}}(),e.Collection={_objects:[],add:function(){if(this._objects.push.apply(this._objects,arguments),this._onObjectAdded)for(var h=0,t=arguments.length;h<t;h++)this._onObjectAdded(arguments[h]);return this.renderOnAddRemove&&this.requestRenderAll(),this},insertAt:function(h,t,c){var l=this._objects;return c?l[t]=h:l.splice(t,0,h),this._onObjectAdded&&this._onObjectAdded(h),this.renderOnAddRemove&&this.requestRenderAll(),this},remove:function(){for(var h=this._objects,t,c=!1,l=0,i=arguments.length;l<i;l++)t=h.indexOf(arguments[l]),t!==-1&&(c=!0,h.splice(t,1),this._onObjectRemoved&&this._onObjectRemoved(arguments[l]));return this.renderOnAddRemove&&c&&this.requestRenderAll(),this},forEachObject:function(h,t){for(var c=this.getObjects(),l=0,i=c.length;l<i;l++)h.call(t,c[l],l,c);return this},getObjects:function(h){return typeof h>"u"?this._objects.concat():this._objects.filter(function(t){return t.type===h})},item:function(h){return this._objects[h]},isEmpty:function(){return this._objects.length===0},size:function(){return this._objects.length},contains:function(h,t){return this._objects.indexOf(h)>-1?!0:t?this._objects.some(function(c){return typeof c.contains=="function"&&c.contains(h,!0)}):!1},complexity:function(){return this._objects.reduce(function(h,t){return h+=t.complexity?t.complexity():0,h},0)}},e.CommonMethods={_setOptions:function(h){for(var t in h)this.set(t,h[t])},_initGradient:function(h,t){h&&h.colorStops&&!(h instanceof e.Gradient)&&this.set(t,new e.Gradient(h))},_initPattern:function(h,t,c){h&&h.source&&!(h instanceof e.Pattern)?this.set(t,new e.Pattern(h,c)):c&&c()},_setObject:function(h){for(var t in h)this._set(t,h[t])},set:function(h,t){return typeof h=="object"?this._setObject(h):this._set(h,t),this},_set:function(h,t){this[h]=t},toggle:function(h){var t=this.get(h);return typeof t=="boolean"&&this.set(h,!t),this},get:function(h){return this[h]}},function(h){var t=Math.sqrt,c=Math.atan2,l=Math.pow,i=Math.PI/180,s=Math.PI/2;e.util={cos:function(n){if(n===0)return 1;n<0&&(n=-n);var o=n/s;switch(o){case 1:case 3:return 0;case 2:return-1}return Math.cos(n)},sin:function(n){if(n===0)return 0;var o=n/s,f=1;switch(n<0&&(f=-1),o){case 1:return f;case 2:return 0;case 3:return-f}return Math.sin(n)},removeFromArray:function(n,o){var f=n.indexOf(o);return f!==-1&&n.splice(f,1),n},getRandomInt:function(n,o){return Math.floor(Math.random()*(o-n+1))+n},degreesToRadians:function(n){return n*i},radiansToDegrees:function(n){return n/i},rotatePoint:function(n,o,f){var a=new e.Point(n.x-o.x,n.y-o.y),d=e.util.rotateVector(a,f);return new e.Point(d.x,d.y).addEquals(o)},rotateVector:function(n,o){var f=e.util.sin(o),a=e.util.cos(o),d=n.x*a-n.y*f,p=n.x*f+n.y*a;return{x:d,y:p}},createVector:function(n,o){return new e.Point(o.x-n.x,o.y-n.y)},calcAngleBetweenVectors:function(n,o){return Math.acos((n.x*o.x+n.y*o.y)/(Math.hypot(n.x,n.y)*Math.hypot(o.x,o.y)))},getHatVector:function(n){return new e.Point(n.x,n.y).multiply(1/Math.hypot(n.x,n.y))},getBisector:function(n,o,f){var a=e.util.createVector(n,o),d=e.util.createVector(n,f),p=e.util.calcAngleBetweenVectors(a,d),v=e.util.calcAngleBetweenVectors(e.util.rotateVector(a,p),d),b=p*(v===0?1:-1)/2;return{vector:e.util.getHatVector(e.util.rotateVector(a,b)),angle:p}},projectStrokeOnPoints:function(n,o,f){var a=[],d=o.strokeWidth/2,p=o.strokeUniform?new e.Point(1/o.scaleX,1/o.scaleY):new e.Point(1,1),v=function(b){var C=d/Math.hypot(b.x,b.y);return new e.Point(b.x*C*p.x,b.y*C*p.y)};return n.length<=1||n.forEach(function(b,C){var w=new e.Point(b.x,b.y),S,E;C===0?(E=n[C+1],S=f?v(e.util.createVector(E,w)).addEquals(w):n[n.length-1]):C===n.length-1?(S=n[C-1],E=f?v(e.util.createVector(S,w)).addEquals(w):n[0]):(S=n[C-1],E=n[C+1]);var P=e.util.getBisector(w,S,E),N=P.vector,K=P.angle,Z,W;if(o.strokeLineJoin==="miter"&&(Z=-d/Math.sin(K/2),W=new e.Point(N.x*Z*p.x,N.y*Z*p.y),Math.hypot(W.x,W.y)/d<=o.strokeMiterLimit)){a.push(w.add(W)),a.push(w.subtract(W));return}Z=-d*Math.SQRT2,W=new e.Point(N.x*Z*p.x,N.y*Z*p.y),a.push(w.add(W)),a.push(w.subtract(W))}),a},transformPoint:function(n,o,f){return f?new e.Point(o[0]*n.x+o[2]*n.y,o[1]*n.x+o[3]*n.y):new e.Point(o[0]*n.x+o[2]*n.y+o[4],o[1]*n.x+o[3]*n.y+o[5])},makeBoundingBoxFromPoints:function(n,o){if(o)for(var f=0;f<n.length;f++)n[f]=e.util.transformPoint(n[f],o);var a=[n[0].x,n[1].x,n[2].x,n[3].x],d=e.util.array.min(a),p=e.util.array.max(a),v=p-d,b=[n[0].y,n[1].y,n[2].y,n[3].y],C=e.util.array.min(b),w=e.util.array.max(b),S=w-C;return{left:d,top:C,width:v,height:S}},invertTransform:function(n){var o=1/(n[0]*n[3]-n[1]*n[2]),f=[o*n[3],-o*n[1],-o*n[2],o*n[0]],a=e.util.transformPoint({x:n[4],y:n[5]},f,!0);return f[4]=-a.x,f[5]=-a.y,f},toFixed:function(n,o){return parseFloat(Number(n).toFixed(o))},parseUnit:function(n,o){var f=/\D{0,2}$/.exec(n),a=parseFloat(n);switch(o||(o=e.Text.DEFAULT_SVG_FONT_SIZE),f[0]){case"mm":return a*e.DPI/25.4;case"cm":return a*e.DPI/2.54;case"in":return a*e.DPI;case"pt":return a*e.DPI/72;case"pc":return a*e.DPI/72*12;case"em":return a*o;default:return a}},falseFunction:function(){return!1},getKlass:function(n,o){return n=e.util.string.camelize(n.charAt(0).toUpperCase()+n.slice(1)),e.util.resolveNamespace(o)[n]},getSvgAttributes:function(n){var o=["instantiated_by_use","style","id","class"];switch(n){case"linearGradient":o=o.concat(["x1","y1","x2","y2","gradientUnits","gradientTransform"]);break;case"radialGradient":o=o.concat(["gradientUnits","gradientTransform","cx","cy","r","fx","fy","fr"]);break;case"stop":o=o.concat(["offset","stop-color","stop-opacity"]);break}return o},resolveNamespace:function(n){if(!n)return e;var o=n.split("."),f=o.length,a,d=h||e.window;for(a=0;a<f;++a)d=d[o[a]];return d},loadImage:function(n,o,f,a){if(!n){o&&o.call(f,n);return}var d=e.util.createImage(),p=function(){o&&o.call(f,d,!1),d=d.onload=d.onerror=null};d.onload=p,d.onerror=function(){e.log("Error loading "+d.src),o&&o.call(f,null,!0),d=d.onload=d.onerror=null},n.indexOf("data")!==0&&a!==void 0&&a!==null&&(d.crossOrigin=a),n.substring(0,14)==="data:image/svg"&&(d.onload=null,e.util.loadImageInDom(d,p)),d.src=n},loadImageInDom:function(n,o){var f=e.document.createElement("div");f.style.width=f.style.height="1px",f.style.left=f.style.top="-100%",f.style.position="absolute",f.appendChild(n),e.document.querySelector("body").appendChild(f),n.onload=function(){o(),f.parentNode.removeChild(f),f=null}},enlivenObjects:function(n,o,f,a){n=n||[];var d=[],p=0,v=n.length;function b(){++p===v&&o&&o(d.filter(function(C){return C}))}if(!v){o&&o(d);return}n.forEach(function(C,w){if(!C||!C.type){b();return}var S=e.util.getKlass(C.type,f);S.fromObject(C,function(E,P){P||(d[w]=E),a&&a(C,E,P),b()})})},enlivenObjectEnlivables:function(n,o,f){var a=e.Object.ENLIVEN_PROPS.filter(function(d){return!!n[d]});e.util.enlivenObjects(a.map(function(d){return n[d]}),function(d){var p={};a.forEach(function(v,b){p[v]=d[b],o&&(o[v]=d[b])}),f&&f(p)})},enlivenPatterns:function(n,o){n=n||[];function f(){++d===p&&o&&o(a)}var a=[],d=0,p=n.length;if(!p){o&&o(a);return}n.forEach(function(v,b){v&&v.source?new e.Pattern(v,function(C){a[b]=C,f()}):(a[b]=v,f())})},groupSVGElements:function(n,o,f){var a;return n&&n.length===1?(typeof f<"u"&&(n[0].sourcePath=f),n[0]):(o&&(o.width&&o.height?o.centerPoint={x:o.width/2,y:o.height/2}:(delete o.width,delete o.height)),a=new e.Group(n,o),typeof f<"u"&&(a.sourcePath=f),a)},populateWithProperties:function(n,o,f){if(f&&Array.isArray(f))for(var a=0,d=f.length;a<d;a++)f[a]in n&&(o[f[a]]=n[f[a]])},createCanvasElement:function(){return e.document.createElement("canvas")},copyCanvasElement:function(n){var o=e.util.createCanvasElement();return o.width=n.width,o.height=n.height,o.getContext("2d").drawImage(n,0,0),o},toDataURL:function(n,o,f){return n.toDataURL("image/"+o,f)},createImage:function(){return e.document.createElement("img")},multiplyTransformMatrices:function(n,o,f){return[n[0]*o[0]+n[2]*o[1],n[1]*o[0]+n[3]*o[1],n[0]*o[2]+n[2]*o[3],n[1]*o[2]+n[3]*o[3],f?0:n[0]*o[4]+n[2]*o[5]+n[4],f?0:n[1]*o[4]+n[3]*o[5]+n[5]]},qrDecompose:function(n){var o=c(n[1],n[0]),f=l(n[0],2)+l(n[1],2),a=t(f),d=(n[0]*n[3]-n[2]*n[1])/a,p=c(n[0]*n[2]+n[1]*n[3],f);return{angle:o/i,scaleX:a,scaleY:d,skewX:p/i,skewY:0,translateX:n[4],translateY:n[5]}},calcRotateMatrix:function(n){if(!n.angle)return e.iMatrix.concat();var o=e.util.degreesToRadians(n.angle),f=e.util.cos(o),a=e.util.sin(o);return[f,a,-a,f,0,0]},calcDimensionsMatrix:function(n){var o=typeof n.scaleX>"u"?1:n.scaleX,f=typeof n.scaleY>"u"?1:n.scaleY,a=[n.flipX?-o:o,0,0,n.flipY?-f:f,0,0],d=e.util.multiplyTransformMatrices,p=e.util.degreesToRadians;return n.skewX&&(a=d(a,[1,0,Math.tan(p(n.skewX)),1],!0)),n.skewY&&(a=d(a,[1,Math.tan(p(n.skewY)),0,1],!0)),a},composeMatrix:function(n){var o=[1,0,0,1,n.translateX||0,n.translateY||0],f=e.util.multiplyTransformMatrices;return n.angle&&(o=f(o,e.util.calcRotateMatrix(n))),(n.scaleX!==1||n.scaleY!==1||n.skewX||n.skewY||n.flipX||n.flipY)&&(o=f(o,e.util.calcDimensionsMatrix(n))),o},resetObjectTransform:function(n){n.scaleX=1,n.scaleY=1,n.skewX=0,n.skewY=0,n.flipX=!1,n.flipY=!1,n.rotate(0)},saveObjectTransform:function(n){return{scaleX:n.scaleX,scaleY:n.scaleY,skewX:n.skewX,skewY:n.skewY,angle:n.angle,left:n.left,flipX:n.flipX,flipY:n.flipY,top:n.top}},isTransparent:function(n,o,f,a){a>0&&(o>a?o-=a:o=0,f>a?f-=a:f=0);var d=!0,p,v,b=n.getImageData(o,f,a*2||1,a*2||1),C=b.data.length;for(p=3;p<C&&(v=b.data[p],d=v<=0,d!==!1);p+=4);return b=null,d},parsePreserveAspectRatioAttribute:function(n){var o="meet",f="Mid",a="Mid",d=n.split(" "),p;return d&&d.length&&(o=d.pop(),o!=="meet"&&o!=="slice"?(p=o,o="meet"):d.length&&(p=d.pop())),f=p!=="none"?p.slice(1,4):"none",a=p!=="none"?p.slice(5,8):"none",{meetOrSlice:o,alignX:f,alignY:a}},clearFabricFontCache:function(n){n=(n||"").toLowerCase(),n?e.charWidthsCache[n]&&delete e.charWidthsCache[n]:e.charWidthsCache={}},limitDimsByArea:function(n,o){var f=Math.sqrt(o*n),a=Math.floor(o/f);return{x:Math.floor(f),y:a}},capValue:function(n,o,f){return Math.max(n,Math.min(o,f))},findScaleToFit:function(n,o){return Math.min(o.width/n.width,o.height/n.height)},findScaleToCover:function(n,o){return Math.max(o.width/n.width,o.height/n.height)},matrixToSVG:function(n){return"matrix("+n.map(function(o){return e.util.toFixed(o,e.Object.NUM_FRACTION_DIGITS)}).join(" ")+")"},removeTransformFromObject:function(n,o){var f=e.util.invertTransform(o),a=e.util.multiplyTransformMatrices(f,n.calcOwnMatrix());e.util.applyTransformToObject(n,a)},addTransformToObject:function(n,o){e.util.applyTransformToObject(n,e.util.multiplyTransformMatrices(o,n.calcOwnMatrix()))},applyTransformToObject:function(n,o){var f=e.util.qrDecompose(o),a=new e.Point(f.translateX,f.translateY);n.flipX=!1,n.flipY=!1,n.set("scaleX",f.scaleX),n.set("scaleY",f.scaleY),n.skewX=f.skewX,n.skewY=f.skewY,n.angle=f.angle,n.setPositionByOrigin(a,"center","center")},sizeAfterTransform:function(n,o,f){var a=n/2,d=o/2,p=[{x:-a,y:-d},{x:a,y:-d},{x:-a,y:d},{x:a,y:d}],v=e.util.calcDimensionsMatrix(f),b=e.util.makeBoundingBoxFromPoints(p,v);return{x:b.width,y:b.height}},mergeClipPaths:function(n,o){var f=n,a=o;f.inverted&&!a.inverted&&(f=o,a=n),e.util.applyTransformToObject(a,e.util.multiplyTransformMatrices(e.util.invertTransform(f.calcTransformMatrix()),a.calcTransformMatrix()));var d=f.inverted&&a.inverted;return d&&(f.inverted=a.inverted=!1),new e.Group([f],{clipPath:a,inverted:d})},hasStyleChanged:function(n,o,f){return f=f||!1,n.fill!==o.fill||n.stroke!==o.stroke||n.strokeWidth!==o.strokeWidth||n.fontSize!==o.fontSize||n.fontFamily!==o.fontFamily||n.fontWeight!==o.fontWeight||n.fontStyle!==o.fontStyle||n.textBackgroundColor!==o.textBackgroundColor||n.deltaY!==o.deltaY||f&&(n.overline!==o.overline||n.underline!==o.underline||n.linethrough!==o.linethrough)},stylesToArray:function(f,o){for(var f=e.util.object.clone(f,!0),a=o.split(`
`),d=-1,p={},v=[],b=0;b<a.length;b++){if(!f[b]){d+=a[b].length;continue}for(var C=0;C<a[b].length;C++){d++;var w=f[b][C];if(w&&Object.keys(w).length>0){var S=e.util.hasStyleChanged(p,w,!0);S?v.push({start:d,end:d+1,style:w}):v[v.length-1].end++}p=w||{}}}return v},stylesFromArray:function(n,o){if(!Array.isArray(n))return n;for(var f=o.split(`
`),a=-1,d=0,p={},v=0;v<f.length;v++)for(var b=0;b<f[v].length;b++)a++,n[d]&&n[d].start<=a&&a<n[d].end&&(p[v]=p[v]||{},p[v][b]=Object.assign({},n[d].style),a===n[d].end-1&&d++);return p}}}(r),function(){var h=Array.prototype.join,t={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},c={m:"l",M:"L"};function l(T,k,D,A,B,O,x,I,L,z,j){var Q=e.util.cos(T),F=e.util.sin(T),ie=e.util.cos(k),H=e.util.sin(k),R=D*B*ie-A*O*H+x,V=A*B*ie+D*O*H+I,J=z+L*(-D*B*F-A*O*Q),X=j+L*(-A*B*F+D*O*Q),$=R+L*(D*B*H+A*O*ie),ne=V+L*(A*B*H-D*O*ie);return["C",J,X,$,ne,R,V]}function i(T,k,D,A,B,O,x){var I=Math.PI,L=x*I/180,z=e.util.sin(L),j=e.util.cos(L),Q=0,F=0;D=Math.abs(D),A=Math.abs(A);var ie=-j*T*.5-z*k*.5,H=-j*k*.5+z*T*.5,R=D*D,V=A*A,J=H*H,X=ie*ie,$=R*V-R*J-V*X,ne=0;if($<0){var pe=Math.sqrt(1-$/(R*V));D*=pe,A*=pe}else ne=(B===O?-1:1)*Math.sqrt($/(R*J+V*X));var ue=ne*D*H/A,Y=-ne*A*ie/D,de=j*ue-z*Y+T*.5,me=z*ue+j*Y+k*.5,Ce=s(1,0,(ie-ue)/D,(H-Y)/A),Pe=s((ie-ue)/D,(H-Y)/A,(-ie-ue)/D,(-H-Y)/A);O===0&&Pe>0?Pe-=2*I:O===1&&Pe<0&&(Pe+=2*I);for(var Te=Math.ceil(Math.abs(Pe/I*2)),He=[],Ie=Pe/Te,vt=8/3*Math.sin(Ie/4)*Math.sin(Ie/4)/Math.sin(Ie/2),Xt=Ce+Ie,Qe=0;Qe<Te;Qe++)He[Qe]=l(Ce,Xt,j,z,D,A,de,me,vt,Q,F),Q=He[Qe][5],F=He[Qe][6],Ce=Xt,Xt+=Ie;return He}function s(T,k,D,A){var B=Math.atan2(k,T),O=Math.atan2(A,D);return O>=B?O-B:2*Math.PI-(B-O)}function n(T,k,D,A,B,O,x,I){var L;if(e.cachesBoundsOfCurve&&(L=h.call(arguments),e.boundsOfCurveCache[L]))return e.boundsOfCurveCache[L];var z=Math.sqrt,j=Math.min,Q=Math.max,F=Math.abs,ie=[],H=[[],[]],R,V,J,X,$,ne,pe,ue;V=6*T-12*D+6*B,R=-3*T+9*D-9*B+3*x,J=3*D-3*T;for(var Y=0;Y<2;++Y){if(Y>0&&(V=6*k-12*A+6*O,R=-3*k+9*A-9*O+3*I,J=3*A-3*k),F(R)<1e-12){if(F(V)<1e-12)continue;X=-J/V,0<X&&X<1&&ie.push(X);continue}pe=V*V-4*J*R,!(pe<0)&&(ue=z(pe),$=(-V+ue)/(2*R),0<$&&$<1&&ie.push($),ne=(-V-ue)/(2*R),0<ne&&ne<1&&ie.push(ne))}for(var de,me,Ce=ie.length,Pe=Ce,Te;Ce--;)X=ie[Ce],Te=1-X,de=Te*Te*Te*T+3*Te*Te*X*D+3*Te*X*X*B+X*X*X*x,H[0][Ce]=de,me=Te*Te*Te*k+3*Te*Te*X*A+3*Te*X*X*O+X*X*X*I,H[1][Ce]=me;H[0][Pe]=T,H[1][Pe]=k,H[0][Pe+1]=x,H[1][Pe+1]=I;var He=[{x:j.apply(null,H[0]),y:j.apply(null,H[1])},{x:Q.apply(null,H[0]),y:Q.apply(null,H[1])}];return e.cachesBoundsOfCurve&&(e.boundsOfCurveCache[L]=He),He}function o(T,k,D){for(var A=D[1],B=D[2],O=D[3],x=D[4],I=D[5],L=D[6],z=D[7],j=i(L-T,z-k,A,B,x,I,O),Q=0,F=j.length;Q<F;Q++)j[Q][1]+=T,j[Q][2]+=k,j[Q][3]+=T,j[Q][4]+=k,j[Q][5]+=T,j[Q][6]+=k;return j}function f(T){var k=0,D=0,A=T.length,B=0,O=0,x,I,L,z=[],j,Q,F;for(I=0;I<A;++I){switch(L=!1,x=T[I].slice(0),x[0]){case"l":x[0]="L",x[1]+=k,x[2]+=D;case"L":k=x[1],D=x[2];break;case"h":x[1]+=k;case"H":x[0]="L",x[2]=D,k=x[1];break;case"v":x[1]+=D;case"V":x[0]="L",D=x[1],x[1]=k,x[2]=D;break;case"m":x[0]="M",x[1]+=k,x[2]+=D;case"M":k=x[1],D=x[2],B=x[1],O=x[2];break;case"c":x[0]="C",x[1]+=k,x[2]+=D,x[3]+=k,x[4]+=D,x[5]+=k,x[6]+=D;case"C":Q=x[3],F=x[4],k=x[5],D=x[6];break;case"s":x[0]="S",x[1]+=k,x[2]+=D,x[3]+=k,x[4]+=D;case"S":j==="C"?(Q=2*k-Q,F=2*D-F):(Q=k,F=D),k=x[3],D=x[4],x[0]="C",x[5]=x[3],x[6]=x[4],x[3]=x[1],x[4]=x[2],x[1]=Q,x[2]=F,Q=x[3],F=x[4];break;case"q":x[0]="Q",x[1]+=k,x[2]+=D,x[3]+=k,x[4]+=D;case"Q":Q=x[1],F=x[2],k=x[3],D=x[4];break;case"t":x[0]="T",x[1]+=k,x[2]+=D;case"T":j==="Q"?(Q=2*k-Q,F=2*D-F):(Q=k,F=D),x[0]="Q",k=x[1],D=x[2],x[1]=Q,x[2]=F,x[3]=k,x[4]=D;break;case"a":x[0]="A",x[6]+=k,x[7]+=D;case"A":L=!0,z=z.concat(o(k,D,x)),k=x[6],D=x[7];break;case"z":case"Z":k=B,D=O;break}L||z.push(x),j=x[0]}return z}function a(T,k,D,A){return Math.sqrt((D-T)*(D-T)+(A-k)*(A-k))}function d(T){return T*T*T}function p(T){return 3*T*T*(1-T)}function v(T){return 3*T*(1-T)*(1-T)}function b(T){return(1-T)*(1-T)*(1-T)}function C(T,k,D,A,B,O,x,I){return function(L){var z=d(L),j=p(L),Q=v(L),F=b(L);return{x:x*z+B*j+D*Q+T*F,y:I*z+O*j+A*Q+k*F}}}function w(T,k,D,A,B,O,x,I){return function(L){var z=1-L,j=3*z*z*(D-T)+6*z*L*(B-D)+3*L*L*(x-B),Q=3*z*z*(A-k)+6*z*L*(O-A)+3*L*L*(I-O);return Math.atan2(Q,j)}}function S(T){return T*T}function E(T){return 2*T*(1-T)}function P(T){return(1-T)*(1-T)}function N(T,k,D,A,B,O){return function(x){var I=S(x),L=E(x),z=P(x);return{x:B*I+D*L+T*z,y:O*I+A*L+k*z}}}function K(T,k,D,A,B,O){return function(x){var I=1-x,L=2*I*(D-T)+2*x*(B-D),z=2*I*(A-k)+2*x*(O-A);return Math.atan2(z,L)}}function Z(T,k,D){var A={x:k,y:D},B,O=0,x;for(x=1;x<=100;x+=1)B=T(x/100),O+=a(A.x,A.y,B.x,B.y),A=B;return O}function W(T,k){for(var D=0,A=0,B=T.iterator,O={x:T.x,y:T.y},x,I,L=.01,z=T.angleFinder,j;A<k&&L>1e-4;)x=B(D),j=D,I=a(O.x,O.y,x.x,x.y),I+A>k?(D-=L,L/=2):(O=x,D+=L,A+=I);return x.angle=z(j),x}function U(T){for(var k=0,D=T.length,A,B=0,O=0,x=0,I=0,L=[],z,j,Q,F=0;F<D;F++){switch(A=T[F],j={x:B,y:O,command:A[0]},A[0]){case"M":j.length=0,x=B=A[1],I=O=A[2];break;case"L":j.length=a(B,O,A[1],A[2]),B=A[1],O=A[2];break;case"C":z=C(B,O,A[1],A[2],A[3],A[4],A[5],A[6]),Q=w(B,O,A[1],A[2],A[3],A[4],A[5],A[6]),j.iterator=z,j.angleFinder=Q,j.length=Z(z,B,O),B=A[5],O=A[6];break;case"Q":z=N(B,O,A[1],A[2],A[3],A[4]),Q=K(B,O,A[1],A[2],A[3],A[4]),j.iterator=z,j.angleFinder=Q,j.length=Z(z,B,O),B=A[3],O=A[4];break;case"Z":case"z":j.destX=x,j.destY=I,j.length=a(B,O,x,I),B=x,O=I;break}k+=j.length,L.push(j)}return L.push({length:k,x:B,y:O}),L}function te(T,k,D){D||(D=U(T));for(var A=0;k-D[A].length>0&&A<D.length-2;)k-=D[A].length,A++;var B=D[A],O=k/B.length,x=B.command,I=T[A],L;switch(x){case"M":return{x:B.x,y:B.y,angle:0};case"Z":case"z":return L=new e.Point(B.x,B.y).lerp(new e.Point(B.destX,B.destY),O),L.angle=Math.atan2(B.destY-B.y,B.destX-B.x),L;case"L":return L=new e.Point(B.x,B.y).lerp(new e.Point(I[1],I[2]),O),L.angle=Math.atan2(I[2]-B.y,I[1]-B.x),L;case"C":return W(B,k);case"Q":return W(B,k)}}function re(T){var k=[],D=[],A,B,O=e.rePathCommand,x="[-+]?(?:\\d*\\.\\d+|\\d+\\.?)(?:[eE][-+]?\\d+)?\\s*",I="("+x+")"+e.commaWsp,L="([01])"+e.commaWsp+"?",z=I+"?"+I+"?"+I+L+L+I+"?("+x+")",j=new RegExp(z,"g"),Q,F,ie;if(!T||!T.match)return k;ie=T.match(/[mzlhvcsqta][^mzlhvcsqta]*/gi);for(var H=0,R,V=ie.length;H<V;H++){A=ie[H],F=A.slice(1).trim(),D.length=0;var J=A.charAt(0);if(R=[J],J.toLowerCase()==="a")for(var X;X=j.exec(F);)for(var $=1;$<X.length;$++)D.push(X[$]);else for(;Q=O.exec(F);)D.push(Q[0]);for(var $=0,ne=D.length;$<ne;$++)B=parseFloat(D[$]),isNaN(B)||R.push(B);var pe=t[J.toLowerCase()],ue=c[J]||J;if(R.length-1>pe)for(var Y=1,de=R.length;Y<de;Y+=pe)k.push([J].concat(R.slice(Y,Y+pe))),J=ue;else k.push(R)}return k}function he(T,k){var D=[],A,B=new e.Point(T[0].x,T[0].y),O=new e.Point(T[1].x,T[1].y),x=T.length,I=1,L=0,z=x>2;for(k=k||0,z&&(I=T[2].x<O.x?-1:T[2].x===O.x?0:1,L=T[2].y<O.y?-1:T[2].y===O.y?0:1),D.push(["M",B.x-I*k,B.y-L*k]),A=1;A<x;A++){if(!B.eq(O)){var j=B.midPointFrom(O);D.push(["Q",B.x,B.y,j.x,j.y])}B=T[A],A+1<T.length&&(O=T[A+1])}return z&&(I=B.x>T[A-2].x?1:B.x===T[A-2].x?0:-1,L=B.y>T[A-2].y?1:B.y===T[A-2].y?0:-1),D.push(["L",B.x+I*k,B.y+L*k]),D}function oe(T,k,D){return D&&(k=e.util.multiplyTransformMatrices(k,[1,0,0,1,-D.x,-D.y])),T.map(function(A){for(var B=A.slice(0),O={},x=1;x<A.length-1;x+=2)O.x=A[x],O.y=A[x+1],O=e.util.transformPoint(O,k),B[x]=O.x,B[x+1]=O.y;return B})}e.util.joinPath=function(T){return T.map(function(k){return k.join(" ")}).join(" ")},e.util.parsePath=re,e.util.makePathSimpler=f,e.util.getSmoothPathFromPoints=he,e.util.getPathSegmentsInfo=U,e.util.getBoundsOfCurve=n,e.util.getPointOnPath=te,e.util.transformPath=oe}(),function(){var h=Array.prototype.slice;function t(n,o){for(var f=h.call(arguments,2),a=[],d=0,p=n.length;d<p;d++)a[d]=f.length?n[d][o].apply(n[d],f):n[d][o].call(n[d]);return a}function c(n,o){return s(n,o,function(f,a){return f>=a})}function l(n,o){return s(n,o,function(f,a){return f<a})}function i(n,o){for(var f=n.length;f--;)n[f]=o;return n}function s(n,o,f){if(!(!n||n.length===0)){var a=n.length-1,d=o?n[a][o]:n[a];if(o)for(;a--;)f(n[a][o],d)&&(d=n[a][o]);else for(;a--;)f(n[a],d)&&(d=n[a]);return d}}e.util.array={fill:i,invoke:t,min:l,max:c}}(),function(){function h(c,l,i){if(i)if(!e.isLikelyNode&&l instanceof Element)c=l;else if(l instanceof Array){c=[];for(var s=0,n=l.length;s<n;s++)c[s]=h({},l[s],i)}else if(l&&typeof l=="object")for(var o in l)o==="canvas"||o==="group"?c[o]=null:l.hasOwnProperty(o)&&(c[o]=h({},l[o],i));else c=l;else for(var o in l)c[o]=l[o];return c}function t(c,l){return h({},c,l)}e.util.object={extend:h,clone:t},e.util.object.extend(e.util,e.Observable)}(),function(){function h(s){return s.replace(/-+(.)?/g,function(n,o){return o?o.toUpperCase():""})}function t(s,n){return s.charAt(0).toUpperCase()+(n?s.slice(1):s.slice(1).toLowerCase())}function c(s){return s.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function l(s){var n=0,o,f=[];for(n=0,o;n<s.length;n++)(o=i(s,n))!==!1&&f.push(o);return f}function i(s,n){var o=s.charCodeAt(n);if(isNaN(o))return"";if(o<55296||o>57343)return s.charAt(n);if(55296<=o&&o<=56319){if(s.length<=n+1)throw"High surrogate without following low surrogate";var f=s.charCodeAt(n+1);if(56320>f||f>57343)throw"High surrogate without following low surrogate";return s.charAt(n)+s.charAt(n+1)}if(n===0)throw"Low surrogate without preceding high surrogate";var a=s.charCodeAt(n-1);if(55296>a||a>56319)throw"Low surrogate without preceding high surrogate";return!1}e.util.string={camelize:h,capitalize:t,escapeXml:c,graphemeSplit:l}}(),function(){var h=Array.prototype.slice,t=function(){},c=function(){for(var o in{toString:1})if(o==="toString")return!1;return!0}(),l=function(o,f,a){for(var d in f)d in o.prototype&&typeof o.prototype[d]=="function"&&(f[d]+"").indexOf("callSuper")>-1?o.prototype[d]=function(p){return function(){var v=this.constructor.superclass;this.constructor.superclass=a;var b=f[p].apply(this,arguments);if(this.constructor.superclass=v,p!=="initialize")return b}}(d):o.prototype[d]=f[d],c&&(f.toString!==Object.prototype.toString&&(o.prototype.toString=f.toString),f.valueOf!==Object.prototype.valueOf&&(o.prototype.valueOf=f.valueOf))};function i(){}function s(o){for(var f=null,a=this;a.constructor.superclass;){var d=a.constructor.superclass.prototype[o];if(a[o]!==d){f=d;break}a=a.constructor.superclass.prototype}return f?arguments.length>1?f.apply(this,h.call(arguments,1)):f.call(this):console.log("tried to callSuper "+o+", method not found in prototype chain",this)}function n(){var o=null,f=h.call(arguments,0);typeof f[0]=="function"&&(o=f.shift());function a(){this.initialize.apply(this,arguments)}a.superclass=o,a.subclasses=[],o&&(i.prototype=o.prototype,a.prototype=new i,o.subclasses.push(a));for(var d=0,p=f.length;d<p;d++)l(a,f[d],o);return a.prototype.initialize||(a.prototype.initialize=t),a.prototype.constructor=a,a.prototype.callSuper=s,a}e.util.createClass=n}(),function(){var h=!!e.document.createElement("div").attachEvent,t=["touchstart","touchmove","touchend"];e.util.addListener=function(l,i,s,n){l&&l.addEventListener(i,s,h?!1:n)},e.util.removeListener=function(l,i,s,n){l&&l.removeEventListener(i,s,h?!1:n)};function c(l){var i=l.changedTouches;return i&&i[0]?i[0]:l}e.util.getPointer=function(l){var i=l.target,s=e.util.getScrollLeftTop(i),n=c(l);return{x:n.clientX+s.left,y:n.clientY+s.top}},e.util.isTouchEvent=function(l){return t.indexOf(l.type)>-1||l.pointerType==="touch"}}(),function(){function h(n,o){var f=n.style;if(!f)return n;if(typeof o=="string")return n.style.cssText+=";"+o,o.indexOf("opacity")>-1?s(n,o.match(/opacity:\s*(\d?\.?\d*)/)[1]):n;for(var a in o)if(a==="opacity")s(n,o[a]);else{var d=a==="float"||a==="cssFloat"?typeof f.styleFloat>"u"?"cssFloat":"styleFloat":a;f.setProperty(d,o[a])}return n}var t=e.document.createElement("div"),c=typeof t.style.opacity=="string",l=typeof t.style.filter=="string",i=/alpha\s*\(\s*opacity\s*=\s*([^\)]+)\)/,s=function(n){return n};c?s=function(n,o){return n.style.opacity=o,n}:l&&(s=function(n,o){var f=n.style;return n.currentStyle&&!n.currentStyle.hasLayout&&(f.zoom=1),i.test(f.filter)?(o=o>=.9999?"":"alpha(opacity="+o*100+")",f.filter=f.filter.replace(i,o)):f.filter+=" alpha(opacity="+o*100+")",n}),e.util.setStyle=h}(),function(){var h=Array.prototype.slice;function t(b){return typeof b=="string"?e.document.getElementById(b):b}var c,l=function(b){return h.call(b,0)};try{c=l(e.document.childNodes)instanceof Array}catch{}c||(l=function(b){for(var C=new Array(b.length),w=b.length;w--;)C[w]=b[w];return C});function i(b,C){var w=e.document.createElement(b);for(var S in C)S==="class"?w.className=C[S]:S==="for"?w.htmlFor=C[S]:w.setAttribute(S,C[S]);return w}function s(b,C){b&&(" "+b.className+" ").indexOf(" "+C+" ")===-1&&(b.className+=(b.className?" ":"")+C)}function n(b,C,w){return typeof C=="string"&&(C=i(C,w)),b.parentNode&&b.parentNode.replaceChild(C,b),C.appendChild(b),C}function o(b){for(var C=0,w=0,S=e.document.documentElement,E=e.document.body||{scrollLeft:0,scrollTop:0};b&&(b.parentNode||b.host)&&(b=b.parentNode||b.host,b===e.document?(C=E.scrollLeft||S.scrollLeft||0,w=E.scrollTop||S.scrollTop||0):(C+=b.scrollLeft||0,w+=b.scrollTop||0),!(b.nodeType===1&&b.style.position==="fixed")););return{left:C,top:w}}function f(b){var C,w=b&&b.ownerDocument,S={left:0,top:0},E={left:0,top:0},P,N={borderLeftWidth:"left",borderTopWidth:"top",paddingLeft:"left",paddingTop:"top"};if(!w)return E;for(var K in N)E[N[K]]+=parseInt(a(b,K),10)||0;return C=w.documentElement,typeof b.getBoundingClientRect<"u"&&(S=b.getBoundingClientRect()),P=o(b),{left:S.left+P.left-(C.clientLeft||0)+E.left,top:S.top+P.top-(C.clientTop||0)+E.top}}var a;e.document.defaultView&&e.document.defaultView.getComputedStyle?a=function(b,C){var w=e.document.defaultView.getComputedStyle(b,null);return w?w[C]:void 0}:a=function(b,C){var w=b.style[C];return!w&&b.currentStyle&&(w=b.currentStyle[C]),w},function(){var b=e.document.documentElement.style,C="userSelect"in b?"userSelect":"MozUserSelect"in b?"MozUserSelect":"WebkitUserSelect"in b?"WebkitUserSelect":"KhtmlUserSelect"in b?"KhtmlUserSelect":"";function w(E){return typeof E.onselectstart<"u"&&(E.onselectstart=e.util.falseFunction),C?E.style[C]="none":typeof E.unselectable=="string"&&(E.unselectable="on"),E}function S(E){return typeof E.onselectstart<"u"&&(E.onselectstart=null),C?E.style[C]="":typeof E.unselectable=="string"&&(E.unselectable=""),E}e.util.makeElementUnselectable=w,e.util.makeElementSelectable=S}();function d(b){var C=e.jsdomImplForWrapper(b);return C._canvas||C._image}function p(b){if(e.isLikelyNode){var C=e.jsdomImplForWrapper(b);C&&(C._image=null,C._canvas=null,C._currentSrc=null,C._attributes=null,C._classList=null)}}function v(b,C){b.imageSmoothingEnabled=b.imageSmoothingEnabled||b.webkitImageSmoothingEnabled||b.mozImageSmoothingEnabled||b.msImageSmoothingEnabled||b.oImageSmoothingEnabled,b.imageSmoothingEnabled=C}e.util.setImageSmoothing=v,e.util.getById=t,e.util.toArray=l,e.util.addClass=s,e.util.makeElement=i,e.util.wrapElement=n,e.util.getScrollLeftTop=o,e.util.getElementOffset=f,e.util.getNodeCanvas=d,e.util.cleanUpJsdomNode=p}(),function(){function h(l,i){return l+(/\?/.test(l)?"&":"?")+i}function t(){}function c(l,i){i||(i={});var s=i.method?i.method.toUpperCase():"GET",n=i.onComplete||function(){},o=new e.window.XMLHttpRequest,f=i.body||i.parameters;return o.onreadystatechange=function(){o.readyState===4&&(n(o),o.onreadystatechange=t)},s==="GET"&&(f=null,typeof i.parameters=="string"&&(l=h(l,i.parameters))),o.open(s,l,!0),(s==="POST"||s==="PUT")&&o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),o.send(f),o}e.util.request=c}(),e.log=console.log,e.warn=console.warn,function(){var h=e.util.object.extend,t=e.util.object.clone,c=[];e.util.object.extend(c,{cancelAll:function(){var d=this.splice(0);return d.forEach(function(p){p.cancel()}),d},cancelByCanvas:function(d){if(!d)return[];var p=this.filter(function(v){return typeof v.target=="object"&&v.target.canvas===d});return p.forEach(function(v){v.cancel()}),p},cancelByTarget:function(d){var p=this.findAnimationsByTarget(d);return p.forEach(function(v){v.cancel()}),p},findAnimationIndex:function(d){return this.indexOf(this.findAnimation(d))},findAnimation:function(d){return this.find(function(p){return p.cancel===d})},findAnimationsByTarget:function(d){return d?this.filter(function(p){return p.target===d}):[]}});function l(){return!1}function i(d,p,v,b){return-v*Math.cos(d/b*(Math.PI/2))+v+p}function s(d){d||(d={});var p=!1,v,b=function(){var C=e.runningAnimations.indexOf(v);return C>-1&&e.runningAnimations.splice(C,1)[0]};return v=h(t(d),{cancel:function(){return p=!0,b()},currentValue:"startValue"in d?d.startValue:0,completionRate:0,durationRate:0}),e.runningAnimations.push(v),f(function(C){var w=C||+new Date,S=d.duration||500,E=w+S,P,N=d.onChange||l,K=d.abort||l,Z=d.onComplete||l,W=d.easing||i,U="startValue"in d?d.startValue.length>0:!1,te="startValue"in d?d.startValue:0,re="endValue"in d?d.endValue:100,he=d.byValue||(U?te.map(function(oe,T){return re[T]-te[T]}):re-te);d.onStart&&d.onStart(),function oe(T){P=T||+new Date;var k=P>E?S:P-w,D=k/S,A=U?te.map(function(O,x){return W(k,te[x],he[x],S)}):W(k,te,he,S),B=Math.abs(U?(A[0]-te[0])/he[0]:(A-te)/he);if(v.currentValue=U?A.slice():A,v.completionRate=B,v.durationRate=D,!p){if(K(A,B,D)){b();return}if(P>E){v.currentValue=U?re.slice():re,v.completionRate=1,v.durationRate=1,N(U?re.slice():re,1,1),Z(re,1,1),b();return}else N(A,B,D),f(oe)}}(w)}),v.cancel}var n=e.window.requestAnimationFrame||e.window.webkitRequestAnimationFrame||e.window.mozRequestAnimationFrame||e.window.oRequestAnimationFrame||e.window.msRequestAnimationFrame||function(d){return e.window.setTimeout(d,1e3/60)},o=e.window.cancelAnimationFrame||e.window.clearTimeout;function f(){return n.apply(e.window,arguments)}function a(){return o.apply(e.window,arguments)}e.util.animate=s,e.util.requestAnimFrame=f,e.util.cancelAnimFrame=a,e.runningAnimations=c}(),function(){function h(c,l,i){var s="rgba("+parseInt(c[0]+i*(l[0]-c[0]),10)+","+parseInt(c[1]+i*(l[1]-c[1]),10)+","+parseInt(c[2]+i*(l[2]-c[2]),10);return s+=","+(c&&l?parseFloat(c[3]+i*(l[3]-c[3])):1),s+=")",s}function t(c,l,i,s){var n=new e.Color(c).getSource(),o=new e.Color(l).getSource(),f=s.onComplete,a=s.onChange;return s=s||{},e.util.animate(e.util.object.extend(s,{duration:i||500,startValue:n,endValue:o,byValue:o,easing:function(d,p,v,b){var C=s.colorEasing?s.colorEasing(d,b):1-Math.cos(d/b*(Math.PI/2));return h(p,v,C)},onComplete:function(d,p,v){if(f)return f(h(o,o,0),p,v)},onChange:function(d,p,v){if(a){if(Array.isArray(d))return a(h(d,d,0),p,v);a(d,p,v)}}}))}e.util.animateColor=t}(),function(){function h(T,k,D,A){return T<Math.abs(k)?(T=k,A=D/4):k===0&&T===0?A=D/(2*Math.PI)*Math.asin(1):A=D/(2*Math.PI)*Math.asin(k/T),{a:T,c:k,p:D,s:A}}function t(T,k,D){return T.a*Math.pow(2,10*(k-=1))*Math.sin((k*D-T.s)*(2*Math.PI)/T.p)}function c(T,k,D,A){return D*((T=T/A-1)*T*T+1)+k}function l(T,k,D,A){return T/=A/2,T<1?D/2*T*T*T+k:D/2*((T-=2)*T*T+2)+k}function i(T,k,D,A){return D*(T/=A)*T*T*T+k}function s(T,k,D,A){return-D*((T=T/A-1)*T*T*T-1)+k}function n(T,k,D,A){return T/=A/2,T<1?D/2*T*T*T*T+k:-D/2*((T-=2)*T*T*T-2)+k}function o(T,k,D,A){return D*(T/=A)*T*T*T*T+k}function f(T,k,D,A){return D*((T=T/A-1)*T*T*T*T+1)+k}function a(T,k,D,A){return T/=A/2,T<1?D/2*T*T*T*T*T+k:D/2*((T-=2)*T*T*T*T+2)+k}function d(T,k,D,A){return-D*Math.cos(T/A*(Math.PI/2))+D+k}function p(T,k,D,A){return D*Math.sin(T/A*(Math.PI/2))+k}function v(T,k,D,A){return-D/2*(Math.cos(Math.PI*T/A)-1)+k}function b(T,k,D,A){return T===0?k:D*Math.pow(2,10*(T/A-1))+k}function C(T,k,D,A){return T===A?k+D:D*(-Math.pow(2,-10*T/A)+1)+k}function w(T,k,D,A){return T===0?k:T===A?k+D:(T/=A/2,T<1?D/2*Math.pow(2,10*(T-1))+k:D/2*(-Math.pow(2,-10*--T)+2)+k)}function S(T,k,D,A){return-D*(Math.sqrt(1-(T/=A)*T)-1)+k}function E(T,k,D,A){return D*Math.sqrt(1-(T=T/A-1)*T)+k}function P(T,k,D,A){return T/=A/2,T<1?-D/2*(Math.sqrt(1-T*T)-1)+k:D/2*(Math.sqrt(1-(T-=2)*T)+1)+k}function N(T,k,D,A){var B=1.70158,O=0,x=D;if(T===0)return k;if(T/=A,T===1)return k+D;O||(O=A*.3);var I=h(x,D,O,B);return-t(I,T,A)+k}function K(T,k,D,A){var B=1.70158,O=0,x=D;if(T===0)return k;if(T/=A,T===1)return k+D;O||(O=A*.3);var I=h(x,D,O,B);return I.a*Math.pow(2,-10*T)*Math.sin((T*A-I.s)*(2*Math.PI)/I.p)+I.c+k}function Z(T,k,D,A){var B=1.70158,O=0,x=D;if(T===0)return k;if(T/=A/2,T===2)return k+D;O||(O=A*(.3*1.5));var I=h(x,D,O,B);return T<1?-.5*t(I,T,A)+k:I.a*Math.pow(2,-10*(T-=1))*Math.sin((T*A-I.s)*(2*Math.PI)/I.p)*.5+I.c+k}function W(T,k,D,A,B){return B===void 0&&(B=1.70158),D*(T/=A)*T*((B+1)*T-B)+k}function U(T,k,D,A,B){return B===void 0&&(B=1.70158),D*((T=T/A-1)*T*((B+1)*T+B)+1)+k}function te(T,k,D,A,B){return B===void 0&&(B=1.70158),T/=A/2,T<1?D/2*(T*T*(((B*=1.525)+1)*T-B))+k:D/2*((T-=2)*T*(((B*=1.525)+1)*T+B)+2)+k}function re(T,k,D,A){return D-he(A-T,0,D,A)+k}function he(T,k,D,A){return(T/=A)<1/2.75?D*(7.5625*T*T)+k:T<2/2.75?D*(7.5625*(T-=1.5/2.75)*T+.75)+k:T<2.5/2.75?D*(7.5625*(T-=2.25/2.75)*T+.9375)+k:D*(7.5625*(T-=2.625/2.75)*T+.984375)+k}function oe(T,k,D,A){return T<A/2?re(T*2,0,D,A)*.5+k:he(T*2-A,0,D,A)*.5+D*.5+k}e.util.ease={easeInQuad:function(T,k,D,A){return D*(T/=A)*T+k},easeOutQuad:function(T,k,D,A){return-D*(T/=A)*(T-2)+k},easeInOutQuad:function(T,k,D,A){return T/=A/2,T<1?D/2*T*T+k:-D/2*(--T*(T-2)-1)+k},easeInCubic:function(T,k,D,A){return D*(T/=A)*T*T+k},easeOutCubic:c,easeInOutCubic:l,easeInQuart:i,easeOutQuart:s,easeInOutQuart:n,easeInQuint:o,easeOutQuint:f,easeInOutQuint:a,easeInSine:d,easeOutSine:p,easeInOutSine:v,easeInExpo:b,easeOutExpo:C,easeInOutExpo:w,easeInCirc:S,easeOutCirc:E,easeInOutCirc:P,easeInElastic:N,easeOutElastic:K,easeInOutElastic:Z,easeInBack:W,easeOutBack:U,easeInOutBack:te,easeInBounce:re,easeOutBounce:he,easeInOutBounce:oe}}(),function(h){var t=h.fabric||(h.fabric={}),c=t.util.object.extend,l=t.util.object.clone,i=t.util.toFixed,s=t.util.parseUnit,n=t.util.multiplyTransformMatrices,o=["path","circle","polygon","polyline","ellipse","rect","line","image","text"],f=["symbol","image","marker","pattern","view","svg"],a=["pattern","defs","symbol","metadata","clipPath","mask","desc"],d=["symbol","g","a","svg","clipPath","defs"],p={cx:"left",x:"left",r:"radius",cy:"top",y:"top",display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform","image-rendering":"imageSmoothing"},v={stroke:"strokeOpacity",fill:"fillOpacity"},b="font-size",C="clip-path";t.svgValidTagNamesRegEx=E(o),t.svgViewBoxElementsRegEx=E(f),t.svgInvalidAncestorsRegEx=E(a),t.svgValidParentsRegEx=E(d),t.cssRules={},t.gradientDefs={},t.clipPaths={};function w(O){return O in p?p[O]:O}function S(O,x,I,L){var z=Array.isArray(x),j;if((O==="fill"||O==="stroke")&&x==="none")x="";else{if(O==="strokeUniform")return x==="non-scaling-stroke";if(O==="strokeDashArray")x==="none"?x=null:x=x.replace(/,/g," ").split(/\s+/).map(parseFloat);else if(O==="transformMatrix")I&&I.transformMatrix?x=n(I.transformMatrix,t.parseTransformAttribute(x)):x=t.parseTransformAttribute(x);else if(O==="visible")x=x!=="none"&&x!=="hidden",I&&I.visible===!1&&(x=!1);else if(O==="opacity")x=parseFloat(x),I&&typeof I.opacity<"u"&&(x*=I.opacity);else if(O==="textAnchor")x=x==="start"?"left":x==="end"?"right":"center";else if(O==="charSpacing")j=s(x,L)/L*1e3;else if(O==="paintFirst"){var Q=x.indexOf("fill"),F=x.indexOf("stroke"),x="fill";(Q>-1&&F>-1&&F<Q||Q===-1&&F>-1)&&(x="stroke")}else{if(O==="href"||O==="xlink:href"||O==="font")return x;if(O==="imageSmoothing")return x==="optimizeQuality";j=z?x.map(s):s(x,L)}}return!z&&isNaN(j)?x:j}function E(O){return new RegExp("^("+O.join("|")+")\\b","i")}function P(O){for(var x in v)if(!(typeof O[v[x]]>"u"||O[x]==="")){if(typeof O[x]>"u"){if(!t.Object.prototype[x])continue;O[x]=t.Object.prototype[x]}if(O[x].indexOf("url(")!==0){var I=new t.Color(O[x]);O[x]=I.setAlpha(i(I.getAlpha()*O[v[x]],2)).toRgba()}}return O}function N(O,x){var I,L=[],z,j,Q;for(j=0,Q=x.length;j<Q;j++)I=x[j],z=O.getElementsByTagName(I),L=L.concat(Array.prototype.slice.call(z));return L}t.parseTransformAttribute=function(){function O(Y,de){var me=t.util.cos(de[0]),Ce=t.util.sin(de[0]),Pe=0,Te=0;de.length===3&&(Pe=de[1],Te=de[2]),Y[0]=me,Y[1]=Ce,Y[2]=-Ce,Y[3]=me,Y[4]=Pe-(me*Pe-Ce*Te),Y[5]=Te-(Ce*Pe+me*Te)}function x(Y,de){var me=de[0],Ce=de.length===2?de[1]:de[0];Y[0]=me,Y[3]=Ce}function I(Y,de,me){Y[me]=Math.tan(t.util.degreesToRadians(de[0]))}function L(Y,de){Y[4]=de[0],de.length===2&&(Y[5]=de[1])}var z=t.iMatrix,j=t.reNum,Q=t.commaWsp,F="(?:(skewX)\\s*\\(\\s*("+j+")\\s*\\))",ie="(?:(skewY)\\s*\\(\\s*("+j+")\\s*\\))",H="(?:(rotate)\\s*\\(\\s*("+j+")(?:"+Q+"("+j+")"+Q+"("+j+"))?\\s*\\))",R="(?:(scale)\\s*\\(\\s*("+j+")(?:"+Q+"("+j+"))?\\s*\\))",V="(?:(translate)\\s*\\(\\s*("+j+")(?:"+Q+"("+j+"))?\\s*\\))",J="(?:(matrix)\\s*\\(\\s*("+j+")"+Q+"("+j+")"+Q+"("+j+")"+Q+"("+j+")"+Q+"("+j+")"+Q+"("+j+")\\s*\\))",X="(?:"+J+"|"+V+"|"+R+"|"+H+"|"+F+"|"+ie+")",$="(?:"+X+"(?:"+Q+"*"+X+")*)",ne="^\\s*(?:"+$+"?)\\s*$",pe=new RegExp(ne),ue=new RegExp(X,"g");return function(Y){var de=z.concat(),me=[];if(!Y||Y&&!pe.test(Y))return de;Y.replace(ue,function(Pe){var Te=new RegExp(X).exec(Pe).filter(function(vt){return!!vt}),He=Te[1],Ie=Te.slice(2).map(parseFloat);switch(He){case"translate":L(de,Ie);break;case"rotate":Ie[0]=t.util.degreesToRadians(Ie[0]),O(de,Ie);break;case"scale":x(de,Ie);break;case"skewX":I(de,Ie,2);break;case"skewY":I(de,Ie,1);break;case"matrix":de=Ie;break}me.push(de.concat()),de=z.concat()});for(var Ce=me[0];me.length>1;)me.shift(),Ce=t.util.multiplyTransformMatrices(Ce,me[0]);return Ce}}();function K(O,x){var I,L;O.replace(/;\s*$/,"").split(";").forEach(function(z){var j=z.split(":");I=j[0].trim().toLowerCase(),L=j[1].trim(),x[I]=L})}function Z(O,x){var I,L;for(var z in O)typeof O[z]>"u"||(I=z.toLowerCase(),L=O[z],x[I]=L)}function W(O,x){var I={};for(var L in t.cssRules[x])if(U(O,L.split(" ")))for(var z in t.cssRules[x][L])I[z]=t.cssRules[x][L][z];return I}function U(O,x){var I,L=!0;return I=re(O,x.pop()),I&&x.length&&(L=te(O,x)),I&&L&&x.length===0}function te(O,x){for(var I,L=!0;O.parentNode&&O.parentNode.nodeType===1&&x.length;)L&&(I=x.pop()),O=O.parentNode,L=re(O,I);return x.length===0}function re(O,x){var I=O.nodeName,L=O.getAttribute("class"),z=O.getAttribute("id"),j,Q;if(j=new RegExp("^"+I,"i"),x=x.replace(j,""),z&&x.length&&(j=new RegExp("#"+z+"(?![a-zA-Z\\-]+)","i"),x=x.replace(j,"")),L&&x.length)for(L=L.split(" "),Q=L.length;Q--;)j=new RegExp("\\."+L[Q]+"(?![a-zA-Z\\-]+)","i"),x=x.replace(j,"");return x.length===0}function he(O,x){var I;if(O.getElementById&&(I=O.getElementById(x)),I)return I;var L,z,j,Q=O.getElementsByTagName("*");for(z=0,j=Q.length;z<j;z++)if(L=Q[z],x===L.getAttribute("id"))return L}function oe(O){for(var x=N(O,["use","svg:use"]),I=0;x.length&&I<x.length;){var L=x[I],z=L.getAttribute("xlink:href")||L.getAttribute("href");if(z===null)return;var j=z.slice(1),Q=L.getAttribute("x")||0,F=L.getAttribute("y")||0,ie=he(O,j).cloneNode(!0),H=(ie.getAttribute("transform")||"")+" translate("+Q+", "+F+")",R,V=x.length,J,X,$,ne,pe=t.svgNS;if(k(ie),/^svg$/i.test(ie.nodeName)){var ue=ie.ownerDocument.createElementNS(pe,"g");for(X=0,$=ie.attributes,ne=$.length;X<ne;X++)J=$.item(X),ue.setAttributeNS(pe,J.nodeName,J.nodeValue);for(;ie.firstChild;)ue.appendChild(ie.firstChild);ie=ue}for(X=0,$=L.attributes,ne=$.length;X<ne;X++)J=$.item(X),!(J.nodeName==="x"||J.nodeName==="y"||J.nodeName==="xlink:href"||J.nodeName==="href")&&(J.nodeName==="transform"?H=J.nodeValue+" "+H:ie.setAttribute(J.nodeName,J.nodeValue));ie.setAttribute("transform",H),ie.setAttribute("instantiated_by_use","1"),ie.removeAttribute("id"),R=L.parentNode,R.replaceChild(ie,L),x.length===V&&I++}}var T=new RegExp("^\\s*("+t.reNum+"+)\\s*,?\\s*("+t.reNum+"+)\\s*,?\\s*("+t.reNum+"+)\\s*,?\\s*("+t.reNum+"+)\\s*$");function k(O){if(!t.svgViewBoxElementsRegEx.test(O.nodeName))return{};var x=O.getAttribute("viewBox"),I=1,L=1,z=0,j=0,Q,F,ie,H,R=O.getAttribute("width"),V=O.getAttribute("height"),J=O.getAttribute("x")||0,X=O.getAttribute("y")||0,$=O.getAttribute("preserveAspectRatio")||"",ne=!x||!(x=x.match(T)),pe=!R||!V||R==="100%"||V==="100%",ue=ne&&pe,Y={},de="",me=0,Ce=0;if(Y.width=0,Y.height=0,Y.toBeParsed=ue,ne&&(J||X)&&O.parentNode&&O.parentNode.nodeName!=="#document"&&(de=" translate("+s(J)+" "+s(X)+") ",ie=(O.getAttribute("transform")||"")+de,O.setAttribute("transform",ie),O.removeAttribute("x"),O.removeAttribute("y")),ue)return Y;if(ne)return Y.width=s(R),Y.height=s(V),Y;if(z=-parseFloat(x[1]),j=-parseFloat(x[2]),Q=parseFloat(x[3]),F=parseFloat(x[4]),Y.minX=z,Y.minY=j,Y.viewBoxWidth=Q,Y.viewBoxHeight=F,pe?(Y.width=Q,Y.height=F):(Y.width=s(R),Y.height=s(V),I=Y.width/Q,L=Y.height/F),$=t.util.parsePreserveAspectRatioAttribute($),$.alignX!=="none"&&($.meetOrSlice==="meet"&&(L=I=I>L?L:I),$.meetOrSlice==="slice"&&(L=I=I>L?I:L),me=Y.width-Q*I,Ce=Y.height-F*I,$.alignX==="Mid"&&(me/=2),$.alignY==="Mid"&&(Ce/=2),$.alignX==="Min"&&(me=0),$.alignY==="Min"&&(Ce=0)),I===1&&L===1&&z===0&&j===0&&J===0&&X===0)return Y;if((J||X)&&O.parentNode.nodeName!=="#document"&&(de=" translate("+s(J)+" "+s(X)+") "),ie=de+" matrix("+I+" 0 0 "+L+" "+(z*I+me)+" "+(j*L+Ce)+") ",O.nodeName==="svg"){for(H=O.ownerDocument.createElementNS(t.svgNS,"g");O.firstChild;)H.appendChild(O.firstChild);O.appendChild(H)}else H=O,H.removeAttribute("x"),H.removeAttribute("y"),ie=H.getAttribute("transform")+ie;return H.setAttribute("transform",ie),Y}function D(O,x){for(;O&&(O=O.parentNode);)if(O.nodeName&&x.test(O.nodeName.replace("svg:",""))&&!O.getAttribute("instantiated_by_use"))return!0;return!1}t.parseSVGDocument=function(O,x,I,L){if(O){oe(O);var z=t.Object.__uid++,j,Q,F=k(O),ie=t.util.toArray(O.getElementsByTagName("*"));if(F.crossOrigin=L&&L.crossOrigin,F.svgUid=z,ie.length===0&&t.isLikelyNode){ie=O.selectNodes('//*[name(.)!="svg"]');var H=[];for(j=0,Q=ie.length;j<Q;j++)H[j]=ie[j];ie=H}var R=ie.filter(function(J){return k(J),t.svgValidTagNamesRegEx.test(J.nodeName.replace("svg:",""))&&!D(J,t.svgInvalidAncestorsRegEx)});if(!R||R&&!R.length){x&&x([],{});return}var V={};ie.filter(function(J){return J.nodeName.replace("svg:","")==="clipPath"}).forEach(function(J){var X=J.getAttribute("id");V[X]=t.util.toArray(J.getElementsByTagName("*")).filter(function($){return t.svgValidTagNamesRegEx.test($.nodeName.replace("svg:",""))})}),t.gradientDefs[z]=t.getGradientDefs(O),t.cssRules[z]=t.getCSSRules(O),t.clipPaths[z]=V,t.parseElements(R,function(J,X){x&&(x(J,F,X,ie),delete t.gradientDefs[z],delete t.cssRules[z],delete t.clipPaths[z])},l(F),I,L)}};function A(O,x){var I=["gradientTransform","x1","x2","y1","y2","gradientUnits","cx","cy","r","fx","fy"],L="xlink:href",z=x.getAttribute(L).slice(1),j=he(O,z);if(j&&j.getAttribute(L)&&A(O,j),I.forEach(function(F){j&&!x.hasAttribute(F)&&j.hasAttribute(F)&&x.setAttribute(F,j.getAttribute(F))}),!x.children.length)for(var Q=j.cloneNode(!0);Q.firstChild;)x.appendChild(Q.firstChild);x.removeAttribute(L)}var B=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+t.reNum+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+t.reNum+"))?\\s+(.*)");c(t,{parseFontDeclaration:function(O,x){var I=O.match(B);if(I){var L=I[1],z=I[3],j=I[4],Q=I[5],F=I[6];L&&(x.fontStyle=L),z&&(x.fontWeight=isNaN(parseFloat(z))?z:parseFloat(z)),j&&(x.fontSize=s(j)),F&&(x.fontFamily=F),Q&&(x.lineHeight=Q==="normal"?1:Q)}},getGradientDefs:function(O){var x=["linearGradient","radialGradient","svg:linearGradient","svg:radialGradient"],I=N(O,x),L,z=0,j={};for(z=I.length;z--;)L=I[z],L.getAttribute("xlink:href")&&A(O,L),j[L.getAttribute("id")]=L;return j},parseAttributes:function(O,x,I){if(O){var L,z={},j,Q;typeof I>"u"&&(I=O.getAttribute("svgUid")),O.parentNode&&t.svgValidParentsRegEx.test(O.parentNode.nodeName)&&(z=t.parseAttributes(O.parentNode,x,I));var F=x.reduce(function($,ne){return L=O.getAttribute(ne),L&&($[ne]=L),$},{}),ie=c(W(O,I),t.parseStyleAttribute(O));F=c(F,ie),ie[C]&&O.setAttribute(C,ie[C]),j=Q=z.fontSize||t.Text.DEFAULT_SVG_FONT_SIZE,F[b]&&(F[b]=j=s(F[b],Q));var H,R,V={};for(var J in F)H=w(J),R=S(H,F[J],z,j),V[H]=R;V&&V.font&&t.parseFontDeclaration(V.font,V);var X=c(z,V);return t.svgValidParentsRegEx.test(O.nodeName)?X:P(X)}},parseElements:function(O,x,I,L,z){new t.ElementsParser(O,x,I,L,z).parse()},parseStyleAttribute:function(O){var x={},I=O.getAttribute("style");return I&&(typeof I=="string"?K(I,x):Z(I,x)),x},parsePointsAttribute:function(O){if(!O)return null;O=O.replace(/,/g," ").trim(),O=O.split(/\s+/);var x=[],I,L;for(I=0,L=O.length;I<L;I+=2)x.push({x:parseFloat(O[I]),y:parseFloat(O[I+1])});return x},getCSSRules:function(O){var x=O.getElementsByTagName("style"),I,L,z={},j;for(I=0,L=x.length;I<L;I++){var Q=x[I].textContent;Q=Q.replace(/\/\*[\s\S]*?\*\//g,""),Q.trim()!==""&&(j=Q.split("}"),j=j.filter(function(F){return F.trim()}),j.forEach(function(F){var ie=F.split("{"),H={},R=ie[1].trim(),V=R.split(";").filter(function(ne){return ne.trim()});for(I=0,L=V.length;I<L;I++){var J=V[I].split(":"),X=J[0].trim(),$=J[1].trim();H[X]=$}F=ie[0].trim(),F.split(",").forEach(function(ne){ne=ne.replace(/^svg/i,"").trim(),ne!==""&&(z[ne]?t.util.object.extend(z[ne],H):z[ne]=t.util.object.clone(H))})}))}return z},loadSVGFromURL:function(O,x,I,L){O=O.replace(/^\n\s*/,"").trim(),new t.util.request(O,{method:"get",onComplete:z});function z(j){var Q=j.responseXML;if(!Q||!Q.documentElement)return x&&x(null),!1;t.parseSVGDocument(Q.documentElement,function(F,ie,H,R){x&&x(F,ie,H,R)},I,L)}},loadSVGFromString:function(O,x,I,L){var z=new t.window.DOMParser,j=z.parseFromString(O.trim(),"text/xml");t.parseSVGDocument(j.documentElement,function(Q,F,ie,H){x(Q,F,ie,H)},I,L)}})}(r),e.ElementsParser=function(h,t,c,l,i,s){this.elements=h,this.callback=t,this.options=c,this.reviver=l,this.svgUid=c&&c.svgUid||0,this.parsingOptions=i,this.regexUrl=/^url\(['"]?#([^'"]+)['"]?\)/g,this.doc=s},function(h){h.parse=function(){this.instances=new Array(this.elements.length),this.numElements=this.elements.length,this.createObjects()},h.createObjects=function(){var t=this;this.elements.forEach(function(c,l){c.setAttribute("svgUid",t.svgUid),t.createObject(c,l)})},h.findTag=function(t){return e[e.util.string.capitalize(t.tagName.replace("svg:",""))]},h.createObject=function(t,c){var l=this.findTag(t);if(l&&l.fromElement)try{l.fromElement(t,this.createCallback(c,t),this.options)}catch(i){e.log(i)}else this.checkIfDone()},h.createCallback=function(t,c){var l=this;return function(i){var s;l.resolveGradient(i,c,"fill"),l.resolveGradient(i,c,"stroke"),i instanceof e.Image&&i._originalElement&&(s=i.parsePreserveAspectRatioAttribute(c)),i._removeTransformMatrix(s),l.resolveClipPath(i,c),l.reviver&&l.reviver(c,i),l.instances[t]=i,l.checkIfDone()}},h.extractPropertyDefinition=function(t,c,l){var i=t[c],s=this.regexUrl;if(s.test(i)){s.lastIndex=0;var n=s.exec(i)[1];return s.lastIndex=0,e[l][this.svgUid][n]}},h.resolveGradient=function(t,c,l){var i=this.extractPropertyDefinition(t,l,"gradientDefs");if(i){var s=c.getAttribute(l+"-opacity"),n=e.Gradient.fromElement(i,t,s,this.options);t.set(l,n)}},h.createClipPathCallback=function(t,c){return function(l){l._removeTransformMatrix(),l.fillRule=l.clipRule,c.push(l)}},h.resolveClipPath=function(t,c){var l=this.extractPropertyDefinition(t,"clipPath","clipPaths"),i,s,n,o,f,a;if(l){o=[],n=e.util.invertTransform(t.calcTransformMatrix());for(var d=l[0].parentNode,p=c;p.parentNode&&p.getAttribute("clip-path")!==t.clipPath;)p=p.parentNode;p.parentNode.appendChild(d);for(var v=0;v<l.length;v++)i=l[v],s=this.findTag(i),s.fromElement(i,this.createClipPathCallback(t,o),this.options);o.length===1?l=o[0]:l=new e.Group(o),f=e.util.multiplyTransformMatrices(n,l.calcTransformMatrix()),l.clipPath&&this.resolveClipPath(l,p);var a=e.util.qrDecompose(f);l.flipX=!1,l.flipY=!1,l.set("scaleX",a.scaleX),l.set("scaleY",a.scaleY),l.angle=a.angle,l.skewX=a.skewX,l.skewY=0,l.setPositionByOrigin({x:a.translateX,y:a.translateY},"center","center"),t.clipPath=l}else delete t.clipPath},h.checkIfDone=function(){--this.numElements===0&&(this.instances=this.instances.filter(function(t){return t!=null}),this.callback(this.instances,this.elements))}}(e.ElementsParser.prototype),function(h){var t=h.fabric||(h.fabric={});if(t.Point){t.warn("fabric.Point is already defined");return}t.Point=c;function c(l,i){this.x=l,this.y=i}c.prototype={type:"point",constructor:c,add:function(l){return new c(this.x+l.x,this.y+l.y)},addEquals:function(l){return this.x+=l.x,this.y+=l.y,this},scalarAdd:function(l){return new c(this.x+l,this.y+l)},scalarAddEquals:function(l){return this.x+=l,this.y+=l,this},subtract:function(l){return new c(this.x-l.x,this.y-l.y)},subtractEquals:function(l){return this.x-=l.x,this.y-=l.y,this},scalarSubtract:function(l){return new c(this.x-l,this.y-l)},scalarSubtractEquals:function(l){return this.x-=l,this.y-=l,this},multiply:function(l){return new c(this.x*l,this.y*l)},multiplyEquals:function(l){return this.x*=l,this.y*=l,this},divide:function(l){return new c(this.x/l,this.y/l)},divideEquals:function(l){return this.x/=l,this.y/=l,this},eq:function(l){return this.x===l.x&&this.y===l.y},lt:function(l){return this.x<l.x&&this.y<l.y},lte:function(l){return this.x<=l.x&&this.y<=l.y},gt:function(l){return this.x>l.x&&this.y>l.y},gte:function(l){return this.x>=l.x&&this.y>=l.y},lerp:function(l,i){return typeof i>"u"&&(i=.5),i=Math.max(Math.min(1,i),0),new c(this.x+(l.x-this.x)*i,this.y+(l.y-this.y)*i)},distanceFrom:function(l){var i=this.x-l.x,s=this.y-l.y;return Math.sqrt(i*i+s*s)},midPointFrom:function(l){return this.lerp(l)},min:function(l){return new c(Math.min(this.x,l.x),Math.min(this.y,l.y))},max:function(l){return new c(Math.max(this.x,l.x),Math.max(this.y,l.y))},toString:function(){return this.x+","+this.y},setXY:function(l,i){return this.x=l,this.y=i,this},setX:function(l){return this.x=l,this},setY:function(l){return this.y=l,this},setFromPoint:function(l){return this.x=l.x,this.y=l.y,this},swap:function(l){var i=this.x,s=this.y;this.x=l.x,this.y=l.y,l.x=i,l.y=s},clone:function(){return new c(this.x,this.y)}}}(r),function(h){var t=h.fabric||(h.fabric={});if(t.Intersection){t.warn("fabric.Intersection is already defined");return}function c(l){this.status=l,this.points=[]}t.Intersection=c,t.Intersection.prototype={constructor:c,appendPoint:function(l){return this.points.push(l),this},appendPoints:function(l){return this.points=this.points.concat(l),this}},t.Intersection.intersectLineLine=function(l,i,s,n){var o,f=(n.x-s.x)*(l.y-s.y)-(n.y-s.y)*(l.x-s.x),a=(i.x-l.x)*(l.y-s.y)-(i.y-l.y)*(l.x-s.x),d=(n.y-s.y)*(i.x-l.x)-(n.x-s.x)*(i.y-l.y);if(d!==0){var p=f/d,v=a/d;0<=p&&p<=1&&0<=v&&v<=1?(o=new c("Intersection"),o.appendPoint(new t.Point(l.x+p*(i.x-l.x),l.y+p*(i.y-l.y)))):o=new c}else f===0||a===0?o=new c("Coincident"):o=new c("Parallel");return o},t.Intersection.intersectLinePolygon=function(l,i,s){var n=new c,o=s.length,f,a,d,p;for(p=0;p<o;p++)f=s[p],a=s[(p+1)%o],d=c.intersectLineLine(l,i,f,a),n.appendPoints(d.points);return n.points.length>0&&(n.status="Intersection"),n},t.Intersection.intersectPolygonPolygon=function(l,i){var s=new c,n=l.length,o;for(o=0;o<n;o++){var f=l[o],a=l[(o+1)%n],d=c.intersectLinePolygon(f,a,i);s.appendPoints(d.points)}return s.points.length>0&&(s.status="Intersection"),s},t.Intersection.intersectPolygonRectangle=function(l,i,s){var n=i.min(s),o=i.max(s),f=new t.Point(o.x,n.y),a=new t.Point(n.x,o.y),d=c.intersectLinePolygon(n,f,l),p=c.intersectLinePolygon(f,o,l),v=c.intersectLinePolygon(o,a,l),b=c.intersectLinePolygon(a,n,l),C=new c;return C.appendPoints(d.points),C.appendPoints(p.points),C.appendPoints(v.points),C.appendPoints(b.points),C.points.length>0&&(C.status="Intersection"),C}}(r),function(h){var t=h.fabric||(h.fabric={});if(t.Color){t.warn("fabric.Color is already defined.");return}function c(i){i?this._tryParsingColor(i):this.setSource([0,0,0,1])}t.Color=c,t.Color.prototype={_tryParsingColor:function(i){var s;i in c.colorNameMap&&(i=c.colorNameMap[i]),i==="transparent"&&(s=[255,255,255,0]),s||(s=c.sourceFromHex(i)),s||(s=c.sourceFromRgb(i)),s||(s=c.sourceFromHsl(i)),s||(s=[0,0,0,1]),s&&this.setSource(s)},_rgbToHsl:function(i,s,n){i/=255,s/=255,n/=255;var o,f,a,d=t.util.array.max([i,s,n]),p=t.util.array.min([i,s,n]);if(a=(d+p)/2,d===p)o=f=0;else{var v=d-p;switch(f=a>.5?v/(2-d-p):v/(d+p),d){case i:o=(s-n)/v+(s<n?6:0);break;case s:o=(n-i)/v+2;break;case n:o=(i-s)/v+4;break}o/=6}return[Math.round(o*360),Math.round(f*100),Math.round(a*100)]},getSource:function(){return this._source},setSource:function(i){this._source=i},toRgb:function(){var i=this.getSource();return"rgb("+i[0]+","+i[1]+","+i[2]+")"},toRgba:function(){var i=this.getSource();return"rgba("+i[0]+","+i[1]+","+i[2]+","+i[3]+")"},toHsl:function(){var i=this.getSource(),s=this._rgbToHsl(i[0],i[1],i[2]);return"hsl("+s[0]+","+s[1]+"%,"+s[2]+"%)"},toHsla:function(){var i=this.getSource(),s=this._rgbToHsl(i[0],i[1],i[2]);return"hsla("+s[0]+","+s[1]+"%,"+s[2]+"%,"+i[3]+")"},toHex:function(){var i=this.getSource(),s,n,o;return s=i[0].toString(16),s=s.length===1?"0"+s:s,n=i[1].toString(16),n=n.length===1?"0"+n:n,o=i[2].toString(16),o=o.length===1?"0"+o:o,s.toUpperCase()+n.toUpperCase()+o.toUpperCase()},toHexa:function(){var i=this.getSource(),s;return s=Math.round(i[3]*255),s=s.toString(16),s=s.length===1?"0"+s:s,this.toHex()+s.toUpperCase()},getAlpha:function(){return this.getSource()[3]},setAlpha:function(i){var s=this.getSource();return s[3]=i,this.setSource(s),this},toGrayscale:function(){var i=this.getSource(),s=parseInt((i[0]*.3+i[1]*.59+i[2]*.11).toFixed(0),10),n=i[3];return this.setSource([s,s,s,n]),this},toBlackWhite:function(i){var s=this.getSource(),n=(s[0]*.3+s[1]*.59+s[2]*.11).toFixed(0),o=s[3];return i=i||127,n=Number(n)<Number(i)?0:255,this.setSource([n,n,n,o]),this},overlayWith:function(i){i instanceof c||(i=new c(i));var s=[],n=this.getAlpha(),o=.5,f=this.getSource(),a=i.getSource(),d;for(d=0;d<3;d++)s.push(Math.round(f[d]*(1-o)+a[d]*o));return s[3]=n,this.setSource(s),this}},t.Color.reRGBa=/^rgba?\(\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*(?:\s*,\s*((?:\d*\.?\d+)?)\s*)?\)$/i,t.Color.reHSLa=/^hsla?\(\s*(\d{1,3})\s*,\s*(\d{1,3}\%)\s*,\s*(\d{1,3}\%)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/i,t.Color.reHex=/^#?([0-9a-f]{8}|[0-9a-f]{6}|[0-9a-f]{4}|[0-9a-f]{3})$/i,t.Color.colorNameMap={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#00FFFF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blue:"#0000FF",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#FF00FF",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#00FF00",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#663399",red:"#FF0000",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFFFFF",whitesmoke:"#F5F5F5",yellow:"#FFFF00",yellowgreen:"#9ACD32"};function l(i,s,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?i+(s-i)*6*n:n<1/2?s:n<2/3?i+(s-i)*(2/3-n)*6:i}t.Color.fromRgb=function(i){return c.fromSource(c.sourceFromRgb(i))},t.Color.sourceFromRgb=function(i){var s=i.match(c.reRGBa);if(s){var n=parseInt(s[1],10)/(/%$/.test(s[1])?100:1)*(/%$/.test(s[1])?255:1),o=parseInt(s[2],10)/(/%$/.test(s[2])?100:1)*(/%$/.test(s[2])?255:1),f=parseInt(s[3],10)/(/%$/.test(s[3])?100:1)*(/%$/.test(s[3])?255:1);return[parseInt(n,10),parseInt(o,10),parseInt(f,10),s[4]?parseFloat(s[4]):1]}},t.Color.fromRgba=c.fromRgb,t.Color.fromHsl=function(i){return c.fromSource(c.sourceFromHsl(i))},t.Color.sourceFromHsl=function(i){var s=i.match(c.reHSLa);if(s){var n=(parseFloat(s[1])%360+360)%360/360,o=parseFloat(s[2])/(/%$/.test(s[2])?100:1),f=parseFloat(s[3])/(/%$/.test(s[3])?100:1),a,d,p;if(o===0)a=d=p=f;else{var v=f<=.5?f*(o+1):f+o-f*o,b=f*2-v;a=l(b,v,n+1/3),d=l(b,v,n),p=l(b,v,n-1/3)}return[Math.round(a*255),Math.round(d*255),Math.round(p*255),s[4]?parseFloat(s[4]):1]}},t.Color.fromHsla=c.fromHsl,t.Color.fromHex=function(i){return c.fromSource(c.sourceFromHex(i))},t.Color.sourceFromHex=function(i){if(i.match(c.reHex)){var s=i.slice(i.indexOf("#")+1),n=s.length===3||s.length===4,o=s.length===8||s.length===4,f=n?s.charAt(0)+s.charAt(0):s.substring(0,2),a=n?s.charAt(1)+s.charAt(1):s.substring(2,4),d=n?s.charAt(2)+s.charAt(2):s.substring(4,6),p=o?n?s.charAt(3)+s.charAt(3):s.substring(6,8):"FF";return[parseInt(f,16),parseInt(a,16),parseInt(d,16),parseFloat((parseInt(p,16)/255).toFixed(2))]}},t.Color.fromSource=function(i){var s=new c;return s.setSource(i),s}}(r),function(h){var t=h.fabric||(h.fabric={}),c=["e","se","s","sw","w","nw","n","ne","e"],l=["ns","nesw","ew","nwse"],i={},s="left",n="top",o="right",f="bottom",a="center",d={top:f,bottom:n,left:o,right:s,center:a},p=t.util.radiansToDegrees,v=Math.sign||function(H){return(H>0)-(H<0)||+H};function b(H,R){var V=H.angle+p(Math.atan2(R.y,R.x))+360;return Math.round(V%360/45)}function C(H,R){var V=R.transform.target,J=V.canvas,X=t.util.object.clone(R);X.target=V,J&&J.fire("object:"+H,X),V.fire(H,R)}function w(H,R){var V=R.canvas,J=V.uniScaleKey,X=H[J];return V.uniformScaling&&!X||!V.uniformScaling&&X}function S(H){return H.originX===a&&H.originY===a}function E(H,R,V){var J=H.lockScalingX,X=H.lockScalingY;return!!(J&&X||!R&&(J||X)&&V||J&&R==="x"||X&&R==="y")}function P(H,R,V){var J="not-allowed",X=w(H,V),$="";if(R.x!==0&&R.y===0?$="x":R.x===0&&R.y!==0&&($="y"),E(V,$,X))return J;var ne=b(V,R);return c[ne]+"-resize"}function N(H,R,V){var J="not-allowed";if(R.x!==0&&V.lockSkewingY||R.y!==0&&V.lockSkewingX)return J;var X=b(V,R)%4;return l[X]+"-resize"}function K(H,R,V){return H[V.canvas.altActionKey]?i.skewCursorStyleHandler(H,R,V):i.scaleCursorStyleHandler(H,R,V)}function Z(H,R,V){var J=H[V.canvas.altActionKey];if(R.x===0)return J?"skewX":"scaleY";if(R.y===0)return J?"skewY":"scaleX"}function W(H,R,V){return V.lockRotation?"not-allowed":R.cursorStyle}function U(H,R,V,J){return{e:H,transform:R,pointer:{x:V,y:J}}}function te(H){return function(R,V,J,X){var $=V.target,ne=$.getCenterPoint(),pe=$.translateToOriginPoint(ne,V.originX,V.originY),ue=H(R,V,J,X);return $.setPositionByOrigin(pe,V.originX,V.originY),ue}}function re(H,R){return function(V,J,X,$){var ne=R(V,J,X,$);return ne&&C(H,U(V,J,X,$)),ne}}function he(H,R,V,J,X){var $=H.target,ne=$.controls[H.corner],pe=$.canvas.getZoom(),ue=$.padding/pe,Y=$.toLocalPoint(new t.Point(J,X),R,V);return Y.x>=ue&&(Y.x-=ue),Y.x<=-ue&&(Y.x+=ue),Y.y>=ue&&(Y.y-=ue),Y.y<=ue&&(Y.y+=ue),Y.x-=ne.offsetX,Y.y-=ne.offsetY,Y}function oe(H){return H.flipX!==H.flipY}function T(H,R,V,J,X){if(H[R]!==0){var $=H._getTransformedDimensions()[J],ne=X/$*H[V];H.set(V,ne)}}function k(H,R,V,J){var X=R.target,$=X._getTransformedDimensions(0,X.skewY),ne=he(R,R.originX,R.originY,V,J),pe=Math.abs(ne.x*2)-$.x,ue=X.skewX,Y;pe<2?Y=0:(Y=p(Math.atan2(pe/X.scaleX,$.y/X.scaleY)),R.originX===s&&R.originY===f&&(Y=-Y),R.originX===o&&R.originY===n&&(Y=-Y),oe(X)&&(Y=-Y));var de=ue!==Y;if(de){var me=X._getTransformedDimensions().y;X.set("skewX",Y),T(X,"skewY","scaleY","y",me)}return de}function D(H,R,V,J){var X=R.target,$=X._getTransformedDimensions(X.skewX,0),ne=he(R,R.originX,R.originY,V,J),pe=Math.abs(ne.y*2)-$.y,ue=X.skewY,Y;pe<2?Y=0:(Y=p(Math.atan2(pe/X.scaleY,$.x/X.scaleX)),R.originX===s&&R.originY===f&&(Y=-Y),R.originX===o&&R.originY===n&&(Y=-Y),oe(X)&&(Y=-Y));var de=ue!==Y;if(de){var me=X._getTransformedDimensions().x;X.set("skewY",Y),T(X,"skewX","scaleX","x",me)}return de}function A(H,R,V,J){var X=R.target,$=X.skewX,ne,pe=R.originY;if(X.lockSkewingX)return!1;if($===0){var ue=he(R,a,a,V,J);ue.x>0?ne=s:ne=o}else $>0&&(ne=pe===n?s:o),$<0&&(ne=pe===n?o:s),oe(X)&&(ne=ne===s?o:s);R.originX=ne;var Y=re("skewing",te(k));return Y(H,R,V,J)}function B(H,R,V,J){var X=R.target,$=X.skewY,ne,pe=R.originX;if(X.lockSkewingY)return!1;if($===0){var ue=he(R,a,a,V,J);ue.y>0?ne=n:ne=f}else $>0&&(ne=pe===s?n:f),$<0&&(ne=pe===s?f:n),oe(X)&&(ne=ne===n?f:n);R.originY=ne;var Y=re("skewing",te(D));return Y(H,R,V,J)}function O(H,R,V,J){var X=R,$=X.target,ne=$.translateToOriginPoint($.getCenterPoint(),X.originX,X.originY);if($.lockRotation)return!1;var pe=Math.atan2(X.ey-ne.y,X.ex-ne.x),ue=Math.atan2(J-ne.y,V-ne.x),Y=p(ue-pe+X.theta),de=!0;if($.snapAngle>0){var me=$.snapAngle,Ce=$.snapThreshold||me,Pe=Math.ceil(Y/me)*me,Te=Math.floor(Y/me)*me;Math.abs(Y-Te)<Ce?Y=Te:Math.abs(Y-Pe)<Ce&&(Y=Pe)}return Y<0&&(Y=360+Y),Y%=360,de=$.angle!==Y,$.angle=Y,de}function x(H,R,V,J,X){X=X||{};var $=R.target,ne=$.lockScalingX,pe=$.lockScalingY,ue=X.by,Y,de,me,Ce,Pe=w(H,$),Te=E($,ue,Pe),He,Ie,vt=R.gestureScale;if(Te)return!1;if(vt)de=R.scaleX*vt,me=R.scaleY*vt;else{if(Y=he(R,R.originX,R.originY,V,J),He=ue!=="y"?v(Y.x):1,Ie=ue!=="x"?v(Y.y):1,R.signX||(R.signX=He),R.signY||(R.signY=Ie),$.lockScalingFlip&&(R.signX!==He||R.signY!==Ie))return!1;if(Ce=$._getTransformedDimensions(),Pe&&!ue){var Xt=Math.abs(Y.x)+Math.abs(Y.y),Qe=R.original,Ys=Math.abs(Ce.x*Qe.scaleX/$.scaleX)+Math.abs(Ce.y*Qe.scaleY/$.scaleY),xn=Xt/Ys;de=Qe.scaleX*xn,me=Qe.scaleY*xn}else de=Math.abs(Y.x*$.scaleX/Ce.x),me=Math.abs(Y.y*$.scaleY/Ce.y);S(R)&&(de*=2,me*=2),R.signX!==He&&ue!=="y"&&(R.originX=d[R.originX],de*=-1,R.signX=He),R.signY!==Ie&&ue!=="x"&&(R.originY=d[R.originY],me*=-1,R.signY=Ie)}var Vs=$.scaleX,Gs=$.scaleY;return ue?(ue==="x"&&$.set("scaleX",de),ue==="y"&&$.set("scaleY",me)):(!ne&&$.set("scaleX",de),!pe&&$.set("scaleY",me)),Vs!==$.scaleX||Gs!==$.scaleY}function I(H,R,V,J){return x(H,R,V,J)}function L(H,R,V,J){return x(H,R,V,J,{by:"x"})}function z(H,R,V,J){return x(H,R,V,J,{by:"y"})}function j(H,R,V,J){return H[R.target.canvas.altActionKey]?i.skewHandlerX(H,R,V,J):i.scalingY(H,R,V,J)}function Q(H,R,V,J){return H[R.target.canvas.altActionKey]?i.skewHandlerY(H,R,V,J):i.scalingX(H,R,V,J)}function F(H,R,V,J){var X=R.target,$=he(R,R.originX,R.originY,V,J),ne=X.strokeWidth/(X.strokeUniform?X.scaleX:1),pe=S(R)?2:1,ue=X.width,Y=Math.abs($.x*pe/X.scaleX)-ne;return X.set("width",Math.max(Y,0)),ue!==Y}function ie(H,R,V,J){var X=R.target,$=V-R.offsetX,ne=J-R.offsetY,pe=!X.get("lockMovementX")&&X.left!==$,ue=!X.get("lockMovementY")&&X.top!==ne;return pe&&X.set("left",$),ue&&X.set("top",ne),(pe||ue)&&C("moving",U(H,R,V,J)),pe||ue}i.scaleCursorStyleHandler=P,i.skewCursorStyleHandler=N,i.scaleSkewCursorStyleHandler=K,i.rotationWithSnapping=re("rotating",te(O)),i.scalingEqually=re("scaling",te(I)),i.scalingX=re("scaling",te(L)),i.scalingY=re("scaling",te(z)),i.scalingYOrSkewingX=j,i.scalingXOrSkewingY=Q,i.changeWidth=re("resizing",te(F)),i.skewHandlerX=A,i.skewHandlerY=B,i.dragHandler=ie,i.scaleOrSkewActionName=Z,i.rotationStyleHandler=W,i.fireEvent=C,i.wrapWithFixedAnchor=te,i.wrapWithFireEvent=re,i.getLocalPoint=he,t.controlsUtils=i}(r),function(h){var t=h.fabric||(h.fabric={}),c=t.util.degreesToRadians,l=t.controlsUtils;function i(n,o,f,a,d){a=a||{};var p=this.sizeX||a.cornerSize||d.cornerSize,v=this.sizeY||a.cornerSize||d.cornerSize,b=typeof a.transparentCorners<"u"?a.transparentCorners:d.transparentCorners,C=b?"stroke":"fill",w=!b&&(a.cornerStrokeColor||d.cornerStrokeColor),S=o,E=f,P;n.save(),n.fillStyle=a.cornerColor||d.cornerColor,n.strokeStyle=a.cornerStrokeColor||d.cornerStrokeColor,p>v?(P=p,n.scale(1,v/p),E=f*p/v):v>p?(P=v,n.scale(p/v,1),S=o*v/p):P=p,n.lineWidth=1,n.beginPath(),n.arc(S,E,P/2,0,2*Math.PI,!1),n[C](),w&&n.stroke(),n.restore()}function s(n,o,f,a,d){a=a||{};var p=this.sizeX||a.cornerSize||d.cornerSize,v=this.sizeY||a.cornerSize||d.cornerSize,b=typeof a.transparentCorners<"u"?a.transparentCorners:d.transparentCorners,C=b?"stroke":"fill",w=!b&&(a.cornerStrokeColor||d.cornerStrokeColor),S=p/2,E=v/2;n.save(),n.fillStyle=a.cornerColor||d.cornerColor,n.strokeStyle=a.cornerStrokeColor||d.cornerStrokeColor,n.lineWidth=1,n.translate(o,f),n.rotate(c(d.angle)),n[C+"Rect"](-S,-E,p,v),w&&n.strokeRect(-S,-E,p,v),n.restore()}l.renderCircleControl=i,l.renderSquareControl=s}(r),function(h){var t=h.fabric||(h.fabric={});function c(l){for(var i in l)this[i]=l[i]}t.Control=c,t.Control.prototype={visible:!0,actionName:"scale",angle:0,x:0,y:0,offsetX:0,offsetY:0,sizeX:null,sizeY:null,touchSizeX:null,touchSizeY:null,cursorStyle:"crosshair",withConnection:!1,actionHandler:function(){},mouseDownHandler:function(){},mouseUpHandler:function(){},getActionHandler:function(){return this.actionHandler},getMouseDownHandler:function(){return this.mouseDownHandler},getMouseUpHandler:function(){return this.mouseUpHandler},cursorStyleHandler:function(l,i){return i.cursorStyle},getActionName:function(l,i){return i.actionName},getVisibility:function(l,i){var s=l._controlsVisibility;return s&&typeof s[i]<"u"?s[i]:this.visible},setVisibility:function(l){this.visible=l},positionHandler:function(l,i){var s=t.util.transformPoint({x:this.x*l.x+this.offsetX,y:this.y*l.y+this.offsetY},i);return s},calcCornerCoords:function(l,i,s,n,o){var f,a,d,p,v=o?this.touchSizeX:this.sizeX,b=o?this.touchSizeY:this.sizeY;if(v&&b&&v!==b){var C=Math.atan2(b,v),w=Math.sqrt(v*v+b*b)/2,S=C-t.util.degreesToRadians(l),E=Math.PI/2-C-t.util.degreesToRadians(l);f=w*t.util.cos(S),a=w*t.util.sin(S),d=w*t.util.cos(E),p=w*t.util.sin(E)}else{var P=v&&b?v:i;w=P*.7071067812;var S=t.util.degreesToRadians(45-l);f=d=w*t.util.cos(S),a=p=w*t.util.sin(S)}return{tl:{x:s-p,y:n-d},tr:{x:s+f,y:n-a},bl:{x:s-f,y:n+a},br:{x:s+p,y:n+d}}},render:function(l,i,s,n,o){switch(n=n||{},n.cornerStyle||o.cornerStyle){case"circle":t.controlsUtils.renderCircleControl.call(this,l,i,s,n,o);break;default:t.controlsUtils.renderSquareControl.call(this,l,i,s,n,o)}}}}(r),function(){function h(s,n){var o=s.getAttribute("style"),f=s.getAttribute("offset")||0,a,d,p,v;if(f=parseFloat(f)/(/%$/.test(f)?100:1),f=f<0?0:f>1?1:f,o){var b=o.split(/\s*;\s*/);for(b[b.length-1]===""&&b.pop(),v=b.length;v--;){var C=b[v].split(/\s*:\s*/),w=C[0].trim(),S=C[1].trim();w==="stop-color"?a=S:w==="stop-opacity"&&(p=S)}}return a||(a=s.getAttribute("stop-color")||"rgb(0,0,0)"),p||(p=s.getAttribute("stop-opacity")),a=new e.Color(a),d=a.getAlpha(),p=isNaN(parseFloat(p))?1:parseFloat(p),p*=d*n,{offset:f,color:a.toRgb(),opacity:p}}function t(s){return{x1:s.getAttribute("x1")||0,y1:s.getAttribute("y1")||0,x2:s.getAttribute("x2")||"100%",y2:s.getAttribute("y2")||0}}function c(s){return{x1:s.getAttribute("fx")||s.getAttribute("cx")||"50%",y1:s.getAttribute("fy")||s.getAttribute("cy")||"50%",r1:0,x2:s.getAttribute("cx")||"50%",y2:s.getAttribute("cy")||"50%",r2:s.getAttribute("r")||"50%"}}var l=e.util.object.clone;e.Gradient=e.util.createClass({offsetX:0,offsetY:0,gradientTransform:null,gradientUnits:"pixels",type:"linear",initialize:function(s){s||(s={}),s.coords||(s.coords={});var n,o=this;Object.keys(s).forEach(function(f){o[f]=s[f]}),this.id?this.id+="_"+e.Object.__uid++:this.id=e.Object.__uid++,n={x1:s.coords.x1||0,y1:s.coords.y1||0,x2:s.coords.x2||0,y2:s.coords.y2||0},this.type==="radial"&&(n.r1=s.coords.r1||0,n.r2=s.coords.r2||0),this.coords=n,this.colorStops=s.colorStops.slice()},addColorStop:function(s){for(var n in s){var o=new e.Color(s[n]);this.colorStops.push({offset:parseFloat(n),color:o.toRgb(),opacity:o.getAlpha()})}return this},toObject:function(s){var n={type:this.type,coords:this.coords,colorStops:this.colorStops,offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform?this.gradientTransform.concat():this.gradientTransform};return e.util.populateWithProperties(this,n,s),n},toSVG:function(s,d){var o=l(this.coords,!0),f,a,d=d||{},p,v,b=l(this.colorStops,!0),C=o.r1>o.r2,w=this.gradientTransform?this.gradientTransform.concat():e.iMatrix.concat(),S=-this.offsetX,E=-this.offsetY,P=!!d.additionalTransform,N=this.gradientUnits==="pixels"?"userSpaceOnUse":"objectBoundingBox";if(b.sort(function(te,re){return te.offset-re.offset}),N==="objectBoundingBox"?(S/=s.width,E/=s.height):(S+=s.width/2,E+=s.height/2),s.type==="path"&&this.gradientUnits!=="percentage"&&(S-=s.pathOffset.x,E-=s.pathOffset.y),w[4]-=S,w[5]-=E,v='id="SVGID_'+this.id+'" gradientUnits="'+N+'"',v+=' gradientTransform="'+(P?d.additionalTransform+" ":"")+e.util.matrixToSVG(w)+'" ',this.type==="linear"?p=["<linearGradient ",v,' x1="',o.x1,'" y1="',o.y1,'" x2="',o.x2,'" y2="',o.y2,`">
`]:this.type==="radial"&&(p=["<radialGradient ",v,' cx="',C?o.x1:o.x2,'" cy="',C?o.y1:o.y2,'" r="',C?o.r1:o.r2,'" fx="',C?o.x2:o.x1,'" fy="',C?o.y2:o.y1,`">
`]),this.type==="radial"){if(C)for(b=b.concat(),b.reverse(),f=0,a=b.length;f<a;f++)b[f].offset=1-b[f].offset;var K=Math.min(o.r1,o.r2);if(K>0){var Z=Math.max(o.r1,o.r2),W=K/Z;for(f=0,a=b.length;f<a;f++)b[f].offset+=W*(1-b[f].offset)}}for(f=0,a=b.length;f<a;f++){var U=b[f];p.push("<stop ",'offset="',U.offset*100+"%",'" style="stop-color:',U.color,typeof U.opacity<"u"?";stop-opacity: "+U.opacity:";",`"/>
`)}return p.push(this.type==="linear"?`</linearGradient>
`:`</radialGradient>
`),p.join("")},toLive:function(s){var n,o=e.util.object.clone(this.coords),f,a;if(this.type){for(this.type==="linear"?n=s.createLinearGradient(o.x1,o.y1,o.x2,o.y2):this.type==="radial"&&(n=s.createRadialGradient(o.x1,o.y1,o.r1,o.x2,o.y2,o.r2)),f=0,a=this.colorStops.length;f<a;f++){var d=this.colorStops[f].color,p=this.colorStops[f].opacity,v=this.colorStops[f].offset;typeof p<"u"&&(d=new e.Color(d).setAlpha(p).toRgba()),n.addColorStop(v,d)}return n}}}),e.util.object.extend(e.Gradient,{fromElement:function(s,n,o,f){var a=parseFloat(o)/(/%$/.test(o)?100:1);a=a<0?0:a>1?1:a,isNaN(a)&&(a=1);var d=s.getElementsByTagName("stop"),p,v=s.getAttribute("gradientUnits")==="userSpaceOnUse"?"pixels":"percentage",b=s.getAttribute("gradientTransform")||"",C=[],w,S,E=0,P=0,N;for(s.nodeName==="linearGradient"||s.nodeName==="LINEARGRADIENT"?(p="linear",w=t(s)):(p="radial",w=c(s)),S=d.length;S--;)C.push(h(d[S],a));N=e.parseTransformAttribute(b),i(n,w,f,v),v==="pixels"&&(E=-n.left,P=-n.top);var K=new e.Gradient({id:s.getAttribute("id"),type:p,coords:w,colorStops:C,gradientUnits:v,gradientTransform:N,offsetX:E,offsetY:P});return K}});function i(s,n,o,f){var a,d;Object.keys(n).forEach(function(p){a=n[p],a==="Infinity"?d=1:a==="-Infinity"?d=0:(d=parseFloat(n[p],10),typeof a=="string"&&/^(\d+\.\d+)%|(\d+)%$/.test(a)&&(d*=.01,f==="pixels"&&((p==="x1"||p==="x2"||p==="r2")&&(d*=o.viewBoxWidth||o.width),(p==="y1"||p==="y2")&&(d*=o.viewBoxHeight||o.height)))),n[p]=d})}}(),function(){var h=e.util.toFixed;e.Pattern=e.util.createClass({repeat:"repeat",offsetX:0,offsetY:0,crossOrigin:"",patternTransform:null,initialize:function(t,c){if(t||(t={}),this.id=e.Object.__uid++,this.setOptions(t),!t.source||t.source&&typeof t.source!="string"){c&&c(this);return}else{var l=this;this.source=e.util.createImage(),e.util.loadImage(t.source,function(i,s){l.source=i,c&&c(l,s)},null,this.crossOrigin)}},toObject:function(t){var c=e.Object.NUM_FRACTION_DIGITS,l,i;return typeof this.source.src=="string"?l=this.source.src:typeof this.source=="object"&&this.source.toDataURL&&(l=this.source.toDataURL()),i={type:"pattern",source:l,repeat:this.repeat,crossOrigin:this.crossOrigin,offsetX:h(this.offsetX,c),offsetY:h(this.offsetY,c),patternTransform:this.patternTransform?this.patternTransform.concat():null},e.util.populateWithProperties(this,i,t),i},toSVG:function(t){var c=typeof this.source=="function"?this.source():this.source,l=c.width/t.width,i=c.height/t.height,s=this.offsetX/t.width,n=this.offsetY/t.height,o="";return(this.repeat==="repeat-x"||this.repeat==="no-repeat")&&(i=1,n&&(i+=Math.abs(n))),(this.repeat==="repeat-y"||this.repeat==="no-repeat")&&(l=1,s&&(l+=Math.abs(s))),c.src?o=c.src:c.toDataURL&&(o=c.toDataURL()),'<pattern id="SVGID_'+this.id+'" x="'+s+'" y="'+n+'" width="'+l+'" height="'+i+`">
<image x="0" y="0" width="`+c.width+'" height="'+c.height+'" xlink:href="'+o+`"></image>
</pattern>
`},setOptions:function(t){for(var c in t)this[c]=t[c]},toLive:function(t){var c=this.source;return!c||typeof c.src<"u"&&(!c.complete||c.naturalWidth===0||c.naturalHeight===0)?"":t.createPattern(c,this.repeat)}})}(),function(h){var t=h.fabric||(h.fabric={}),c=t.util.toFixed;if(t.Shadow){t.warn("fabric.Shadow is already defined.");return}t.Shadow=t.util.createClass({color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,nonScaling:!1,initialize:function(l){typeof l=="string"&&(l=this._parseShadow(l));for(var i in l)this[i]=l[i];this.id=t.Object.__uid++},_parseShadow:function(l){var i=l.trim(),s=t.Shadow.reOffsetsAndBlur.exec(i)||[],n=i.replace(t.Shadow.reOffsetsAndBlur,"")||"rgb(0,0,0)";return{color:n.trim(),offsetX:parseFloat(s[1],10)||0,offsetY:parseFloat(s[2],10)||0,blur:parseFloat(s[3],10)||0}},toString:function(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")},toSVG:function(l){var i=40,s=40,n=t.Object.NUM_FRACTION_DIGITS,o=t.util.rotateVector({x:this.offsetX,y:this.offsetY},t.util.degreesToRadians(-l.angle)),f=20,a=new t.Color(this.color);return l.width&&l.height&&(i=c((Math.abs(o.x)+this.blur)/l.width,n)*100+f,s=c((Math.abs(o.y)+this.blur)/l.height,n)*100+f),l.flipX&&(o.x*=-1),l.flipY&&(o.y*=-1),'<filter id="SVGID_'+this.id+'" y="-'+s+'%" height="'+(100+2*s)+'%" x="-'+i+'%" width="'+(100+2*i)+`%" >
	<feGaussianBlur in="SourceAlpha" stdDeviation="`+c(this.blur?this.blur/2:0,n)+`"></feGaussianBlur>
	<feOffset dx="`+c(o.x,n)+'" dy="'+c(o.y,n)+`" result="oBlur" ></feOffset>
	<feFlood flood-color="`+a.toRgb()+'" flood-opacity="'+a.getAlpha()+`"/>
	<feComposite in2="oBlur" operator="in" />
	<feMerge>
		<feMergeNode></feMergeNode>
		<feMergeNode in="SourceGraphic"></feMergeNode>
	</feMerge>
</filter>
`},toObject:function(){if(this.includeDefaultValues)return{color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke,nonScaling:this.nonScaling};var l={},i=t.Shadow.prototype;return["color","blur","offsetX","offsetY","affectStroke","nonScaling"].forEach(function(s){this[s]!==i[s]&&(l[s]=this[s])},this),l}}),t.Shadow.reOffsetsAndBlur=/(?:\s|^)(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(\d+(?:\.\d*)?(?:px)?)?(?:\s?|$)(?:$|\s)/}(r),function(){if(e.StaticCanvas){e.warn("fabric.StaticCanvas is already defined.");return}var h=e.util.object.extend,t=e.util.getElementOffset,c=e.util.removeFromArray,l=e.util.toFixed,i=e.util.transformPoint,s=e.util.invertTransform,n=e.util.getNodeCanvas,o=e.util.createCanvasElement,f=new Error("Could not initialize `canvas` element");e.StaticCanvas=e.util.createClass(e.CommonMethods,{initialize:function(a,d){d||(d={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(a,d)},backgroundColor:"",backgroundImage:null,overlayColor:"",overlayImage:null,includeDefaultValues:!0,stateful:!1,renderOnAddRemove:!0,controlsAboveOverlay:!1,allowTouchScrolling:!1,imageSmoothingEnabled:!0,viewportTransform:e.iMatrix.concat(),backgroundVpt:!0,overlayVpt:!0,enableRetinaScaling:!0,vptCoords:{},skipOffscreen:!0,clipPath:void 0,_initStatic:function(a,d){var p=this.requestRenderAllBound;this._objects=[],this._createLowerCanvas(a),this._initOptions(d),this.interactive||this._initRetinaScaling(),d.overlayImage&&this.setOverlayImage(d.overlayImage,p),d.backgroundImage&&this.setBackgroundImage(d.backgroundImage,p),d.backgroundColor&&this.setBackgroundColor(d.backgroundColor,p),d.overlayColor&&this.setOverlayColor(d.overlayColor,p),this.calcOffset()},_isRetinaScaling:function(){return e.devicePixelRatio>1&&this.enableRetinaScaling},getRetinaScaling:function(){return this._isRetinaScaling()?Math.max(1,e.devicePixelRatio):1},_initRetinaScaling:function(){if(this._isRetinaScaling()){var a=e.devicePixelRatio;this.__initRetinaScaling(a,this.lowerCanvasEl,this.contextContainer),this.upperCanvasEl&&this.__initRetinaScaling(a,this.upperCanvasEl,this.contextTop)}},__initRetinaScaling:function(a,d,p){d.setAttribute("width",this.width*a),d.setAttribute("height",this.height*a),p.scale(a,a)},calcOffset:function(){return this._offset=t(this.lowerCanvasEl),this},setOverlayImage:function(a,d,p){return this.__setBgOverlayImage("overlayImage",a,d,p)},setBackgroundImage:function(a,d,p){return this.__setBgOverlayImage("backgroundImage",a,d,p)},setOverlayColor:function(a,d){return this.__setBgOverlayColor("overlayColor",a,d)},setBackgroundColor:function(a,d){return this.__setBgOverlayColor("backgroundColor",a,d)},__setBgOverlayImage:function(a,d,p,v){return typeof d=="string"?e.util.loadImage(d,function(b,C){if(b){var w=new e.Image(b,v);this[a]=w,w.canvas=this}p&&p(b,C)},this,v&&v.crossOrigin):(v&&d.setOptions(v),this[a]=d,d&&(d.canvas=this),p&&p(d,!1)),this},__setBgOverlayColor:function(a,d,p){return this[a]=d,this._initGradient(d,a),this._initPattern(d,a,p),this},_createCanvasElement:function(){var a=o();if(!a||(a.style||(a.style={}),typeof a.getContext>"u"))throw f;return a},_initOptions:function(a){var d=this.lowerCanvasEl;this._setOptions(a),this.width=this.width||parseInt(d.width,10)||0,this.height=this.height||parseInt(d.height,10)||0,this.lowerCanvasEl.style&&(d.width=this.width,d.height=this.height,d.style.width=this.width+"px",d.style.height=this.height+"px",this.viewportTransform=this.viewportTransform.slice())},_createLowerCanvas:function(a){a&&a.getContext?this.lowerCanvasEl=a:this.lowerCanvasEl=e.util.getById(a)||this._createCanvasElement(),e.util.addClass(this.lowerCanvasEl,"lower-canvas"),this._originalCanvasStyle=this.lowerCanvasEl.style,this.interactive&&this._applyCanvasStyle(this.lowerCanvasEl),this.contextContainer=this.lowerCanvasEl.getContext("2d")},getWidth:function(){return this.width},getHeight:function(){return this.height},setWidth:function(a,d){return this.setDimensions({width:a},d)},setHeight:function(a,d){return this.setDimensions({height:a},d)},setDimensions:function(a,d){var p;d=d||{};for(var v in a)p=a[v],d.cssOnly||(this._setBackstoreDimension(v,a[v]),p+="px",this.hasLostContext=!0),d.backstoreOnly||this._setCssDimension(v,p);return this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(this.contextTop),this._initRetinaScaling(),this.calcOffset(),d.cssOnly||this.requestRenderAll(),this},_setBackstoreDimension:function(a,d){return this.lowerCanvasEl[a]=d,this.upperCanvasEl&&(this.upperCanvasEl[a]=d),this.cacheCanvasEl&&(this.cacheCanvasEl[a]=d),this[a]=d,this},_setCssDimension:function(a,d){return this.lowerCanvasEl.style[a]=d,this.upperCanvasEl&&(this.upperCanvasEl.style[a]=d),this.wrapperEl&&(this.wrapperEl.style[a]=d),this},getZoom:function(){return this.viewportTransform[0]},setViewportTransform:function(a){var d=this._activeObject,p=this.backgroundImage,v=this.overlayImage,b,C,w;for(this.viewportTransform=a,C=0,w=this._objects.length;C<w;C++)b=this._objects[C],b.group||b.setCoords(!0);return d&&d.setCoords(),p&&p.setCoords(!0),v&&v.setCoords(!0),this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll(),this},zoomToPoint:function(a,d){var p=a,v=this.viewportTransform.slice(0);a=i(a,s(this.viewportTransform)),v[0]=d,v[3]=d;var b=i(a,v);return v[4]+=p.x-b.x,v[5]+=p.y-b.y,this.setViewportTransform(v)},setZoom:function(a){return this.zoomToPoint(new e.Point(0,0),a),this},absolutePan:function(a){var d=this.viewportTransform.slice(0);return d[4]=-a.x,d[5]=-a.y,this.setViewportTransform(d)},relativePan:function(a){return this.absolutePan(new e.Point(-a.x-this.viewportTransform[4],-a.y-this.viewportTransform[5]))},getElement:function(){return this.lowerCanvasEl},_onObjectAdded:function(a){this.stateful&&a.setupState(),a._set("canvas",this),a.setCoords(),this.fire("object:added",{target:a}),a.fire("added")},_onObjectRemoved:function(a){this.fire("object:removed",{target:a}),a.fire("removed"),delete a.canvas},clearContext:function(a){return a.clearRect(0,0,this.width,this.height),this},getContext:function(){return this.contextContainer},clear:function(){return this.remove.apply(this,this.getObjects()),this.backgroundImage=null,this.overlayImage=null,this.backgroundColor="",this.overlayColor="",this._hasITextHandlers&&(this.off("mouse:up",this._mouseUpITextHandler),this._iTextInstances=null,this._hasITextHandlers=!1),this.clearContext(this.contextContainer),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll(),this},renderAll:function(){var a=this.contextContainer;return this.renderCanvas(a,this._objects),this},renderAndReset:function(){this.isRendering=0,this.renderAll()},requestRenderAll:function(){return this.isRendering||(this.isRendering=e.util.requestAnimFrame(this.renderAndResetBound)),this},calcViewportBoundaries:function(){var a={},d=this.width,p=this.height,v=s(this.viewportTransform);return a.tl=i({x:0,y:0},v),a.br=i({x:d,y:p},v),a.tr=new e.Point(a.br.x,a.tl.y),a.bl=new e.Point(a.tl.x,a.br.y),this.vptCoords=a,a},cancelRequestedRender:function(){this.isRendering&&(e.util.cancelAnimFrame(this.isRendering),this.isRendering=0)},renderCanvas:function(a,d){var p=this.viewportTransform,v=this.clipPath;this.cancelRequestedRender(),this.calcViewportBoundaries(),this.clearContext(a),e.util.setImageSmoothing(a,this.imageSmoothingEnabled),this.fire("before:render",{ctx:a}),this._renderBackground(a),a.save(),a.transform(p[0],p[1],p[2],p[3],p[4],p[5]),this._renderObjects(a,d),a.restore(),!this.controlsAboveOverlay&&this.interactive&&this.drawControls(a),v&&(v.canvas=this,v.shouldCache(),v._transformDone=!0,v.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(a)),this._renderOverlay(a),this.controlsAboveOverlay&&this.interactive&&this.drawControls(a),this.fire("after:render",{ctx:a})},drawClipPathOnCanvas:function(a){var d=this.viewportTransform,p=this.clipPath;a.save(),a.transform(d[0],d[1],d[2],d[3],d[4],d[5]),a.globalCompositeOperation="destination-in",p.transform(a),a.scale(1/p.zoomX,1/p.zoomY),a.drawImage(p._cacheCanvas,-p.cacheTranslationX,-p.cacheTranslationY),a.restore()},_renderObjects:function(a,d){var p,v;for(p=0,v=d.length;p<v;++p)d[p]&&d[p].render(a)},_renderBackgroundOrOverlay:function(a,d){var p=this[d+"Color"],v=this[d+"Image"],b=this.viewportTransform,C=this[d+"Vpt"];if(!(!p&&!v)){if(p){a.save(),a.beginPath(),a.moveTo(0,0),a.lineTo(this.width,0),a.lineTo(this.width,this.height),a.lineTo(0,this.height),a.closePath(),a.fillStyle=p.toLive?p.toLive(a,this):p,C&&a.transform(b[0],b[1],b[2],b[3],b[4],b[5]),a.transform(1,0,0,1,p.offsetX||0,p.offsetY||0);var w=p.gradientTransform||p.patternTransform;w&&a.transform(w[0],w[1],w[2],w[3],w[4],w[5]),a.fill(),a.restore()}v&&(a.save(),C&&a.transform(b[0],b[1],b[2],b[3],b[4],b[5]),v.render(a),a.restore())}},_renderBackground:function(a){this._renderBackgroundOrOverlay(a,"background")},_renderOverlay:function(a){this._renderBackgroundOrOverlay(a,"overlay")},getCenter:function(){return{top:this.height/2,left:this.width/2}},getCenterPoint:function(){return new e.Point(this.width/2,this.height/2)},centerObjectH:function(a){return this._centerObject(a,new e.Point(this.getCenterPoint().x,a.getCenterPoint().y))},centerObjectV:function(a){return this._centerObject(a,new e.Point(a.getCenterPoint().x,this.getCenterPoint().y))},centerObject:function(a){var d=this.getCenterPoint();return this._centerObject(a,d)},viewportCenterObject:function(a){var d=this.getVpCenter();return this._centerObject(a,d)},viewportCenterObjectH:function(a){var d=this.getVpCenter();return this._centerObject(a,new e.Point(d.x,a.getCenterPoint().y)),this},viewportCenterObjectV:function(a){var d=this.getVpCenter();return this._centerObject(a,new e.Point(a.getCenterPoint().x,d.y))},getVpCenter:function(){var a=this.getCenterPoint(),d=s(this.viewportTransform);return i(a,d)},_centerObject:function(a,d){return a.setPositionByOrigin(d,"center","center"),a.setCoords(),this.renderOnAddRemove&&this.requestRenderAll(),this},toDatalessJSON:function(a){return this.toDatalessObject(a)},toObject:function(a){return this._toObjectMethod("toObject",a)},toDatalessObject:function(a){return this._toObjectMethod("toDatalessObject",a)},_toObjectMethod:function(a,d){var p=this.clipPath,v={version:e.version,objects:this._toObjects(a,d)};return p&&!p.excludeFromExport&&(v.clipPath=this._toObject(this.clipPath,a,d)),h(v,this.__serializeBgOverlay(a,d)),e.util.populateWithProperties(this,v,d),v},_toObjects:function(a,d){return this._objects.filter(function(p){return!p.excludeFromExport}).map(function(p){return this._toObject(p,a,d)},this)},_toObject:function(a,d,p){var v;this.includeDefaultValues||(v=a.includeDefaultValues,a.includeDefaultValues=!1);var b=a[d](p);return this.includeDefaultValues||(a.includeDefaultValues=v),b},__serializeBgOverlay:function(a,d){var p={},v=this.backgroundImage,b=this.overlayImage,C=this.backgroundColor,w=this.overlayColor;return C&&C.toObject?C.excludeFromExport||(p.background=C.toObject(d)):C&&(p.background=C),w&&w.toObject?w.excludeFromExport||(p.overlay=w.toObject(d)):w&&(p.overlay=w),v&&!v.excludeFromExport&&(p.backgroundImage=this._toObject(v,a,d)),b&&!b.excludeFromExport&&(p.overlayImage=this._toObject(b,a,d)),p},svgViewportTransformation:!0,toSVG:function(a,d){a||(a={}),a.reviver=d;var p=[];return this._setSVGPreamble(p,a),this._setSVGHeader(p,a),this.clipPath&&p.push('<g clip-path="url(#'+this.clipPath.clipPathId+`)" >
`),this._setSVGBgOverlayColor(p,"background"),this._setSVGBgOverlayImage(p,"backgroundImage",d),this._setSVGObjects(p,d),this.clipPath&&p.push(`</g>
`),this._setSVGBgOverlayColor(p,"overlay"),this._setSVGBgOverlayImage(p,"overlayImage",d),p.push("</svg>"),p.join("")},_setSVGPreamble:function(a,d){d.suppressPreamble||a.push('<?xml version="1.0" encoding="',d.encoding||"UTF-8",`" standalone="no" ?>
`,'<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ',`"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
`)},_setSVGHeader:function(a,d){var p=d.width||this.width,v=d.height||this.height,b,C='viewBox="0 0 '+this.width+" "+this.height+'" ',w=e.Object.NUM_FRACTION_DIGITS;d.viewBox?C='viewBox="'+d.viewBox.x+" "+d.viewBox.y+" "+d.viewBox.width+" "+d.viewBox.height+'" ':this.svgViewportTransformation&&(b=this.viewportTransform,C='viewBox="'+l(-b[4]/b[0],w)+" "+l(-b[5]/b[3],w)+" "+l(this.width/b[0],w)+" "+l(this.height/b[3],w)+'" '),a.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',p,'" ','height="',v,'" ',C,`xml:space="preserve">
`,"<desc>Created with Fabric.js ",e.version,`</desc>
`,`<defs>
`,this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),this.createSVGClipPathMarkup(d),`</defs>
`)},createSVGClipPathMarkup:function(a){var d=this.clipPath;return d?(d.clipPathId="CLIPPATH_"+e.Object.__uid++,'<clipPath id="'+d.clipPathId+`" >
`+this.clipPath.toClipPathSVG(a.reviver)+`</clipPath>
`):""},createSVGRefElementsMarkup:function(){var a=this,d=["background","overlay"].map(function(p){var v=a[p+"Color"];if(v&&v.toLive){var b=a[p+"Vpt"],C=a.viewportTransform,w={width:a.width/(b?C[0]:1),height:a.height/(b?C[3]:1)};return v.toSVG(w,{additionalTransform:b?e.util.matrixToSVG(C):""})}});return d.join("")},createSVGFontFacesMarkup:function(){var a="",d={},p,v,b,C,w,S,E,P,N,K=e.fontPaths,Z=[];for(this._objects.forEach(function U(te){Z.push(te),te._objects&&te._objects.forEach(U)}),P=0,N=Z.length;P<N;P++)if(p=Z[P],v=p.fontFamily,!(p.type.indexOf("text")===-1||d[v]||!K[v])&&(d[v]=!0,!!p.styles)){b=p.styles;for(w in b){C=b[w];for(E in C)S=C[E],v=S.fontFamily,!d[v]&&K[v]&&(d[v]=!0)}}for(var W in d)a+=[`		@font-face {
`,"			font-family: '",W,`';
`,"			src: url('",K[W],`');
`,`		}
`].join("");return a&&(a=['	<style type="text/css">',`<![CDATA[
`,a,"]]>",`</style>
`].join("")),a},_setSVGObjects:function(a,d){var p,v,b,C=this._objects;for(v=0,b=C.length;v<b;v++)p=C[v],!p.excludeFromExport&&this._setSVGObject(a,p,d)},_setSVGObject:function(a,d,p){a.push(d.toSVG(p))},_setSVGBgOverlayImage:function(a,d,p){this[d]&&!this[d].excludeFromExport&&this[d].toSVG&&a.push(this[d].toSVG(p))},_setSVGBgOverlayColor:function(a,d){var p=this[d+"Color"],v=this.viewportTransform,b=this.width,C=this.height;if(p)if(p.toLive){var w=p.repeat,S=e.util.invertTransform(v),E=this[d+"Vpt"],P=E?e.util.matrixToSVG(S):"";a.push('<rect transform="'+P+" translate(",b/2,",",C/2,')"',' x="',p.offsetX-b/2,'" y="',p.offsetY-C/2,'" ','width="',w==="repeat-y"||w==="no-repeat"?p.source.width:b,'" height="',w==="repeat-x"||w==="no-repeat"?p.source.height:C,'" fill="url(#SVGID_'+p.id+')"',`></rect>
`)}else a.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',p,'"',`></rect>
`)},sendToBack:function(a){if(!a)return this;var d=this._activeObject,p,v,b;if(a===d&&a.type==="activeSelection")for(b=d._objects,p=b.length;p--;)v=b[p],c(this._objects,v),this._objects.unshift(v);else c(this._objects,a),this._objects.unshift(a);return this.renderOnAddRemove&&this.requestRenderAll(),this},bringToFront:function(a){if(!a)return this;var d=this._activeObject,p,v,b;if(a===d&&a.type==="activeSelection")for(b=d._objects,p=0;p<b.length;p++)v=b[p],c(this._objects,v),this._objects.push(v);else c(this._objects,a),this._objects.push(a);return this.renderOnAddRemove&&this.requestRenderAll(),this},sendBackwards:function(a,d){if(!a)return this;var p=this._activeObject,v,b,C,w,S,E=0;if(a===p&&a.type==="activeSelection")for(S=p._objects,v=0;v<S.length;v++)b=S[v],C=this._objects.indexOf(b),C>0+E&&(w=C-1,c(this._objects,b),this._objects.splice(w,0,b)),E++;else C=this._objects.indexOf(a),C!==0&&(w=this._findNewLowerIndex(a,C,d),c(this._objects,a),this._objects.splice(w,0,a));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewLowerIndex:function(a,d,p){var v,b;if(p)for(v=d,b=d-1;b>=0;--b){var C=a.intersectsWithObject(this._objects[b])||a.isContainedWithinObject(this._objects[b])||this._objects[b].isContainedWithinObject(a);if(C){v=b;break}}else v=d-1;return v},bringForward:function(a,d){if(!a)return this;var p=this._activeObject,v,b,C,w,S,E=0;if(a===p&&a.type==="activeSelection")for(S=p._objects,v=S.length;v--;)b=S[v],C=this._objects.indexOf(b),C<this._objects.length-1-E&&(w=C+1,c(this._objects,b),this._objects.splice(w,0,b)),E++;else C=this._objects.indexOf(a),C!==this._objects.length-1&&(w=this._findNewUpperIndex(a,C,d),c(this._objects,a),this._objects.splice(w,0,a));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewUpperIndex:function(a,d,p){var v,b,C;if(p)for(v=d,b=d+1,C=this._objects.length;b<C;++b){var w=a.intersectsWithObject(this._objects[b])||a.isContainedWithinObject(this._objects[b])||this._objects[b].isContainedWithinObject(a);if(w){v=b;break}}else v=d+1;return v},moveTo:function(a,d){return c(this._objects,a),this._objects.splice(d,0,a),this.renderOnAddRemove&&this.requestRenderAll()},dispose:function(){return this.isRendering&&(e.util.cancelAnimFrame(this.isRendering),this.isRendering=0),this.forEachObject(function(a){a.dispose&&a.dispose()}),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose&&this.backgroundImage.dispose(),this.backgroundImage=null,this.overlayImage&&this.overlayImage.dispose&&this.overlayImage.dispose(),this.overlayImage=null,this._iTextInstances=null,this.contextContainer=null,this.lowerCanvasEl.classList.remove("lower-canvas"),e.util.setStyle(this.lowerCanvasEl,this._originalCanvasStyle),delete this._originalCanvasStyle,this.lowerCanvasEl.setAttribute("width",this.width),this.lowerCanvasEl.setAttribute("height",this.height),e.util.cleanUpJsdomNode(this.lowerCanvasEl),this.lowerCanvasEl=void 0,this},toString:function(){return"#<fabric.Canvas ("+this.complexity()+"): { objects: "+this._objects.length+" }>"}}),h(e.StaticCanvas.prototype,e.Observable),h(e.StaticCanvas.prototype,e.Collection),h(e.StaticCanvas.prototype,e.DataURLExporter),h(e.StaticCanvas,{EMPTY_JSON:'{"objects": [], "background": "white"}',supports:function(a){var d=o();if(!d||!d.getContext)return null;var p=d.getContext("2d");if(!p)return null;switch(a){case"setLineDash":return typeof p.setLineDash<"u";default:return null}}}),e.StaticCanvas.prototype.toJSON=e.StaticCanvas.prototype.toObject,e.isLikelyNode&&(e.StaticCanvas.prototype.createPNGStream=function(){var a=n(this.lowerCanvasEl);return a&&a.createPNGStream()},e.StaticCanvas.prototype.createJPEGStream=function(a){var d=n(this.lowerCanvasEl);return d&&d.createJPEGStream(a)})}(),e.BaseBrush=e.util.createClass({color:"rgb(0, 0, 0)",width:1,shadow:null,strokeLineCap:"round",strokeLineJoin:"round",strokeMiterLimit:10,strokeDashArray:null,limitedToCanvasSize:!1,_setBrushStyles:function(h){h.strokeStyle=this.color,h.lineWidth=this.width,h.lineCap=this.strokeLineCap,h.miterLimit=this.strokeMiterLimit,h.lineJoin=this.strokeLineJoin,h.setLineDash(this.strokeDashArray||[])},_saveAndTransform:function(h){var t=this.canvas.viewportTransform;h.save(),h.transform(t[0],t[1],t[2],t[3],t[4],t[5])},_setShadow:function(){if(this.shadow){var h=this.canvas,t=this.shadow,c=h.contextTop,l=h.getZoom();h&&h._isRetinaScaling()&&(l*=e.devicePixelRatio),c.shadowColor=t.color,c.shadowBlur=t.blur*l,c.shadowOffsetX=t.offsetX*l,c.shadowOffsetY=t.offsetY*l}},needsFullRender:function(){var h=new e.Color(this.color);return h.getAlpha()<1||!!this.shadow},_resetShadow:function(){var h=this.canvas.contextTop;h.shadowColor="",h.shadowBlur=h.shadowOffsetX=h.shadowOffsetY=0},_isOutSideCanvas:function(h){return h.x<0||h.x>this.canvas.getWidth()||h.y<0||h.y>this.canvas.getHeight()}}),function(){e.PencilBrush=e.util.createClass(e.BaseBrush,{decimate:.4,drawStraightLine:!1,straightLineKey:"shiftKey",initialize:function(h){this.canvas=h,this._points=[]},needsFullRender:function(){return this.callSuper("needsFullRender")||this._hasStraightLine},_drawSegment:function(h,t,c){var l=t.midPointFrom(c);return h.quadraticCurveTo(t.x,t.y,l.x,l.y),l},onMouseDown:function(h,t){this.canvas._isMainEvent(t.e)&&(this.drawStraightLine=t.e[this.straightLineKey],this._prepareForDrawing(h),this._captureDrawingPath(h),this._render())},onMouseMove:function(h,t){if(this.canvas._isMainEvent(t.e)&&(this.drawStraightLine=t.e[this.straightLineKey],!(this.limitedToCanvasSize===!0&&this._isOutSideCanvas(h))&&this._captureDrawingPath(h)&&this._points.length>1))if(this.needsFullRender())this.canvas.clearContext(this.canvas.contextTop),this._render();else{var c=this._points,l=c.length,i=this.canvas.contextTop;this._saveAndTransform(i),this.oldEnd&&(i.beginPath(),i.moveTo(this.oldEnd.x,this.oldEnd.y)),this.oldEnd=this._drawSegment(i,c[l-2],c[l-1],!0),i.stroke(),i.restore()}},onMouseUp:function(h){return this.canvas._isMainEvent(h.e)?(this.drawStraightLine=!1,this.oldEnd=void 0,this._finalizeAndAddPath(),!1):!0},_prepareForDrawing:function(h){var t=new e.Point(h.x,h.y);this._reset(),this._addPoint(t),this.canvas.contextTop.moveTo(t.x,t.y)},_addPoint:function(h){return this._points.length>1&&h.eq(this._points[this._points.length-1])?!1:(this.drawStraightLine&&this._points.length>1&&(this._hasStraightLine=!0,this._points.pop()),this._points.push(h),!0)},_reset:function(){this._points=[],this._setBrushStyles(this.canvas.contextTop),this._setShadow(),this._hasStraightLine=!1},_captureDrawingPath:function(h){var t=new e.Point(h.x,h.y);return this._addPoint(t)},_render:function(h){var t,c,l=this._points[0],i=this._points[1];if(h=h||this.canvas.contextTop,this._saveAndTransform(h),h.beginPath(),this._points.length===2&&l.x===i.x&&l.y===i.y){var s=this.width/1e3;l=new e.Point(l.x,l.y),i=new e.Point(i.x,i.y),l.x-=s,i.x+=s}for(h.moveTo(l.x,l.y),t=1,c=this._points.length;t<c;t++)this._drawSegment(h,l,i),l=this._points[t],i=this._points[t+1];h.lineTo(l.x,l.y),h.stroke(),h.restore()},convertPointsToSVGPath:function(h){var t=this.width/1e3;return e.util.getSmoothPathFromPoints(h,t)},_isEmptySVGPath:function(h){var t=e.util.joinPath(h);return t==="M 0 0 Q 0 0 0 0 L 0 0"},createPath:function(h){var t=new e.Path(h,{fill:null,stroke:this.color,strokeWidth:this.width,strokeLineCap:this.strokeLineCap,strokeMiterLimit:this.strokeMiterLimit,strokeLineJoin:this.strokeLineJoin,strokeDashArray:this.strokeDashArray});return this.shadow&&(this.shadow.affectStroke=!0,t.shadow=new e.Shadow(this.shadow)),t},decimatePoints:function(h,t){if(h.length<=2)return h;var c=this.canvas.getZoom(),l=Math.pow(t/c,2),i,s=h.length-1,n=h[0],o=[n],f;for(i=1;i<s-1;i++)f=Math.pow(n.x-h[i].x,2)+Math.pow(n.y-h[i].y,2),f>=l&&(n=h[i],o.push(n));return o.push(h[s]),o},_finalizeAndAddPath:function(){var h=this.canvas.contextTop;h.closePath(),this.decimate&&(this._points=this.decimatePoints(this._points,this.decimate));var t=this.convertPointsToSVGPath(this._points);if(this._isEmptySVGPath(t)){this.canvas.requestRenderAll();return}var c=this.createPath(t);this.canvas.clearContext(this.canvas.contextTop),this.canvas.fire("before:path:created",{path:c}),this.canvas.add(c),this.canvas.requestRenderAll(),c.setCoords(),this._resetShadow(),this.canvas.fire("path:created",{path:c})}})}(),e.CircleBrush=e.util.createClass(e.BaseBrush,{width:10,initialize:function(h){this.canvas=h,this.points=[]},drawDot:function(h){var t=this.addPoint(h),c=this.canvas.contextTop;this._saveAndTransform(c),this.dot(c,t),c.restore()},dot:function(h,t){h.fillStyle=t.fill,h.beginPath(),h.arc(t.x,t.y,t.radius,0,Math.PI*2,!1),h.closePath(),h.fill()},onMouseDown:function(h){this.points.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.drawDot(h)},_render:function(){var h=this.canvas.contextTop,t,c,l=this.points;for(this._saveAndTransform(h),t=0,c=l.length;t<c;t++)this.dot(h,l[t]);h.restore()},onMouseMove:function(h){this.limitedToCanvasSize===!0&&this._isOutSideCanvas(h)||(this.needsFullRender()?(this.canvas.clearContext(this.canvas.contextTop),this.addPoint(h),this._render()):this.drawDot(h))},onMouseUp:function(){var h=this.canvas.renderOnAddRemove,t,c;this.canvas.renderOnAddRemove=!1;var l=[];for(t=0,c=this.points.length;t<c;t++){var i=this.points[t],s=new e.Circle({radius:i.radius,left:i.x,top:i.y,originX:"center",originY:"center",fill:i.fill});this.shadow&&(s.shadow=new e.Shadow(this.shadow)),l.push(s)}var n=new e.Group(l);n.canvas=this.canvas,this.canvas.fire("before:path:created",{path:n}),this.canvas.add(n),this.canvas.fire("path:created",{path:n}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=h,this.canvas.requestRenderAll()},addPoint:function(h){var t=new e.Point(h.x,h.y),c=e.util.getRandomInt(Math.max(0,this.width-20),this.width+20)/2,l=new e.Color(this.color).setAlpha(e.util.getRandomInt(0,100)/100).toRgba();return t.radius=c,t.fill=l,this.points.push(t),t}}),e.SprayBrush=e.util.createClass(e.BaseBrush,{width:10,density:20,dotWidth:1,dotWidthVariance:1,randomOpacity:!1,optimizeOverlapping:!0,initialize:function(h){this.canvas=h,this.sprayChunks=[]},onMouseDown:function(h){this.sprayChunks.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.addSprayChunk(h),this.render(this.sprayChunkPoints)},onMouseMove:function(h){this.limitedToCanvasSize===!0&&this._isOutSideCanvas(h)||(this.addSprayChunk(h),this.render(this.sprayChunkPoints))},onMouseUp:function(){var h=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;for(var t=[],c=0,l=this.sprayChunks.length;c<l;c++)for(var i=this.sprayChunks[c],s=0,n=i.length;s<n;s++){var o=new e.Rect({width:i[s].width,height:i[s].width,left:i[s].x+1,top:i[s].y+1,originX:"center",originY:"center",fill:this.color});t.push(o)}this.optimizeOverlapping&&(t=this._getOptimizedRects(t));var f=new e.Group(t);this.shadow&&f.set("shadow",new e.Shadow(this.shadow)),this.canvas.fire("before:path:created",{path:f}),this.canvas.add(f),this.canvas.fire("path:created",{path:f}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=h,this.canvas.requestRenderAll()},_getOptimizedRects:function(h){var t={},c,l,i;for(l=0,i=h.length;l<i;l++)c=h[l].left+""+h[l].top,t[c]||(t[c]=h[l]);var s=[];for(c in t)s.push(t[c]);return s},render:function(h){var t=this.canvas.contextTop,c,l;for(t.fillStyle=this.color,this._saveAndTransform(t),c=0,l=h.length;c<l;c++){var i=h[c];typeof i.opacity<"u"&&(t.globalAlpha=i.opacity),t.fillRect(i.x,i.y,i.width,i.width)}t.restore()},_render:function(){var h=this.canvas.contextTop,t,c;for(h.fillStyle=this.color,this._saveAndTransform(h),t=0,c=this.sprayChunks.length;t<c;t++)this.render(this.sprayChunks[t]);h.restore()},addSprayChunk:function(h){this.sprayChunkPoints=[];var t,c,l,i=this.width/2,s;for(s=0;s<this.density;s++){t=e.util.getRandomInt(h.x-i,h.x+i),c=e.util.getRandomInt(h.y-i,h.y+i),this.dotWidthVariance?l=e.util.getRandomInt(Math.max(1,this.dotWidth-this.dotWidthVariance),this.dotWidth+this.dotWidthVariance):l=this.dotWidth;var n=new e.Point(t,c);n.width=l,this.randomOpacity&&(n.opacity=e.util.getRandomInt(0,100)/100),this.sprayChunkPoints.push(n)}this.sprayChunks.push(this.sprayChunkPoints)}}),e.PatternBrush=e.util.createClass(e.PencilBrush,{getPatternSrc:function(){var h=20,t=5,c=e.util.createCanvasElement(),l=c.getContext("2d");return c.width=c.height=h+t,l.fillStyle=this.color,l.beginPath(),l.arc(h/2,h/2,h/2,0,Math.PI*2,!1),l.closePath(),l.fill(),c},getPatternSrcFunction:function(){return String(this.getPatternSrc).replace("this.color",'"'+this.color+'"')},getPattern:function(h){return h.createPattern(this.source||this.getPatternSrc(),"repeat")},_setBrushStyles:function(h){this.callSuper("_setBrushStyles",h),h.strokeStyle=this.getPattern(h)},createPath:function(h){var t=this.callSuper("createPath",h),c=t._getLeftTopCoords().scalarAdd(t.strokeWidth/2);return t.stroke=new e.Pattern({source:this.source||this.getPatternSrcFunction(),offsetX:-c.x,offsetY:-c.y}),t}}),function(){var h=e.util.getPointer,t=e.util.degreesToRadians,c=e.util.isTouchEvent;e.Canvas=e.util.createClass(e.StaticCanvas,{initialize:function(i,s){s||(s={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(i,s),this._initInteractive(),this._createCacheCanvas()},uniformScaling:!0,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",interactive:!0,selection:!0,selectionKey:"shiftKey",altSelectionKey:null,selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",notAllowedCursor:"not-allowed",containerClass:"canvas-container",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,isDrawingMode:!1,preserveObjectStacking:!1,snapAngle:0,snapThreshold:null,stopContextMenu:!1,fireRightClick:!1,fireMiddleClick:!1,targets:[],enablePointerEvents:!1,_hoveredTarget:null,_hoveredTargets:[],_initInteractive:function(){this._currentTransform=null,this._groupSelector=null,this._initWrapperElement(),this._createUpperCanvas(),this._initEventListeners(),this._initRetinaScaling(),this.freeDrawingBrush=e.PencilBrush&&new e.PencilBrush(this),this.calcOffset()},_chooseObjectsToRender:function(){var i=this.getActiveObjects(),s,n,o;if(i.length>0&&!this.preserveObjectStacking){n=[],o=[];for(var f=0,a=this._objects.length;f<a;f++)s=this._objects[f],i.indexOf(s)===-1?n.push(s):o.push(s);i.length>1&&(this._activeObject._objects=o),n.push.apply(n,o)}else n=this._objects;return n},renderAll:function(){this.contextTopDirty&&!this._groupSelector&&!this.isDrawingMode&&(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&(this.renderTopLayer(this.contextTop),this.hasLostContext=!1);var i=this.contextContainer;return this.renderCanvas(i,this._chooseObjectsToRender()),this},renderTopLayer:function(i){i.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(i),this.contextTopDirty=!0),i.restore()},renderTop:function(){var i=this.contextTop;return this.clearContext(i),this.renderTopLayer(i),this.fire("after:render"),this},_normalizePointer:function(i,s){var n=i.calcTransformMatrix(),o=e.util.invertTransform(n),f=this.restorePointerVpt(s);return e.util.transformPoint(f,o)},isTargetTransparent:function(i,s,n){if(i.shouldCache()&&i._cacheCanvas&&i!==this._activeObject){var o=this._normalizePointer(i,{x:s,y:n}),f=Math.max(i.cacheTranslationX+o.x*i.zoomX,0),a=Math.max(i.cacheTranslationY+o.y*i.zoomY,0),b=e.util.isTransparent(i._cacheContext,Math.round(f),Math.round(a),this.targetFindTolerance);return b}var d=this.contextCache,p=i.selectionBackgroundColor,v=this.viewportTransform;i.selectionBackgroundColor="",this.clearContext(d),d.save(),d.transform(v[0],v[1],v[2],v[3],v[4],v[5]),i.render(d),d.restore(),i.selectionBackgroundColor=p;var b=e.util.isTransparent(d,s,n,this.targetFindTolerance);return b},_isSelectionKeyPressed:function(i){var s=!1;return Array.isArray(this.selectionKey)?s=!!this.selectionKey.find(function(n){return i[n]===!0}):s=i[this.selectionKey],s},_shouldClearSelection:function(i,s){var n=this.getActiveObjects(),o=this._activeObject;return!s||s&&o&&n.length>1&&n.indexOf(s)===-1&&o!==s&&!this._isSelectionKeyPressed(i)||s&&!s.evented||s&&!s.selectable&&o&&o!==s},_shouldCenterTransform:function(i,s,n){if(i){var o;return s==="scale"||s==="scaleX"||s==="scaleY"||s==="resizing"?o=this.centeredScaling||i.centeredScaling:s==="rotate"&&(o=this.centeredRotation||i.centeredRotation),o?!n:n}},_getOriginFromCorner:function(i,s){var n={x:i.originX,y:i.originY};return s==="ml"||s==="tl"||s==="bl"?n.x="right":(s==="mr"||s==="tr"||s==="br")&&(n.x="left"),s==="tl"||s==="mt"||s==="tr"?n.y="bottom":(s==="bl"||s==="mb"||s==="br")&&(n.y="top"),n},_getActionFromCorner:function(i,s,n,o){if(!s||!i)return"drag";var f=o.controls[s];return f.getActionName(n,f,o)},_setupCurrentTransform:function(i,s,n){if(s){var o=this.getPointer(i),f=s.__corner,a=s.controls[f],d=n&&f?a.getActionHandler(i,s,a):e.controlsUtils.dragHandler,p=this._getActionFromCorner(n,f,i,s),v=this._getOriginFromCorner(s,f),b=i[this.centeredKey],C={target:s,action:p,actionHandler:d,corner:f,scaleX:s.scaleX,scaleY:s.scaleY,skewX:s.skewX,skewY:s.skewY,offsetX:o.x-s.left,offsetY:o.y-s.top,originX:v.x,originY:v.y,ex:o.x,ey:o.y,lastX:o.x,lastY:o.y,theta:t(s.angle),width:s.width*s.scaleX,shiftKey:i.shiftKey,altKey:b,original:e.util.saveObjectTransform(s)};this._shouldCenterTransform(s,p,b)&&(C.originX="center",C.originY="center"),C.original.originX=v.x,C.original.originY=v.y,this._currentTransform=C,this._beforeTransform(i)}},setCursor:function(i){this.upperCanvasEl.style.cursor=i},_drawSelection:function(i){var s=this._groupSelector,n=new e.Point(s.ex,s.ey),o=e.util.transformPoint(n,this.viewportTransform),f=new e.Point(s.ex+s.left,s.ey+s.top),a=e.util.transformPoint(f,this.viewportTransform),d=Math.min(o.x,a.x),p=Math.min(o.y,a.y),v=Math.max(o.x,a.x),b=Math.max(o.y,a.y),C=this.selectionLineWidth/2;this.selectionColor&&(i.fillStyle=this.selectionColor,i.fillRect(d,p,v-d,b-p)),!(!this.selectionLineWidth||!this.selectionBorderColor)&&(i.lineWidth=this.selectionLineWidth,i.strokeStyle=this.selectionBorderColor,d+=C,p+=C,v-=C,b-=C,e.Object.prototype._setLineDash.call(this,i,this.selectionDashArray),i.strokeRect(d,p,v-d,b-p))},findTarget:function(i,s){if(!this.skipTargetFind){var n=!0,o=this.getPointer(i,n),f=this._activeObject,a=this.getActiveObjects(),d,p,v=c(i),b=a.length>1&&!s||a.length===1;if(this.targets=[],b&&f._findTargetCorner(o,v)||a.length>1&&!s&&f===this._searchPossibleTargets([f],o))return f;if(a.length===1&&f===this._searchPossibleTargets([f],o))if(this.preserveObjectStacking)d=f,p=this.targets,this.targets=[];else return f;var C=this._searchPossibleTargets(this._objects,o);return i[this.altSelectionKey]&&C&&d&&C!==d&&(C=d,this.targets=p),C}},_checkTarget:function(i,s,n){if(s&&s.visible&&s.evented&&s.containsPoint(i))if((this.perPixelTargetFind||s.perPixelTargetFind)&&!s.isEditing){var o=this.isTargetTransparent(s,n.x,n.y);if(!o)return!0}else return!0},_searchPossibleTargets:function(i,s){for(var n,o=i.length,f;o--;){var a=i[o],d=a.group?this._normalizePointer(a.group,s):s;if(this._checkTarget(d,a,s)){n=i[o],n.subTargetCheck&&n instanceof e.Group&&(f=this._searchPossibleTargets(n._objects,s),f&&this.targets.push(f));break}}return n},restorePointerVpt:function(i){return e.util.transformPoint(i,e.util.invertTransform(this.viewportTransform))},getPointer:function(i,s){if(this._absolutePointer&&!s)return this._absolutePointer;if(this._pointer&&s)return this._pointer;var n=h(i),o=this.upperCanvasEl,f=o.getBoundingClientRect(),a=f.width||0,d=f.height||0,p;(!a||!d)&&("top"in f&&"bottom"in f&&(d=Math.abs(f.top-f.bottom)),"right"in f&&"left"in f&&(a=Math.abs(f.right-f.left))),this.calcOffset(),n.x=n.x-this._offset.left,n.y=n.y-this._offset.top,s||(n=this.restorePointerVpt(n));var v=this.getRetinaScaling();return v!==1&&(n.x/=v,n.y/=v),a===0||d===0?p={width:1,height:1}:p={width:o.width/a,height:o.height/d},{x:n.x*p.width,y:n.y*p.height}},_createUpperCanvas:function(){var i=this.lowerCanvasEl.className.replace(/\s*lower-canvas\s*/,""),s=this.lowerCanvasEl,n=this.upperCanvasEl;n?n.className="":(n=this._createCanvasElement(),this.upperCanvasEl=n),e.util.addClass(n,"upper-canvas "+i),this.wrapperEl.appendChild(n),this._copyCanvasStyle(s,n),this._applyCanvasStyle(n),this.contextTop=n.getContext("2d")},getTopContext:function(){return this.contextTop},_createCacheCanvas:function(){this.cacheCanvasEl=this._createCanvasElement(),this.cacheCanvasEl.setAttribute("width",this.width),this.cacheCanvasEl.setAttribute("height",this.height),this.contextCache=this.cacheCanvasEl.getContext("2d")},_initWrapperElement:function(){this.wrapperEl=e.util.wrapElement(this.lowerCanvasEl,"div",{class:this.containerClass}),e.util.setStyle(this.wrapperEl,{width:this.width+"px",height:this.height+"px",position:"relative"}),e.util.makeElementUnselectable(this.wrapperEl)},_applyCanvasStyle:function(i){var s=this.width||i.width,n=this.height||i.height;e.util.setStyle(i,{position:"absolute",width:s+"px",height:n+"px",left:0,top:0,"touch-action":this.allowTouchScrolling?"manipulation":"none","-ms-touch-action":this.allowTouchScrolling?"manipulation":"none"}),i.width=s,i.height=n,e.util.makeElementUnselectable(i)},_copyCanvasStyle:function(i,s){s.style.cssText=i.style.cssText},getSelectionContext:function(){return this.contextTop},getSelectionElement:function(){return this.upperCanvasEl},getActiveObject:function(){return this._activeObject},getActiveObjects:function(){var i=this._activeObject;return i?i.type==="activeSelection"&&i._objects?i._objects.slice(0):[i]:[]},_onObjectRemoved:function(i){i===this._activeObject&&(this.fire("before:selection:cleared",{target:i}),this._discardActiveObject(),this.fire("selection:cleared",{target:i}),i.fire("deselected")),i===this._hoveredTarget&&(this._hoveredTarget=null,this._hoveredTargets=[]),this.callSuper("_onObjectRemoved",i)},_fireSelectionEvents:function(i,s){var n=!1,o=this.getActiveObjects(),f=[],a=[];i.forEach(function(d){o.indexOf(d)===-1&&(n=!0,d.fire("deselected",{e:s,target:d}),a.push(d))}),o.forEach(function(d){i.indexOf(d)===-1&&(n=!0,d.fire("selected",{e:s,target:d}),f.push(d))}),i.length>0&&o.length>0?n&&this.fire("selection:updated",{e:s,selected:f,deselected:a}):o.length>0?this.fire("selection:created",{e:s,selected:f}):i.length>0&&this.fire("selection:cleared",{e:s,deselected:a})},setActiveObject:function(i,s){var n=this.getActiveObjects();return this._setActiveObject(i,s),this._fireSelectionEvents(n,s),this},_setActiveObject:function(i,s){return this._activeObject===i||!this._discardActiveObject(s,i)||i.onSelect({e:s})?!1:(this._activeObject=i,!0)},_discardActiveObject:function(i,s){var n=this._activeObject;if(n){if(n.onDeselect({e:i,object:s}))return!1;this._activeObject=null}return!0},discardActiveObject:function(i){var s=this.getActiveObjects(),n=this.getActiveObject();return s.length&&this.fire("before:selection:cleared",{target:n,e:i}),this._discardActiveObject(i),this._fireSelectionEvents(s,i),this},dispose:function(){var i=this.wrapperEl;return this.removeListeners(),i.removeChild(this.upperCanvasEl),i.removeChild(this.lowerCanvasEl),this.contextCache=null,this.contextTop=null,["upperCanvasEl","cacheCanvasEl"].forEach(function(s){e.util.cleanUpJsdomNode(this[s]),this[s]=void 0}.bind(this)),i.parentNode&&i.parentNode.replaceChild(this.lowerCanvasEl,this.wrapperEl),delete this.wrapperEl,e.StaticCanvas.prototype.dispose.call(this),this},clear:function(){return this.discardActiveObject(),this.clearContext(this.contextTop),this.callSuper("clear")},drawControls:function(i){var s=this._activeObject;s&&s._renderControls(i)},_toObject:function(i,s,n){var o=this._realizeGroupTransformOnObject(i),f=this.callSuper("_toObject",i,s,n);return this._unwindGroupTransformOnObject(i,o),f},_realizeGroupTransformOnObject:function(i){if(i.group&&i.group.type==="activeSelection"&&this._activeObject===i.group){var s=["angle","flipX","flipY","left","scaleX","scaleY","skewX","skewY","top"],n={};return s.forEach(function(o){n[o]=i[o]}),e.util.addTransformToObject(i,this._activeObject.calcOwnMatrix()),n}else return null},_unwindGroupTransformOnObject:function(i,s){s&&i.set(s)},_setSVGObject:function(i,s,n){var o=this._realizeGroupTransformOnObject(s);this.callSuper("_setSVGObject",i,s,n),this._unwindGroupTransformOnObject(s,o)},setViewportTransform:function(i){this.renderOnAddRemove&&this._activeObject&&this._activeObject.isEditing&&this._activeObject.clearContextTop(),e.StaticCanvas.prototype.setViewportTransform.call(this,i)}});for(var l in e.StaticCanvas)l!=="prototype"&&(e.Canvas[l]=e.StaticCanvas[l])}(),function(){var h=e.util.addListener,t=e.util.removeListener,c=3,l=2,i=1,s={passive:!1};function n(o,f){return o.button&&o.button===f-1}e.util.object.extend(e.Canvas.prototype,{mainTouchId:null,_initEventListeners:function(){this.removeListeners(),this._bindEvents(),this.addOrRemove(h,"add")},_getEventPrefix:function(){return this.enablePointerEvents?"pointer":"mouse"},addOrRemove:function(o,f){var a=this.upperCanvasEl,d=this._getEventPrefix();o(e.window,"resize",this._onResize),o(a,d+"down",this._onMouseDown),o(a,d+"move",this._onMouseMove,s),o(a,d+"out",this._onMouseOut),o(a,d+"enter",this._onMouseEnter),o(a,"wheel",this._onMouseWheel),o(a,"contextmenu",this._onContextMenu),o(a,"dblclick",this._onDoubleClick),o(a,"dragover",this._onDragOver),o(a,"dragenter",this._onDragEnter),o(a,"dragleave",this._onDragLeave),o(a,"drop",this._onDrop),this.enablePointerEvents||o(a,"touchstart",this._onTouchStart,s),typeof eventjs<"u"&&f in eventjs&&(eventjs[f](a,"gesture",this._onGesture),eventjs[f](a,"drag",this._onDrag),eventjs[f](a,"orientation",this._onOrientationChange),eventjs[f](a,"shake",this._onShake),eventjs[f](a,"longpress",this._onLongPress))},removeListeners:function(){this.addOrRemove(t,"remove");var o=this._getEventPrefix();t(e.document,o+"up",this._onMouseUp),t(e.document,"touchend",this._onTouchEnd,s),t(e.document,o+"move",this._onMouseMove,s),t(e.document,"touchmove",this._onMouseMove,s)},_bindEvents:function(){this.eventsBound||(this._onMouseDown=this._onMouseDown.bind(this),this._onTouchStart=this._onTouchStart.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._onTouchEnd=this._onTouchEnd.bind(this),this._onResize=this._onResize.bind(this),this._onGesture=this._onGesture.bind(this),this._onDrag=this._onDrag.bind(this),this._onShake=this._onShake.bind(this),this._onLongPress=this._onLongPress.bind(this),this._onOrientationChange=this._onOrientationChange.bind(this),this._onMouseWheel=this._onMouseWheel.bind(this),this._onMouseOut=this._onMouseOut.bind(this),this._onMouseEnter=this._onMouseEnter.bind(this),this._onContextMenu=this._onContextMenu.bind(this),this._onDoubleClick=this._onDoubleClick.bind(this),this._onDragOver=this._onDragOver.bind(this),this._onDragEnter=this._simpleEventHandler.bind(this,"dragenter"),this._onDragLeave=this._simpleEventHandler.bind(this,"dragleave"),this._onDrop=this._onDrop.bind(this),this.eventsBound=!0)},_onGesture:function(o,f){this.__onTransformGesture&&this.__onTransformGesture(o,f)},_onDrag:function(o,f){this.__onDrag&&this.__onDrag(o,f)},_onMouseWheel:function(o){this.__onMouseWheel(o)},_onMouseOut:function(o){var f=this._hoveredTarget;this.fire("mouse:out",{target:f,e:o}),this._hoveredTarget=null,f&&f.fire("mouseout",{e:o});var a=this;this._hoveredTargets.forEach(function(d){a.fire("mouse:out",{target:f,e:o}),d&&f.fire("mouseout",{e:o})}),this._hoveredTargets=[]},_onMouseEnter:function(o){!this._currentTransform&&!this.findTarget(o)&&(this.fire("mouse:over",{target:null,e:o}),this._hoveredTarget=null,this._hoveredTargets=[])},_onOrientationChange:function(o,f){this.__onOrientationChange&&this.__onOrientationChange(o,f)},_onShake:function(o,f){this.__onShake&&this.__onShake(o,f)},_onLongPress:function(o,f){this.__onLongPress&&this.__onLongPress(o,f)},_onDragOver:function(o){o.preventDefault();var f=this._simpleEventHandler("dragover",o);this._fireEnterLeaveEvents(f,o)},_onDrop:function(o){return this._simpleEventHandler("drop:before",o),this._simpleEventHandler("drop",o)},_onContextMenu:function(o){return this.stopContextMenu&&(o.stopPropagation(),o.preventDefault()),!1},_onDoubleClick:function(o){this._cacheTransformEventData(o),this._handleEvent(o,"dblclick"),this._resetTransformEventData(o)},getPointerId:function(o){var f=o.changedTouches;return f?f[0]&&f[0].identifier:this.enablePointerEvents?o.pointerId:-1},_isMainEvent:function(o){return o.isPrimary===!0?!0:o.isPrimary===!1?!1:o.type==="touchend"&&o.touches.length===0?!0:o.changedTouches?o.changedTouches[0].identifier===this.mainTouchId:!0},_onTouchStart:function(o){o.preventDefault(),this.mainTouchId===null&&(this.mainTouchId=this.getPointerId(o)),this.__onMouseDown(o),this._resetTransformEventData();var f=this.upperCanvasEl,a=this._getEventPrefix();h(e.document,"touchend",this._onTouchEnd,s),h(e.document,"touchmove",this._onMouseMove,s),t(f,a+"down",this._onMouseDown)},_onMouseDown:function(o){this.__onMouseDown(o),this._resetTransformEventData();var f=this.upperCanvasEl,a=this._getEventPrefix();t(f,a+"move",this._onMouseMove,s),h(e.document,a+"up",this._onMouseUp),h(e.document,a+"move",this._onMouseMove,s)},_onTouchEnd:function(o){if(!(o.touches.length>0)){this.__onMouseUp(o),this._resetTransformEventData(),this.mainTouchId=null;var f=this._getEventPrefix();t(e.document,"touchend",this._onTouchEnd,s),t(e.document,"touchmove",this._onMouseMove,s);var a=this;this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout(function(){h(a.upperCanvasEl,f+"down",a._onMouseDown),a._willAddMouseDown=0},400)}},_onMouseUp:function(o){this.__onMouseUp(o),this._resetTransformEventData();var f=this.upperCanvasEl,a=this._getEventPrefix();this._isMainEvent(o)&&(t(e.document,a+"up",this._onMouseUp),t(e.document,a+"move",this._onMouseMove,s),h(f,a+"move",this._onMouseMove,s))},_onMouseMove:function(o){!this.allowTouchScrolling&&o.preventDefault&&o.preventDefault(),this.__onMouseMove(o)},_onResize:function(){this.calcOffset()},_shouldRender:function(o){var f=this._activeObject;return!!f!=!!o||f&&o&&f!==o?!0:(f&&f.isEditing,!1)},__onMouseUp:function(o){var f,a=this._currentTransform,d=this._groupSelector,p=!1,v=!d||d.left===0&&d.top===0;if(this._cacheTransformEventData(o),f=this._target,this._handleEvent(o,"up:before"),n(o,c)){this.fireRightClick&&this._handleEvent(o,"up",c,v);return}if(n(o,l)){this.fireMiddleClick&&this._handleEvent(o,"up",l,v),this._resetTransformEventData();return}if(this.isDrawingMode&&this._isCurrentlyDrawing){this._onMouseUpInDrawingMode(o);return}if(this._isMainEvent(o)){if(a&&(this._finalizeCurrentTransform(o),p=a.actionPerformed),!v){var b=f===this._activeObject;this._maybeGroupObjects(o),p||(p=this._shouldRender(f)||!b&&f===this._activeObject)}var C,w;if(f){if(C=f._findTargetCorner(this.getPointer(o,!0),e.util.isTouchEvent(o)),f.selectable&&f!==this._activeObject&&f.activeOn==="up")this.setActiveObject(f,o),p=!0;else{var S=f.controls[C],E=S&&S.getMouseUpHandler(o,f,S);E&&(w=this.getPointer(o),E(o,a,w.x,w.y))}f.isMoving=!1}if(a&&(a.target!==f||a.corner!==C)){var P=a.target&&a.target.controls[a.corner],N=P&&P.getMouseUpHandler(o,f,S);w=w||this.getPointer(o),N&&N(o,a,w.x,w.y)}this._setCursorFromEvent(o,f),this._handleEvent(o,"up",i,v),this._groupSelector=null,this._currentTransform=null,f&&(f.__corner=0),p?this.requestRenderAll():v||this.renderTop()}},_simpleEventHandler:function(o,f){var a=this.findTarget(f),d=this.targets,p={e:f,target:a,subTargets:d};if(this.fire(o,p),a&&a.fire(o,p),!d)return a;for(var v=0;v<d.length;v++)d[v].fire(o,p);return a},_handleEvent:function(o,f,a,d){var p=this._target,v=this.targets||[],b={e:o,target:p,subTargets:v,button:a||i,isClick:d||!1,pointer:this._pointer,absolutePointer:this._absolutePointer,transform:this._currentTransform};f==="up"&&(b.currentTarget=this.findTarget(o),b.currentSubTargets=this.targets),this.fire("mouse:"+f,b),p&&p.fire("mouse"+f,b);for(var C=0;C<v.length;C++)v[C].fire("mouse"+f,b)},_finalizeCurrentTransform:function(o){var f=this._currentTransform,a=f.target,d={e:o,target:a,transform:f,action:f.action};a._scaling&&(a._scaling=!1),a.setCoords(),(f.actionPerformed||this.stateful&&a.hasStateChanged())&&this._fire("modified",d)},_onMouseDownInDrawingMode:function(o){this._isCurrentlyDrawing=!0,this.getActiveObject()&&this.discardActiveObject(o).requestRenderAll();var f=this.getPointer(o);this.freeDrawingBrush.onMouseDown(f,{e:o,pointer:f}),this._handleEvent(o,"down")},_onMouseMoveInDrawingMode:function(o){if(this._isCurrentlyDrawing){var f=this.getPointer(o);this.freeDrawingBrush.onMouseMove(f,{e:o,pointer:f})}this.setCursor(this.freeDrawingCursor),this._handleEvent(o,"move")},_onMouseUpInDrawingMode:function(o){var f=this.getPointer(o);this._isCurrentlyDrawing=this.freeDrawingBrush.onMouseUp({e:o,pointer:f}),this._handleEvent(o,"up")},__onMouseDown:function(o){this._cacheTransformEventData(o),this._handleEvent(o,"down:before");var f=this._target;if(n(o,c)){this.fireRightClick&&this._handleEvent(o,"down",c);return}if(n(o,l)){this.fireMiddleClick&&this._handleEvent(o,"down",l);return}if(this.isDrawingMode){this._onMouseDownInDrawingMode(o);return}if(this._isMainEvent(o)&&!this._currentTransform){var a=this._pointer;this._previousPointer=a;var d=this._shouldRender(f),p=this._shouldGroup(o,f);if(this._shouldClearSelection(o,f)?this.discardActiveObject(o):p&&(this._handleGrouping(o,f),f=this._activeObject),this.selection&&(!f||!f.selectable&&!f.isEditing&&f!==this._activeObject)&&(this._groupSelector={ex:this._absolutePointer.x,ey:this._absolutePointer.y,top:0,left:0}),f){var v=f===this._activeObject;f.selectable&&f.activeOn==="down"&&this.setActiveObject(f,o);var b=f._findTargetCorner(this.getPointer(o,!0),e.util.isTouchEvent(o));if(f.__corner=b,f===this._activeObject&&(b||!p)){this._setupCurrentTransform(o,f,v);var C=f.controls[b],a=this.getPointer(o),w=C&&C.getMouseDownHandler(o,f,C);w&&w(o,this._currentTransform,a.x,a.y)}}this._handleEvent(o,"down"),(d||p)&&this.requestRenderAll()}},_resetTransformEventData:function(){this._target=null,this._pointer=null,this._absolutePointer=null},_cacheTransformEventData:function(o){this._resetTransformEventData(),this._pointer=this.getPointer(o,!0),this._absolutePointer=this.restorePointerVpt(this._pointer),this._target=this._currentTransform?this._currentTransform.target:this.findTarget(o)||null},_beforeTransform:function(o){var f=this._currentTransform;this.stateful&&f.target.saveState(),this.fire("before:transform",{e:o,transform:f})},__onMouseMove:function(o){this._handleEvent(o,"move:before"),this._cacheTransformEventData(o);var f,a;if(this.isDrawingMode){this._onMouseMoveInDrawingMode(o);return}if(this._isMainEvent(o)){var d=this._groupSelector;d?(a=this._absolutePointer,d.left=a.x-d.ex,d.top=a.y-d.ey,this.renderTop()):this._currentTransform?this._transformObject(o):(f=this.findTarget(o)||null,this._setCursorFromEvent(o,f),this._fireOverOutEvents(f,o)),this._handleEvent(o,"move"),this._resetTransformEventData()}},_fireOverOutEvents:function(o,f){var a=this._hoveredTarget,d=this._hoveredTargets,p=this.targets,v=Math.max(d.length,p.length);this.fireSyntheticInOutEvents(o,f,{oldTarget:a,evtOut:"mouseout",canvasEvtOut:"mouse:out",evtIn:"mouseover",canvasEvtIn:"mouse:over"});for(var b=0;b<v;b++)this.fireSyntheticInOutEvents(p[b],f,{oldTarget:d[b],evtOut:"mouseout",evtIn:"mouseover"});this._hoveredTarget=o,this._hoveredTargets=this.targets.concat()},_fireEnterLeaveEvents:function(o,f){var a=this._draggedoverTarget,d=this._hoveredTargets,p=this.targets,v=Math.max(d.length,p.length);this.fireSyntheticInOutEvents(o,f,{oldTarget:a,evtOut:"dragleave",evtIn:"dragenter"});for(var b=0;b<v;b++)this.fireSyntheticInOutEvents(p[b],f,{oldTarget:d[b],evtOut:"dragleave",evtIn:"dragenter"});this._draggedoverTarget=o},fireSyntheticInOutEvents:function(o,f,a){var d,p,v=a.oldTarget,b,C,w=v!==o,S=a.canvasEvtIn,E=a.canvasEvtOut;w&&(d={e:f,target:o,previousTarget:v},p={e:f,target:v,nextTarget:o}),C=o&&w,b=v&&w,b&&(E&&this.fire(E,p),v.fire(a.evtOut,p)),C&&(S&&this.fire(S,d),o.fire(a.evtIn,d))},__onMouseWheel:function(o){this._cacheTransformEventData(o),this._handleEvent(o,"wheel"),this._resetTransformEventData()},_transformObject:function(o){var f=this.getPointer(o),a=this._currentTransform;a.reset=!1,a.shiftKey=o.shiftKey,a.altKey=o[this.centeredKey],this._performTransformAction(o,a,f),a.actionPerformed&&this.requestRenderAll()},_performTransformAction:function(o,f,a){var d=a.x,p=a.y,v=f.action,b=!1,C=f.actionHandler;C&&(b=C(o,f,d,p)),v==="drag"&&b&&(f.target.isMoving=!0,this.setCursor(f.target.moveCursor||this.moveCursor)),f.actionPerformed=f.actionPerformed||b},_fire:e.controlsUtils.fireEvent,_setCursorFromEvent:function(o,f){if(!f)return this.setCursor(this.defaultCursor),!1;var a=f.hoverCursor||this.hoverCursor,d=this._activeObject&&this._activeObject.type==="activeSelection"?this._activeObject:null,p=(!d||!d.contains(f))&&f._findTargetCorner(this.getPointer(o,!0));p?this.setCursor(this.getCornerCursor(p,f,o)):(f.subTargetCheck&&this.targets.concat().reverse().map(function(v){a=v.hoverCursor||a}),this.setCursor(a))},getCornerCursor:function(o,f,a){var d=f.controls[o];return d.cursorStyleHandler(a,d,f)}})}(),function(){var h=Math.min,t=Math.max;e.util.object.extend(e.Canvas.prototype,{_shouldGroup:function(c,l){var i=this._activeObject;return i&&this._isSelectionKeyPressed(c)&&l&&l.selectable&&this.selection&&(i!==l||i.type==="activeSelection")&&!l.onSelect({e:c})},_handleGrouping:function(c,l){var i=this._activeObject;i.__corner||l===i&&(l=this.findTarget(c,!0),!l||!l.selectable)||(i&&i.type==="activeSelection"?this._updateActiveSelection(l,c):this._createActiveSelection(l,c))},_updateActiveSelection:function(c,l){var i=this._activeObject,s=i._objects.slice(0);i.contains(c)?(i.removeWithUpdate(c),this._hoveredTarget=c,this._hoveredTargets=this.targets.concat(),i.size()===1&&this._setActiveObject(i.item(0),l)):(i.addWithUpdate(c),this._hoveredTarget=i,this._hoveredTargets=this.targets.concat()),this._fireSelectionEvents(s,l)},_createActiveSelection:function(c,l){var i=this.getActiveObjects(),s=this._createGroup(c);this._hoveredTarget=s,this._setActiveObject(s,l),this._fireSelectionEvents(i,l)},_createGroup:function(c){var l=this._objects,i=l.indexOf(this._activeObject)<l.indexOf(c),s=i?[this._activeObject,c]:[c,this._activeObject];return this._activeObject.isEditing&&this._activeObject.exitEditing(),new e.ActiveSelection(s,{canvas:this})},_groupSelectedObjects:function(c){var l=this._collectObjects(c),i;l.length===1?this.setActiveObject(l[0],c):l.length>1&&(i=new e.ActiveSelection(l.reverse(),{canvas:this}),this.setActiveObject(i,c))},_collectObjects:function(c){for(var l=[],i,s=this._groupSelector.ex,n=this._groupSelector.ey,o=s+this._groupSelector.left,f=n+this._groupSelector.top,a=new e.Point(h(s,o),h(n,f)),d=new e.Point(t(s,o),t(n,f)),p=!this.selectionFullyContained,v=s===o&&n===f,b=this._objects.length;b--&&(i=this._objects[b],!(!(!i||!i.selectable||!i.visible)&&(p&&i.intersectsWithRect(a,d,!0)||i.isContainedWithinRect(a,d,!0)||p&&i.containsPoint(a,null,!0)||p&&i.containsPoint(d,null,!0))&&(l.push(i),v))););return l.length>1&&(l=l.filter(function(C){return!C.onSelect({e:c})})),l},_maybeGroupObjects:function(c){this.selection&&this._groupSelector&&this._groupSelectedObjects(c),this.setCursor(this.defaultCursor),this._groupSelector=null}})}(),function(){e.util.object.extend(e.StaticCanvas.prototype,{toDataURL:function(h){h||(h={});var t=h.format||"png",c=h.quality||1,l=(h.multiplier||1)*(h.enableRetinaScaling?this.getRetinaScaling():1),i=this.toCanvasElement(l,h);return e.util.toDataURL(i,t,c)},toCanvasElement:function(h,t){h=h||1,t=t||{};var c=(t.width||this.width)*h,l=(t.height||this.height)*h,i=this.getZoom(),s=this.width,n=this.height,o=i*h,f=this.viewportTransform,a=(f[4]-(t.left||0))*h,d=(f[5]-(t.top||0))*h,p=this.interactive,v=[o,0,0,o,a,d],b=this.enableRetinaScaling,C=e.util.createCanvasElement(),w=this.contextTop;return C.width=c,C.height=l,this.contextTop=null,this.enableRetinaScaling=!1,this.interactive=!1,this.viewportTransform=v,this.width=c,this.height=l,this.calcViewportBoundaries(),this.renderCanvas(C.getContext("2d"),this._objects),this.viewportTransform=f,this.width=s,this.height=n,this.calcViewportBoundaries(),this.interactive=p,this.enableRetinaScaling=b,this.contextTop=w,C}})}(),e.util.object.extend(e.StaticCanvas.prototype,{loadFromJSON:function(h,t,c){if(h){var l=typeof h=="string"?JSON.parse(h):e.util.object.clone(h),i=this,s=l.clipPath,n=this.renderOnAddRemove;return this.renderOnAddRemove=!1,delete l.clipPath,this._enlivenObjects(l.objects,function(o){i.clear(),i._setBgOverlay(l,function(){s?i._enlivenObjects([s],function(f){i.clipPath=f[0],i.__setupCanvas.call(i,l,o,n,t)}):i.__setupCanvas.call(i,l,o,n,t)})},c),this}},__setupCanvas:function(h,t,c,l){var i=this;t.forEach(function(s,n){i.insertAt(s,n)}),this.renderOnAddRemove=c,delete h.objects,delete h.backgroundImage,delete h.overlayImage,delete h.background,delete h.overlay,this._setOptions(h),this.renderAll(),l&&l()},_setBgOverlay:function(h,t){var c={backgroundColor:!1,overlayColor:!1,backgroundImage:!1,overlayImage:!1};if(!h.backgroundImage&&!h.overlayImage&&!h.background&&!h.overlay){t&&t();return}var l=function(){c.backgroundImage&&c.overlayImage&&c.backgroundColor&&c.overlayColor&&t&&t()};this.__setBgOverlay("backgroundImage",h.backgroundImage,c,l),this.__setBgOverlay("overlayImage",h.overlayImage,c,l),this.__setBgOverlay("backgroundColor",h.background,c,l),this.__setBgOverlay("overlayColor",h.overlay,c,l)},__setBgOverlay:function(h,t,c,l){var i=this;if(!t){c[h]=!0,l&&l();return}h==="backgroundImage"||h==="overlayImage"?e.util.enlivenObjects([t],function(s){i[h]=s[0],c[h]=!0,l&&l()}):this["set"+e.util.string.capitalize(h,!0)](t,function(){c[h]=!0,l&&l()})},_enlivenObjects:function(h,t,c){if(!h||h.length===0){t&&t([]);return}e.util.enlivenObjects(h,function(l){t&&t(l)},null,c)},_toDataURL:function(h,t){this.clone(function(c){t(c.toDataURL(h))})},_toDataURLWithMultiplier:function(h,t,c){this.clone(function(l){c(l.toDataURLWithMultiplier(h,t))})},clone:function(h,t){var c=JSON.stringify(this.toJSON(t));this.cloneWithoutData(function(l){l.loadFromJSON(c,function(){h&&h(l)})})},cloneWithoutData:function(h){var t=e.util.createCanvasElement();t.width=this.width,t.height=this.height;var c=new e.Canvas(t);this.backgroundImage?(c.setBackgroundImage(this.backgroundImage.src,function(){c.renderAll(),h&&h(c)}),c.backgroundImageOpacity=this.backgroundImageOpacity,c.backgroundImageStretch=this.backgroundImageStretch):h&&h(c)}}),function(h){var t=h.fabric||(h.fabric={}),c=t.util.object.extend,l=t.util.object.clone,i=t.util.toFixed,s=t.util.string.capitalize,n=t.util.degreesToRadians,o=!t.isLikelyNode,f=2;t.Object||(t.Object=t.util.createClass(t.CommonMethods,{type:"object",originX:"left",originY:"top",top:0,left:0,width:0,height:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1,opacity:1,angle:0,skewX:0,skewY:0,cornerSize:13,touchCornerSize:24,transparentCorners:!0,hoverCursor:null,moveCursor:null,padding:0,borderColor:"rgb(178,204,255)",borderDashArray:null,cornerColor:"rgb(178,204,255)",cornerStrokeColor:null,cornerStyle:"rect",cornerDashArray:null,centeredScaling:!1,centeredRotation:!0,fill:"rgb(0,0,0)",fillRule:"nonzero",globalCompositeOperation:"source-over",backgroundColor:"",selectionBackgroundColor:"",stroke:null,strokeWidth:1,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,shadow:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,minScaleLimit:0,selectable:!0,evented:!0,visible:!0,hasControls:!0,hasBorders:!0,perPixelTargetFind:!1,includeDefaultValues:!0,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,excludeFromExport:!1,objectCaching:o,statefullCache:!1,noScaleCache:!0,strokeUniform:!1,dirty:!0,__corner:0,paintFirst:"fill",activeOn:"down",stateProperties:"top left width height scaleX scaleY flipX flipY originX originY transformMatrix stroke strokeWidth strokeDashArray strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit angle opacity fill globalCompositeOperation shadow visible backgroundColor skewX skewY fillRule paintFirst clipPath strokeUniform".split(" "),cacheProperties:"fill stroke strokeWidth strokeDashArray width height paintFirst strokeUniform strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit backgroundColor clipPath".split(" "),colorProperties:"fill stroke backgroundColor".split(" "),clipPath:void 0,inverted:!1,absolutePositioned:!1,initialize:function(a){a&&this.setOptions(a)},_createCacheCanvas:function(){this._cacheProperties={},this._cacheCanvas=t.util.createCanvasElement(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0},_limitCacheSize:function(a){var d=t.perfLimitSizeTotal,p=a.width,v=a.height,b=t.maxCacheSideLimit,C=t.minCacheSideLimit;if(p<=b&&v<=b&&p*v<=d)return p<C&&(a.width=C),v<C&&(a.height=C),a;var w=p/v,S=t.util.limitDimsByArea(w,d),E=t.util.capValue,P=E(C,S.x,b),N=E(C,S.y,b);return p>P&&(a.zoomX/=p/P,a.width=P,a.capped=!0),v>N&&(a.zoomY/=v/N,a.height=N,a.capped=!0),a},_getCacheCanvasDimensions:function(){var a=this.getTotalObjectScaling(),d=this._getTransformedDimensions(0,0),p=d.x*a.scaleX/this.scaleX,v=d.y*a.scaleY/this.scaleY;return{width:p+f,height:v+f,zoomX:a.scaleX,zoomY:a.scaleY,x:p,y:v}},_updateCacheCanvas:function(){var a=this.canvas;if(this.noScaleCache&&a&&a._currentTransform){var d=a._currentTransform.target,p=a._currentTransform.action;if(this===d&&p.slice&&p.slice(0,5)==="scale")return!1}var v=this._cacheCanvas,b=this._limitCacheSize(this._getCacheCanvasDimensions()),C=t.minCacheSideLimit,w=b.width,S=b.height,E,P,N=b.zoomX,K=b.zoomY,Z=w!==this.cacheWidth||S!==this.cacheHeight,W=this.zoomX!==N||this.zoomY!==K,U=Z||W,te=0,re=0,he=!1;if(Z){var oe=this._cacheCanvas.width,T=this._cacheCanvas.height,k=w>oe||S>T,D=(w<oe*.9||S<T*.9)&&oe>C&&T>C;he=k||D,k&&!b.capped&&(w>C||S>C)&&(te=w*.1,re=S*.1)}return this instanceof t.Text&&this.path&&(U=!0,he=!0,te+=this.getHeightOfLine(0)*this.zoomX,re+=this.getHeightOfLine(0)*this.zoomY),U?(he?(v.width=Math.ceil(w+te),v.height=Math.ceil(S+re)):(this._cacheContext.setTransform(1,0,0,1,0,0),this._cacheContext.clearRect(0,0,v.width,v.height)),E=b.x/2,P=b.y/2,this.cacheTranslationX=Math.round(v.width/2-E)+E,this.cacheTranslationY=Math.round(v.height/2-P)+P,this.cacheWidth=w,this.cacheHeight=S,this._cacheContext.translate(this.cacheTranslationX,this.cacheTranslationY),this._cacheContext.scale(N,K),this.zoomX=N,this.zoomY=K,!0):!1},setOptions:function(a){this._setOptions(a),this._initGradient(a.fill,"fill"),this._initGradient(a.stroke,"stroke"),this._initPattern(a.fill,"fill"),this._initPattern(a.stroke,"stroke")},transform:function(a){var d=this.group&&!this.group._transformDone||this.group&&this.canvas&&a===this.canvas.contextTop,p=this.calcTransformMatrix(!d);a.transform(p[0],p[1],p[2],p[3],p[4],p[5])},toObject:function(a){var d=t.Object.NUM_FRACTION_DIGITS,p={type:this.type,version:t.version,originX:this.originX,originY:this.originY,left:i(this.left,d),top:i(this.top,d),width:i(this.width,d),height:i(this.height,d),fill:this.fill&&this.fill.toObject?this.fill.toObject():this.fill,stroke:this.stroke&&this.stroke.toObject?this.stroke.toObject():this.stroke,strokeWidth:i(this.strokeWidth,d),strokeDashArray:this.strokeDashArray?this.strokeDashArray.concat():this.strokeDashArray,strokeLineCap:this.strokeLineCap,strokeDashOffset:this.strokeDashOffset,strokeLineJoin:this.strokeLineJoin,strokeUniform:this.strokeUniform,strokeMiterLimit:i(this.strokeMiterLimit,d),scaleX:i(this.scaleX,d),scaleY:i(this.scaleY,d),angle:i(this.angle,d),flipX:this.flipX,flipY:this.flipY,opacity:i(this.opacity,d),shadow:this.shadow&&this.shadow.toObject?this.shadow.toObject():this.shadow,visible:this.visible,backgroundColor:this.backgroundColor,fillRule:this.fillRule,paintFirst:this.paintFirst,globalCompositeOperation:this.globalCompositeOperation,skewX:i(this.skewX,d),skewY:i(this.skewY,d)};return this.clipPath&&!this.clipPath.excludeFromExport&&(p.clipPath=this.clipPath.toObject(a),p.clipPath.inverted=this.clipPath.inverted,p.clipPath.absolutePositioned=this.clipPath.absolutePositioned),t.util.populateWithProperties(this,p,a),this.includeDefaultValues||(p=this._removeDefaultValues(p)),p},toDatalessObject:function(a){return this.toObject(a)},_removeDefaultValues:function(a){var d=t.util.getKlass(a.type).prototype,p=d.stateProperties;return p.forEach(function(v){v==="left"||v==="top"||(a[v]===d[v]&&delete a[v],Array.isArray(a[v])&&Array.isArray(d[v])&&a[v].length===0&&d[v].length===0&&delete a[v])}),a},toString:function(){return"#<fabric."+s(this.type)+">"},getObjectScaling:function(){if(!this.group)return{scaleX:this.scaleX,scaleY:this.scaleY};var a=t.util.qrDecompose(this.calcTransformMatrix());return{scaleX:Math.abs(a.scaleX),scaleY:Math.abs(a.scaleY)}},getTotalObjectScaling:function(){var a=this.getObjectScaling(),d=a.scaleX,p=a.scaleY;if(this.canvas){var v=this.canvas.getZoom(),b=this.canvas.getRetinaScaling();d*=v*b,p*=v*b}return{scaleX:d,scaleY:p}},getObjectOpacity:function(){var a=this.opacity;return this.group&&(a*=this.group.getObjectOpacity()),a},_set:function(a,d){var p=a==="scaleX"||a==="scaleY",v=this[a]!==d,b=!1;return p&&(d=this._constrainScale(d)),a==="scaleX"&&d<0?(this.flipX=!this.flipX,d*=-1):a==="scaleY"&&d<0?(this.flipY=!this.flipY,d*=-1):a==="shadow"&&d&&!(d instanceof t.Shadow)?d=new t.Shadow(d):a==="dirty"&&this.group&&this.group.set("dirty",d),this[a]=d,v&&(b=this.group&&this.group.isOnACache(),this.cacheProperties.indexOf(a)>-1?(this.dirty=!0,b&&this.group.set("dirty",!0)):b&&this.stateProperties.indexOf(a)>-1&&this.group.set("dirty",!0)),this},setOnGroup:function(){},getViewportTransform:function(){return this.canvas&&this.canvas.viewportTransform?this.canvas.viewportTransform:t.iMatrix.concat()},isNotVisible:function(){return this.opacity===0||!this.width&&!this.height&&this.strokeWidth===0||!this.visible},render:function(a){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(a.save(),this._setupCompositeOperation(a),this.drawSelectionBackground(a),this.transform(a),this._setOpacity(a),this._setShadow(a,this),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(a)):(this._removeCacheCanvas(),this.dirty=!1,this.drawObject(a),this.objectCaching&&this.statefullCache&&this.saveState({propertySet:"cacheProperties"})),a.restore())},renderCache:function(a){a=a||{},(!this._cacheCanvas||!this._cacheContext)&&this._createCacheCanvas(),this.isCacheDirty()&&(this.statefullCache&&this.saveState({propertySet:"cacheProperties"}),this.drawObject(this._cacheContext,a.forClipping),this.dirty=!1)},_removeCacheCanvas:function(){this._cacheCanvas=null,this._cacheContext=null,this.cacheWidth=0,this.cacheHeight=0},hasStroke:function(){return this.stroke&&this.stroke!=="transparent"&&this.strokeWidth!==0},hasFill:function(){return this.fill&&this.fill!=="transparent"},needsItsOwnCache:function(){return!!(this.paintFirst==="stroke"&&this.hasFill()&&this.hasStroke()&&typeof this.shadow=="object"||this.clipPath)},shouldCache:function(){return this.ownCaching=this.needsItsOwnCache()||this.objectCaching&&(!this.group||!this.group.isOnACache()),this.ownCaching},willDrawShadow:function(){return!!this.shadow&&(this.shadow.offsetX!==0||this.shadow.offsetY!==0)},drawClipPathOnCache:function(a,d){if(a.save(),d.inverted?a.globalCompositeOperation="destination-out":a.globalCompositeOperation="destination-in",d.absolutePositioned){var p=t.util.invertTransform(this.calcTransformMatrix());a.transform(p[0],p[1],p[2],p[3],p[4],p[5])}d.transform(a),a.scale(1/d.zoomX,1/d.zoomY),a.drawImage(d._cacheCanvas,-d.cacheTranslationX,-d.cacheTranslationY),a.restore()},drawObject:function(a,d){var p=this.fill,v=this.stroke;d?(this.fill="black",this.stroke="",this._setClippingProperties(a)):this._renderBackground(a),this._render(a),this._drawClipPath(a,this.clipPath),this.fill=p,this.stroke=v},_drawClipPath:function(a,d){d&&(d.canvas=this.canvas,d.shouldCache(),d._transformDone=!0,d.renderCache({forClipping:!0}),this.drawClipPathOnCache(a,d))},drawCacheOnCanvas:function(a){a.scale(1/this.zoomX,1/this.zoomY),a.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)},isCacheDirty:function(a){if(this.isNotVisible())return!1;if(this._cacheCanvas&&this._cacheContext&&!a&&this._updateCacheCanvas())return!0;if(this.dirty||this.clipPath&&this.clipPath.absolutePositioned||this.statefullCache&&this.hasStateChanged("cacheProperties")){if(this._cacheCanvas&&this._cacheContext&&!a){var d=this.cacheWidth/this.zoomX,p=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-d/2,-p/2,d,p)}return!0}return!1},_renderBackground:function(a){if(this.backgroundColor){var d=this._getNonTransformedDimensions();a.fillStyle=this.backgroundColor,a.fillRect(-d.x/2,-d.y/2,d.x,d.y),this._removeShadow(a)}},_setOpacity:function(a){this.group&&!this.group._transformDone?a.globalAlpha=this.getObjectOpacity():a.globalAlpha*=this.opacity},_setStrokeStyles:function(a,d){var p=d.stroke;p&&(a.lineWidth=d.strokeWidth,a.lineCap=d.strokeLineCap,a.lineDashOffset=d.strokeDashOffset,a.lineJoin=d.strokeLineJoin,a.miterLimit=d.strokeMiterLimit,p.toLive?p.gradientUnits==="percentage"||p.gradientTransform||p.patternTransform?this._applyPatternForTransformedGradient(a,p):(a.strokeStyle=p.toLive(a,this),this._applyPatternGradientTransform(a,p)):a.strokeStyle=d.stroke)},_setFillStyles:function(a,d){var p=d.fill;p&&(p.toLive?(a.fillStyle=p.toLive(a,this),this._applyPatternGradientTransform(a,d.fill)):a.fillStyle=p)},_setClippingProperties:function(a){a.globalAlpha=1,a.strokeStyle="transparent",a.fillStyle="#000000"},_setLineDash:function(a,d){!d||d.length===0||(1&d.length&&d.push.apply(d,d),a.setLineDash(d))},_renderControls:function(a,d){var p=this.getViewportTransform(),v=this.calcTransformMatrix(),b,C,w;d=d||{},C=typeof d.hasBorders<"u"?d.hasBorders:this.hasBorders,w=typeof d.hasControls<"u"?d.hasControls:this.hasControls,v=t.util.multiplyTransformMatrices(p,v),b=t.util.qrDecompose(v),a.save(),a.translate(b.translateX,b.translateY),a.lineWidth=1*this.borderScaleFactor,this.group||(a.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),this.flipX&&(b.angle-=180),a.rotate(n(this.group?b.angle:this.angle)),d.forActiveSelection||this.group?C&&this.drawBordersInGroup(a,b,d):C&&this.drawBorders(a,d),w&&this.drawControls(a,d),a.restore()},_setShadow:function(a){if(this.shadow){var d=this.shadow,p=this.canvas,v,b=p&&p.viewportTransform[0]||1,C=p&&p.viewportTransform[3]||1;d.nonScaling?v={scaleX:1,scaleY:1}:v=this.getObjectScaling(),p&&p._isRetinaScaling()&&(b*=t.devicePixelRatio,C*=t.devicePixelRatio),a.shadowColor=d.color,a.shadowBlur=d.blur*t.browserShadowBlurConstant*(b+C)*(v.scaleX+v.scaleY)/4,a.shadowOffsetX=d.offsetX*b*v.scaleX,a.shadowOffsetY=d.offsetY*C*v.scaleY}},_removeShadow:function(a){this.shadow&&(a.shadowColor="",a.shadowBlur=a.shadowOffsetX=a.shadowOffsetY=0)},_applyPatternGradientTransform:function(a,d){if(!d||!d.toLive)return{offsetX:0,offsetY:0};var p=d.gradientTransform||d.patternTransform,v=-this.width/2+d.offsetX||0,b=-this.height/2+d.offsetY||0;return d.gradientUnits==="percentage"?a.transform(this.width,0,0,this.height,v,b):a.transform(1,0,0,1,v,b),p&&a.transform(p[0],p[1],p[2],p[3],p[4],p[5]),{offsetX:v,offsetY:b}},_renderPaintInOrder:function(a){this.paintFirst==="stroke"?(this._renderStroke(a),this._renderFill(a)):(this._renderFill(a),this._renderStroke(a))},_render:function(){},_renderFill:function(a){this.fill&&(a.save(),this._setFillStyles(a,this),this.fillRule==="evenodd"?a.fill("evenodd"):a.fill(),a.restore())},_renderStroke:function(a){if(!(!this.stroke||this.strokeWidth===0)){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(a),a.save(),this.strokeUniform&&this.group){var d=this.getObjectScaling();a.scale(1/d.scaleX,1/d.scaleY)}else this.strokeUniform&&a.scale(1/this.scaleX,1/this.scaleY);this._setLineDash(a,this.strokeDashArray),this._setStrokeStyles(a,this),a.stroke(),a.restore()}},_applyPatternForTransformedGradient:function(a,d){var p=this._limitCacheSize(this._getCacheCanvasDimensions()),v=t.util.createCanvasElement(),b,C=this.canvas.getRetinaScaling(),w=p.x/this.scaleX/C,S=p.y/this.scaleY/C;v.width=w,v.height=S,b=v.getContext("2d"),b.beginPath(),b.moveTo(0,0),b.lineTo(w,0),b.lineTo(w,S),b.lineTo(0,S),b.closePath(),b.translate(w/2,S/2),b.scale(p.zoomX/this.scaleX/C,p.zoomY/this.scaleY/C),this._applyPatternGradientTransform(b,d),b.fillStyle=d.toLive(a),b.fill(),a.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),a.scale(C*this.scaleX/p.zoomX,C*this.scaleY/p.zoomY),a.strokeStyle=b.createPattern(v,"no-repeat")},_findCenterFromElement:function(){return{x:this.left+this.width/2,y:this.top+this.height/2}},_assignTransformMatrixProps:function(){if(this.transformMatrix){var a=t.util.qrDecompose(this.transformMatrix);this.flipX=!1,this.flipY=!1,this.set("scaleX",a.scaleX),this.set("scaleY",a.scaleY),this.angle=a.angle,this.skewX=a.skewX,this.skewY=0}},_removeTransformMatrix:function(a){var d=this._findCenterFromElement();this.transformMatrix&&(this._assignTransformMatrixProps(),d=t.util.transformPoint(d,this.transformMatrix)),this.transformMatrix=null,a&&(this.scaleX*=a.scaleX,this.scaleY*=a.scaleY,this.cropX=a.cropX,this.cropY=a.cropY,d.x+=a.offsetLeft,d.y+=a.offsetTop,this.width=a.width,this.height=a.height),this.setPositionByOrigin(d,"center","center")},clone:function(a,d){var p=this.toObject(d);this.constructor.fromObject?this.constructor.fromObject(p,a):t.Object._fromObject("Object",p,a)},cloneAsImage:function(a,d){var p=this.toCanvasElement(d);return a&&a(new t.Image(p)),this},toCanvasElement:function(a){a||(a={});var d=t.util,p=d.saveObjectTransform(this),v=this.group,b=this.shadow,C=Math.abs,w=(a.multiplier||1)*(a.enableRetinaScaling?t.devicePixelRatio:1);delete this.group,a.withoutTransform&&d.resetObjectTransform(this),a.withoutShadow&&(this.shadow=null);var S=t.util.createCanvasElement(),E=this.getBoundingRect(!0,!0),P=this.shadow,N,K={x:0,y:0},Z,W,U;P&&(Z=P.blur,P.nonScaling?N={scaleX:1,scaleY:1}:N=this.getObjectScaling(),K.x=2*Math.round(C(P.offsetX)+Z)*C(N.scaleX),K.y=2*Math.round(C(P.offsetY)+Z)*C(N.scaleY)),W=E.width+K.x,U=E.height+K.y,S.width=Math.ceil(W),S.height=Math.ceil(U);var te=new t.StaticCanvas(S,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1});a.format==="jpeg"&&(te.backgroundColor="#fff"),this.setPositionByOrigin(new t.Point(te.width/2,te.height/2),"center","center");var re=this.canvas;te.add(this);var he=te.toCanvasElement(w||1,a);return this.shadow=b,this.set("canvas",re),v&&(this.group=v),this.set(p).setCoords(),te._objects=[],te.dispose(),te=null,he},toDataURL:function(a){return a||(a={}),t.util.toDataURL(this.toCanvasElement(a),a.format||"png",a.quality||1)},isType:function(a){return arguments.length>1?Array.from(arguments).includes(this.type):this.type===a},complexity:function(){return 1},toJSON:function(a){return this.toObject(a)},rotate:function(a){var d=(this.originX!=="center"||this.originY!=="center")&&this.centeredRotation;return d&&this._setOriginToCenter(),this.set("angle",a),d&&this._resetOrigin(),this},centerH:function(){return this.canvas&&this.canvas.centerObjectH(this),this},viewportCenterH:function(){return this.canvas&&this.canvas.viewportCenterObjectH(this),this},centerV:function(){return this.canvas&&this.canvas.centerObjectV(this),this},viewportCenterV:function(){return this.canvas&&this.canvas.viewportCenterObjectV(this),this},center:function(){return this.canvas&&this.canvas.centerObject(this),this},viewportCenter:function(){return this.canvas&&this.canvas.viewportCenterObject(this),this},getLocalPointer:function(a,d){d=d||this.canvas.getPointer(a);var p=new t.Point(d.x,d.y),v=this._getLeftTopCoords();return this.angle&&(p=t.util.rotatePoint(p,v,n(-this.angle))),{x:p.x-v.x,y:p.y-v.y}},_setupCompositeOperation:function(a){this.globalCompositeOperation&&(a.globalCompositeOperation=this.globalCompositeOperation)},dispose:function(){t.runningAnimations&&t.runningAnimations.cancelByTarget(this)}}),t.util.createAccessors&&t.util.createAccessors(t.Object),c(t.Object.prototype,t.Observable),t.Object.NUM_FRACTION_DIGITS=2,t.Object.ENLIVEN_PROPS=["clipPath"],t.Object._fromObject=function(a,d,p,v){var b=t[a];d=l(d,!0),t.util.enlivenPatterns([d.fill,d.stroke],function(C){typeof C[0]<"u"&&(d.fill=C[0]),typeof C[1]<"u"&&(d.stroke=C[1]),t.util.enlivenObjectEnlivables(d,d,function(){var w=v?new b(d[v],d):new b(d);p&&p(w)})})},t.Object.__uid=0)}(r),function(){var h=e.util.degreesToRadians,t={left:-.5,center:0,right:.5},c={top:-.5,center:0,bottom:.5};e.util.object.extend(e.Object.prototype,{translateToGivenOrigin:function(l,i,s,n,o){var f=l.x,a=l.y,d,p,v;return typeof i=="string"?i=t[i]:i-=.5,typeof n=="string"?n=t[n]:n-=.5,d=n-i,typeof s=="string"?s=c[s]:s-=.5,typeof o=="string"?o=c[o]:o-=.5,p=o-s,(d||p)&&(v=this._getTransformedDimensions(),f=l.x+d*v.x,a=l.y+p*v.y),new e.Point(f,a)},translateToCenterPoint:function(l,i,s){var n=this.translateToGivenOrigin(l,i,s,"center","center");return this.angle?e.util.rotatePoint(n,l,h(this.angle)):n},translateToOriginPoint:function(l,i,s){var n=this.translateToGivenOrigin(l,"center","center",i,s);return this.angle?e.util.rotatePoint(n,l,h(this.angle)):n},getCenterPoint:function(){var l=new e.Point(this.left,this.top);return this.translateToCenterPoint(l,this.originX,this.originY)},getPointByOrigin:function(l,i){var s=this.getCenterPoint();return this.translateToOriginPoint(s,l,i)},toLocalPoint:function(l,i,s){var n=this.getCenterPoint(),o,f;return typeof i<"u"&&typeof s<"u"?o=this.translateToGivenOrigin(n,"center","center",i,s):o=new e.Point(this.left,this.top),f=new e.Point(l.x,l.y),this.angle&&(f=e.util.rotatePoint(f,n,-h(this.angle))),f.subtractEquals(o)},setPositionByOrigin:function(l,i,s){var n=this.translateToCenterPoint(l,i,s),o=this.translateToOriginPoint(n,this.originX,this.originY);this.set("left",o.x),this.set("top",o.y)},adjustPosition:function(l){var i=h(this.angle),s=this.getScaledWidth(),n=e.util.cos(i)*s,o=e.util.sin(i)*s,f,a;typeof this.originX=="string"?f=t[this.originX]:f=this.originX-.5,typeof l=="string"?a=t[l]:a=l-.5,this.left+=n*(a-f),this.top+=o*(a-f),this.setCoords(),this.originX=l},_setOriginToCenter:function(){this._originalOriginX=this.originX,this._originalOriginY=this.originY;var l=this.getCenterPoint();this.originX="center",this.originY="center",this.left=l.x,this.top=l.y},_resetOrigin:function(){var l=this.translateToOriginPoint(this.getCenterPoint(),this._originalOriginX,this._originalOriginY);this.originX=this._originalOriginX,this.originY=this._originalOriginY,this.left=l.x,this.top=l.y,this._originalOriginX=null,this._originalOriginY=null},_getLeftTopCoords:function(){return this.translateToOriginPoint(this.getCenterPoint(),"left","top")}})}(),function(){function h(s){return[new e.Point(s.tl.x,s.tl.y),new e.Point(s.tr.x,s.tr.y),new e.Point(s.br.x,s.br.y),new e.Point(s.bl.x,s.bl.y)]}var t=e.util,c=t.degreesToRadians,l=t.multiplyTransformMatrices,i=t.transformPoint;t.object.extend(e.Object.prototype,{oCoords:null,aCoords:null,lineCoords:null,ownMatrixCache:null,matrixCache:null,controls:{},_getCoords:function(s,n){return n?s?this.calcACoords():this.calcLineCoords():((!this.aCoords||!this.lineCoords)&&this.setCoords(!0),s?this.aCoords:this.lineCoords)},getCoords:function(s,n){return h(this._getCoords(s,n))},intersectsWithRect:function(s,n,o,f){var a=this.getCoords(o,f),d=e.Intersection.intersectPolygonRectangle(a,s,n);return d.status==="Intersection"},intersectsWithObject:function(s,n,o){var f=e.Intersection.intersectPolygonPolygon(this.getCoords(n,o),s.getCoords(n,o));return f.status==="Intersection"||s.isContainedWithinObject(this,n,o)||this.isContainedWithinObject(s,n,o)},isContainedWithinObject:function(s,n,o){for(var f=this.getCoords(n,o),a=n?s.aCoords:s.lineCoords,d=0,p=s._getImageLines(a);d<4;d++)if(!s.containsPoint(f[d],p))return!1;return!0},isContainedWithinRect:function(s,n,o,f){var a=this.getBoundingRect(o,f);return a.left>=s.x&&a.left+a.width<=n.x&&a.top>=s.y&&a.top+a.height<=n.y},containsPoint:function(s,d,o,f){var a=this._getCoords(o,f),d=d||this._getImageLines(a),p=this._findCrossPoints(s,d);return p!==0&&p%2===1},isOnScreen:function(s){if(!this.canvas)return!1;var n=this.canvas.vptCoords.tl,o=this.canvas.vptCoords.br,f=this.getCoords(!0,s);return f.some(function(a){return a.x<=o.x&&a.x>=n.x&&a.y<=o.y&&a.y>=n.y})||this.intersectsWithRect(n,o,!0,s)?!0:this._containsCenterOfCanvas(n,o,s)},_containsCenterOfCanvas:function(s,n,o){var f={x:(s.x+n.x)/2,y:(s.y+n.y)/2};return!!this.containsPoint(f,null,!0,o)},isPartiallyOnScreen:function(s){if(!this.canvas)return!1;var n=this.canvas.vptCoords.tl,o=this.canvas.vptCoords.br;if(this.intersectsWithRect(n,o,!0,s))return!0;var f=this.getCoords(!0,s).every(function(a){return(a.x>=o.x||a.x<=n.x)&&(a.y>=o.y||a.y<=n.y)});return f&&this._containsCenterOfCanvas(n,o,s)},_getImageLines:function(s){var n={topline:{o:s.tl,d:s.tr},rightline:{o:s.tr,d:s.br},bottomline:{o:s.br,d:s.bl},leftline:{o:s.bl,d:s.tl}};return n},_findCrossPoints:function(s,n){var o,f,a,d,p,v=0,b;for(var C in n)if(b=n[C],!(b.o.y<s.y&&b.d.y<s.y)&&!(b.o.y>=s.y&&b.d.y>=s.y)&&(b.o.x===b.d.x&&b.o.x>=s.x?p=b.o.x:(o=0,f=(b.d.y-b.o.y)/(b.d.x-b.o.x),a=s.y-o*s.x,d=b.o.y-f*b.o.x,p=-(a-d)/(o-f)),p>=s.x&&(v+=1),v===2))break;return v},getBoundingRect:function(s,n){var o=this.getCoords(s,n);return t.makeBoundingBoxFromPoints(o)},getScaledWidth:function(){return this._getTransformedDimensions().x},getScaledHeight:function(){return this._getTransformedDimensions().y},_constrainScale:function(s){return Math.abs(s)<this.minScaleLimit?s<0?-this.minScaleLimit:this.minScaleLimit:s===0?1e-4:s},scale:function(s){return this._set("scaleX",s),this._set("scaleY",s),this.setCoords()},scaleToWidth:function(s,n){var o=this.getBoundingRect(n).width/this.getScaledWidth();return this.scale(s/this.width/o)},scaleToHeight:function(s,n){var o=this.getBoundingRect(n).height/this.getScaledHeight();return this.scale(s/this.height/o)},calcLineCoords:function(){var s=this.getViewportTransform(),n=this.padding,o=c(this.angle),f=t.cos(o),a=t.sin(o),d=f*n,p=a*n,v=d+p,b=d-p,C=this.calcACoords(),w={tl:i(C.tl,s),tr:i(C.tr,s),bl:i(C.bl,s),br:i(C.br,s)};return n&&(w.tl.x-=b,w.tl.y-=v,w.tr.x+=v,w.tr.y-=b,w.bl.x-=v,w.bl.y+=b,w.br.x+=b,w.br.y+=v),w},calcOCoords:function(){var s=this._calcRotateMatrix(),n=this._calcTranslateMatrix(),o=this.getViewportTransform(),f=l(o,n),a=l(f,s),a=l(a,[1/o[0],0,0,1/o[3],0,0]),d=this._calculateCurrentDimensions(),p={};return this.forEachControl(function(v,b,C){p[b]=v.positionHandler(d,a,C)}),p},calcACoords:function(){var s=this._calcRotateMatrix(),n=this._calcTranslateMatrix(),o=l(n,s),f=this._getTransformedDimensions(),a=f.x/2,d=f.y/2;return{tl:i({x:-a,y:-d},o),tr:i({x:a,y:-d},o),bl:i({x:-a,y:d},o),br:i({x:a,y:d},o)}},setCoords:function(s){return this.aCoords=this.calcACoords(),this.lineCoords=this.group?this.aCoords:this.calcLineCoords(),s?this:(this.oCoords=this.calcOCoords(),this._setCornerCoords&&this._setCornerCoords(),this)},_calcRotateMatrix:function(){return t.calcRotateMatrix(this)},_calcTranslateMatrix:function(){var s=this.getCenterPoint();return[1,0,0,1,s.x,s.y]},transformMatrixKey:function(s){var n="_",o="";return!s&&this.group&&(o=this.group.transformMatrixKey(s)+n),o+this.top+n+this.left+n+this.scaleX+n+this.scaleY+n+this.skewX+n+this.skewY+n+this.angle+n+this.originX+n+this.originY+n+this.width+n+this.height+n+this.strokeWidth+this.flipX+this.flipY},calcTransformMatrix:function(s){var n=this.calcOwnMatrix();if(s||!this.group)return n;var o=this.transformMatrixKey(s),f=this.matrixCache||(this.matrixCache={});return f.key===o?f.value:(this.group&&(n=l(this.group.calcTransformMatrix(!1),n)),f.key=o,f.value=n,n)},calcOwnMatrix:function(){var s=this.transformMatrixKey(!0),n=this.ownMatrixCache||(this.ownMatrixCache={});if(n.key===s)return n.value;var o=this._calcTranslateMatrix(),f={angle:this.angle,translateX:o[4],translateY:o[5],scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY};return n.key=s,n.value=t.composeMatrix(f),n.value},_getNonTransformedDimensions:function(){var s=this.strokeWidth,n=this.width+s,o=this.height+s;return{x:n,y:o}},_getTransformedDimensions:function(s,n){typeof s>"u"&&(s=this.skewX),typeof n>"u"&&(n=this.skewY);var o,f,a,d=s===0&&n===0;if(this.strokeUniform?(f=this.width,a=this.height):(o=this._getNonTransformedDimensions(),f=o.x,a=o.y),d)return this._finalizeDimensions(f*this.scaleX,a*this.scaleY);var p=t.sizeAfterTransform(f,a,{scaleX:this.scaleX,scaleY:this.scaleY,skewX:s,skewY:n});return this._finalizeDimensions(p.x,p.y)},_finalizeDimensions:function(s,n){return this.strokeUniform?{x:s+this.strokeWidth,y:n+this.strokeWidth}:{x:s,y:n}},_calculateCurrentDimensions:function(){var s=this.getViewportTransform(),n=this._getTransformedDimensions(),o=i(n,s,!0);return o.scalarAdd(2*this.padding)}})}(),e.util.object.extend(e.Object.prototype,{sendToBack:function(){return this.group?e.StaticCanvas.prototype.sendToBack.call(this.group,this):this.canvas&&this.canvas.sendToBack(this),this},bringToFront:function(){return this.group?e.StaticCanvas.prototype.bringToFront.call(this.group,this):this.canvas&&this.canvas.bringToFront(this),this},sendBackwards:function(h){return this.group?e.StaticCanvas.prototype.sendBackwards.call(this.group,this,h):this.canvas&&this.canvas.sendBackwards(this,h),this},bringForward:function(h){return this.group?e.StaticCanvas.prototype.bringForward.call(this.group,this,h):this.canvas&&this.canvas.bringForward(this,h),this},moveTo:function(h){return this.group&&this.group.type!=="activeSelection"?e.StaticCanvas.prototype.moveTo.call(this.group,this,h):this.canvas&&this.canvas.moveTo(this,h),this}}),function(){function h(c,l){if(l){if(l.toLive)return c+": url(#SVGID_"+l.id+"); ";var i=new e.Color(l),s=c+": "+i.toRgb()+"; ",n=i.getAlpha();return n!==1&&(s+=c+"-opacity: "+n.toString()+"; "),s}else return c+": none; "}var t=e.util.toFixed;e.util.object.extend(e.Object.prototype,{getSvgStyles:function(c){var l=this.fillRule?this.fillRule:"nonzero",i=this.strokeWidth?this.strokeWidth:"0",s=this.strokeDashArray?this.strokeDashArray.join(" "):"none",n=this.strokeDashOffset?this.strokeDashOffset:"0",o=this.strokeLineCap?this.strokeLineCap:"butt",f=this.strokeLineJoin?this.strokeLineJoin:"miter",a=this.strokeMiterLimit?this.strokeMiterLimit:"4",d=typeof this.opacity<"u"?this.opacity:"1",p=this.visible?"":" visibility: hidden;",v=c?"":this.getSvgFilter(),b=h("fill",this.fill),C=h("stroke",this.stroke);return[C,"stroke-width: ",i,"; ","stroke-dasharray: ",s,"; ","stroke-linecap: ",o,"; ","stroke-dashoffset: ",n,"; ","stroke-linejoin: ",f,"; ","stroke-miterlimit: ",a,"; ",b,"fill-rule: ",l,"; ","opacity: ",d,";",v,p].join("")},getSvgSpanStyles:function(c,l){var i="; ",n=c.fontFamily?"font-family: "+(c.fontFamily.indexOf("'")===-1&&c.fontFamily.indexOf('"')===-1?"'"+c.fontFamily+"'":c.fontFamily)+i:"",s=c.strokeWidth?"stroke-width: "+c.strokeWidth+i:"",n=n,o=c.fontSize?"font-size: "+c.fontSize+"px"+i:"",f=c.fontStyle?"font-style: "+c.fontStyle+i:"",a=c.fontWeight?"font-weight: "+c.fontWeight+i:"",d=c.fill?h("fill",c.fill):"",p=c.stroke?h("stroke",c.stroke):"",v=this.getSvgTextDecoration(c),b=c.deltaY?"baseline-shift: "+-c.deltaY+"; ":"";return v&&(v="text-decoration: "+v+i),[p,s,n,o,f,a,v,d,b,l?"white-space: pre; ":""].join("")},getSvgTextDecoration:function(c){return["overline","underline","line-through"].filter(function(l){return c[l.replace("-","")]}).join(" ")},getSvgFilter:function(){return this.shadow?"filter: url(#SVGID_"+this.shadow.id+");":""},getSvgCommons:function(){return[this.id?'id="'+this.id+'" ':"",this.clipPath?'clip-path="url(#'+this.clipPath.clipPathId+')" ':""].join("")},getSvgTransform:function(c,l){var i=c?this.calcTransformMatrix():this.calcOwnMatrix(),s='transform="'+e.util.matrixToSVG(i);return s+(l||"")+'" '},_setSVGBg:function(c){if(this.backgroundColor){var l=e.Object.NUM_FRACTION_DIGITS;c.push("		<rect ",this._getFillAttributes(this.backgroundColor),' x="',t(-this.width/2,l),'" y="',t(-this.height/2,l),'" width="',t(this.width,l),'" height="',t(this.height,l),`"></rect>
`)}},toSVG:function(c){return this._createBaseSVGMarkup(this._toSVG(c),{reviver:c})},toClipPathSVG:function(c){return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(c),{reviver:c})},_createBaseClipPathSVGMarkup:function(c,l){l=l||{};var i=l.reviver,s=l.additionalTransform||"",n=[this.getSvgTransform(!0,s),this.getSvgCommons()].join(""),o=c.indexOf("COMMON_PARTS");return c[o]=n,i?i(c.join("")):c.join("")},_createBaseSVGMarkup:function(c,l){l=l||{};var i=l.noStyle,s=l.reviver,n=i?"":'style="'+this.getSvgStyles()+'" ',o=l.withShadow?'style="'+this.getSvgFilter()+'" ':"",f=this.clipPath,a=this.strokeUniform?'vector-effect="non-scaling-stroke" ':"",d=f&&f.absolutePositioned,p=this.stroke,v=this.fill,b=this.shadow,C,w=[],S,E=c.indexOf("COMMON_PARTS"),P=l.additionalTransform;return f&&(f.clipPathId="CLIPPATH_"+e.Object.__uid++,S='<clipPath id="'+f.clipPathId+`" >
`+f.toClipPathSVG(s)+`</clipPath>
`),d&&w.push("<g ",o,this.getSvgCommons(),` >
`),w.push("<g ",this.getSvgTransform(!1),d?"":o+this.getSvgCommons(),` >
`),C=[n,a,i?"":this.addPaintOrder()," ",P?'transform="'+P+'" ':""].join(""),c[E]=C,v&&v.toLive&&w.push(v.toSVG(this)),p&&p.toLive&&w.push(p.toSVG(this)),b&&w.push(b.toSVG(this)),f&&w.push(S),w.push(c.join("")),w.push(`</g>
`),d&&w.push(`</g>
`),s?s(w.join("")):w.join("")},addPaintOrder:function(){return this.paintFirst!=="fill"?' paint-order="'+this.paintFirst+'" ':""}})}(),function(){var h=e.util.object.extend,t="stateProperties";function c(i,s,n){var o={},f=!0;n.forEach(function(a){o[a]=i[a]}),h(i[s],o,f)}function l(i,s,n){if(i===s)return!0;if(Array.isArray(i)){if(!Array.isArray(s)||i.length!==s.length)return!1;for(var o=0,f=i.length;o<f;o++)if(!l(i[o],s[o]))return!1;return!0}else if(i&&typeof i=="object"){var a=Object.keys(i),d;if(!s||typeof s!="object"||!n&&a.length!==Object.keys(s).length)return!1;for(var o=0,f=a.length;o<f;o++)if(d=a[o],!(d==="canvas"||d==="group")&&!l(i[d],s[d]))return!1;return!0}}e.util.object.extend(e.Object.prototype,{hasStateChanged:function(i){i=i||t;var s="_"+i;return Object.keys(this[s]).length<this[i].length?!0:!l(this[s],this,!0)},saveState:function(i){var s=i&&i.propertySet||t,n="_"+s;return this[n]?(c(this,n,this[s]),i&&i.stateProperties&&c(this,n,i.stateProperties),this):this.setupState(i)},setupState:function(i){i=i||{};var s=i.propertySet||t;return i.propertySet=s,this["_"+s]={},this.saveState(i),this}})}(),function(){var h=e.util.degreesToRadians;e.util.object.extend(e.Object.prototype,{_findTargetCorner:function(t,c){if(!this.hasControls||this.group||!this.canvas||this.canvas._activeObject!==this)return!1;var l=t.x,i=t.y,s,n,o=Object.keys(this.oCoords),f=o.length-1,a;for(this.__corner=0;f>=0;f--)if(a=o[f],!!this.isControlVisible(a)&&(n=this._getImageLines(c?this.oCoords[a].touchCorner:this.oCoords[a].corner),s=this._findCrossPoints({x:l,y:i},n),s!==0&&s%2===1))return this.__corner=a,a;return!1},forEachControl:function(t){for(var c in this.controls)t(this.controls[c],c,this)},_setCornerCoords:function(){var t=this.oCoords;for(var c in t){var l=this.controls[c];t[c].corner=l.calcCornerCoords(this.angle,this.cornerSize,t[c].x,t[c].y,!1),t[c].touchCorner=l.calcCornerCoords(this.angle,this.touchCornerSize,t[c].x,t[c].y,!0)}},drawSelectionBackground:function(t){if(!this.selectionBackgroundColor||this.canvas&&!this.canvas.interactive||this.canvas&&this.canvas._activeObject!==this)return this;t.save();var c=this.getCenterPoint(),l=this._calculateCurrentDimensions(),i=this.canvas.viewportTransform;return t.translate(c.x,c.y),t.scale(1/i[0],1/i[3]),t.rotate(h(this.angle)),t.fillStyle=this.selectionBackgroundColor,t.fillRect(-l.x/2,-l.y/2,l.x,l.y),t.restore(),this},drawBorders:function(t,c){c=c||{};var l=this._calculateCurrentDimensions(),i=this.borderScaleFactor,s=l.x+i,n=l.y+i,o=typeof c.hasControls<"u"?c.hasControls:this.hasControls,f=!1;return t.save(),t.strokeStyle=c.borderColor||this.borderColor,this._setLineDash(t,c.borderDashArray||this.borderDashArray),t.strokeRect(-s/2,-n/2,s,n),o&&(t.beginPath(),this.forEachControl(function(a,d,p){a.withConnection&&a.getVisibility(p,d)&&(f=!0,t.moveTo(a.x*s,a.y*n),t.lineTo(a.x*s+a.offsetX,a.y*n+a.offsetY))}),f&&t.stroke()),t.restore(),this},drawBordersInGroup:function(t,c,l){l=l||{};var i=e.util.sizeAfterTransform(this.width,this.height,c),s=this.strokeWidth,n=this.strokeUniform,o=this.borderScaleFactor,f=i.x+s*(n?this.canvas.getZoom():c.scaleX)+o,a=i.y+s*(n?this.canvas.getZoom():c.scaleY)+o;return t.save(),this._setLineDash(t,l.borderDashArray||this.borderDashArray),t.strokeStyle=l.borderColor||this.borderColor,t.strokeRect(-f/2,-a/2,f,a),t.restore(),this},drawControls:function(t,c){c=c||{},t.save();var l=this.canvas.getRetinaScaling(),i,s;return t.setTransform(l,0,0,l,0,0),t.strokeStyle=t.fillStyle=c.cornerColor||this.cornerColor,this.transparentCorners||(t.strokeStyle=c.cornerStrokeColor||this.cornerStrokeColor),this._setLineDash(t,c.cornerDashArray||this.cornerDashArray),this.setCoords(),this.group&&(i=this.group.calcTransformMatrix()),this.forEachControl(function(n,o,f){s=f.oCoords[o],n.getVisibility(f,o)&&(i&&(s=e.util.transformPoint(s,i)),n.render(t,s.x,s.y,c,f))}),t.restore(),this},isControlVisible:function(t){return this.controls[t]&&this.controls[t].getVisibility(this,t)},setControlVisible:function(t,c){return this._controlsVisibility||(this._controlsVisibility={}),this._controlsVisibility[t]=c,this},setControlsVisibility:function(t){t||(t={});for(var c in t)this.setControlVisible(c,t[c]);return this},onDeselect:function(){},onSelect:function(){}})}(),e.util.object.extend(e.StaticCanvas.prototype,{FX_DURATION:500,fxCenterObjectH:function(h,t){t=t||{};var c=function(){},l=t.onComplete||c,i=t.onChange||c,s=this;return e.util.animate({target:this,startValue:h.left,endValue:this.getCenterPoint().x,duration:this.FX_DURATION,onChange:function(n){h.set("left",n),s.requestRenderAll(),i()},onComplete:function(){h.setCoords(),l()}})},fxCenterObjectV:function(h,t){t=t||{};var c=function(){},l=t.onComplete||c,i=t.onChange||c,s=this;return e.util.animate({target:this,startValue:h.top,endValue:this.getCenterPoint().y,duration:this.FX_DURATION,onChange:function(n){h.set("top",n),s.requestRenderAll(),i()},onComplete:function(){h.setCoords(),l()}})},fxRemove:function(h,t){t=t||{};var c=function(){},l=t.onComplete||c,i=t.onChange||c,s=this;return e.util.animate({target:this,startValue:h.opacity,endValue:0,duration:this.FX_DURATION,onChange:function(n){h.set("opacity",n),s.requestRenderAll(),i()},onComplete:function(){s.remove(h),l()}})}}),e.util.object.extend(e.Object.prototype,{animate:function(){if(arguments[0]&&typeof arguments[0]=="object"){var h=[],t,c,l=[];for(t in arguments[0])h.push(t);for(var i=0,s=h.length;i<s;i++)t=h[i],c=i!==s-1,l.push(this._animate(t,arguments[0][t],arguments[1],c));return l}else return this._animate.apply(this,arguments)},_animate:function(h,t,c,l){var i=this,s;t=t.toString(),c?c=e.util.object.clone(c):c={},~h.indexOf(".")&&(s=h.split("."));var n=i.colorProperties.indexOf(h)>-1||s&&i.colorProperties.indexOf(s[1])>-1,o=s?this.get(s[0])[s[1]]:this.get(h);"from"in c||(c.from=o),n||(~t.indexOf("=")?t=o+parseFloat(t.replace("=","")):t=parseFloat(t));var f={target:this,startValue:c.from,endValue:t,byValue:c.by,easing:c.easing,duration:c.duration,abort:c.abort&&function(a,d,p){return c.abort.call(i,a,d,p)},onChange:function(a,d,p){s?i[s[0]][s[1]]=a:i.set(h,a),!l&&c.onChange&&c.onChange(a,d,p)},onComplete:function(a,d,p){l||(i.setCoords(),c.onComplete&&c.onComplete(a,d,p))}};return n?e.util.animateColor(f.startValue,f.endValue,f.duration,f):e.util.animate(f)}}),function(h){var t=h.fabric||(h.fabric={}),c=t.util.object.extend,l=t.util.object.clone,i={x1:1,x2:1,y1:1,y2:1};if(t.Line){t.warn("fabric.Line is already defined");return}t.Line=t.util.createClass(t.Object,{type:"line",x1:0,y1:0,x2:0,y2:0,cacheProperties:t.Object.prototype.cacheProperties.concat("x1","x2","y1","y2"),initialize:function(n,o){n||(n=[0,0,0,0]),this.callSuper("initialize",o),this.set("x1",n[0]),this.set("y1",n[1]),this.set("x2",n[2]),this.set("y2",n[3]),this._setWidthHeight(o)},_setWidthHeight:function(n){n||(n={}),this.width=Math.abs(this.x2-this.x1),this.height=Math.abs(this.y2-this.y1),this.left="left"in n?n.left:this._getLeftToOriginX(),this.top="top"in n?n.top:this._getTopToOriginY()},_set:function(n,o){return this.callSuper("_set",n,o),typeof i[n]<"u"&&this._setWidthHeight(),this},_getLeftToOriginX:s({origin:"originX",axis1:"x1",axis2:"x2",dimension:"width"},{nearest:"left",center:"center",farthest:"right"}),_getTopToOriginY:s({origin:"originY",axis1:"y1",axis2:"y2",dimension:"height"},{nearest:"top",center:"center",farthest:"bottom"}),_render:function(n){n.beginPath();var o=this.calcLinePoints();n.moveTo(o.x1,o.y1),n.lineTo(o.x2,o.y2),n.lineWidth=this.strokeWidth;var f=n.strokeStyle;n.strokeStyle=this.stroke||n.fillStyle,this.stroke&&this._renderStroke(n),n.strokeStyle=f},_findCenterFromElement:function(){return{x:(this.x1+this.x2)/2,y:(this.y1+this.y2)/2}},toObject:function(n){return c(this.callSuper("toObject",n),this.calcLinePoints())},_getNonTransformedDimensions:function(){var n=this.callSuper("_getNonTransformedDimensions");return this.strokeLineCap==="butt"&&(this.width===0&&(n.y-=this.strokeWidth),this.height===0&&(n.x-=this.strokeWidth)),n},calcLinePoints:function(){var n=this.x1<=this.x2?-1:1,o=this.y1<=this.y2?-1:1,f=n*this.width*.5,a=o*this.height*.5,d=n*this.width*-.5,p=o*this.height*-.5;return{x1:f,x2:d,y1:a,y2:p}},_toSVG:function(){var n=this.calcLinePoints();return["<line ","COMMON_PARTS",'x1="',n.x1,'" y1="',n.y1,'" x2="',n.x2,'" y2="',n.y2,`" />
`]}}),t.Line.ATTRIBUTE_NAMES=t.SHARED_ATTRIBUTES.concat("x1 y1 x2 y2".split(" ")),t.Line.fromElement=function(n,o,f){f=f||{};var a=t.parseAttributes(n,t.Line.ATTRIBUTE_NAMES),d=[a.x1||0,a.y1||0,a.x2||0,a.y2||0];o(new t.Line(d,c(a,f)))},t.Line.fromObject=function(n,o){function f(d){delete d.points,o&&o(d)}var a=l(n,!0);a.points=[n.x1,n.y1,n.x2,n.y2],t.Object._fromObject("Line",a,f,"points")};function s(n,o){var f=n.origin,a=n.axis1,d=n.axis2,p=n.dimension,v=o.nearest,b=o.center,C=o.farthest;return function(){switch(this.get(f)){case v:return Math.min(this.get(a),this.get(d));case b:return Math.min(this.get(a),this.get(d))+.5*this.get(p);case C:return Math.max(this.get(a),this.get(d))}}}}(r),function(h){var t=h.fabric||(h.fabric={}),c=t.util.degreesToRadians;if(t.Circle){t.warn("fabric.Circle is already defined.");return}t.Circle=t.util.createClass(t.Object,{type:"circle",radius:0,startAngle:0,endAngle:360,cacheProperties:t.Object.prototype.cacheProperties.concat("radius","startAngle","endAngle"),_set:function(i,s){return this.callSuper("_set",i,s),i==="radius"&&this.setRadius(s),this},toObject:function(i){return this.callSuper("toObject",["radius","startAngle","endAngle"].concat(i))},_toSVG:function(){var i,s=0,n=0,o=(this.endAngle-this.startAngle)%360;if(o===0)i=["<circle ","COMMON_PARTS",'cx="'+s+'" cy="'+n+'" ','r="',this.radius,`" />
`];else{var f=c(this.startAngle),a=c(this.endAngle),d=this.radius,p=t.util.cos(f)*d,v=t.util.sin(f)*d,b=t.util.cos(a)*d,C=t.util.sin(a)*d,w=o>180?"1":"0";i=['<path d="M '+p+" "+v," A "+d+" "+d," 0 ",+w+" 1"," "+b+" "+C,'" ',"COMMON_PARTS",` />
`]}return i},_render:function(i){i.beginPath(),i.arc(0,0,this.radius,c(this.startAngle),c(this.endAngle),!1),this._renderPaintInOrder(i)},getRadiusX:function(){return this.get("radius")*this.get("scaleX")},getRadiusY:function(){return this.get("radius")*this.get("scaleY")},setRadius:function(i){return this.radius=i,this.set("width",i*2).set("height",i*2)}}),t.Circle.ATTRIBUTE_NAMES=t.SHARED_ATTRIBUTES.concat("cx cy r".split(" ")),t.Circle.fromElement=function(i,s){var n=t.parseAttributes(i,t.Circle.ATTRIBUTE_NAMES);if(!l(n))throw new Error("value of `r` attribute is required and can not be negative");n.left=(n.left||0)-n.radius,n.top=(n.top||0)-n.radius,s(new t.Circle(n))};function l(i){return"radius"in i&&i.radius>=0}t.Circle.fromObject=function(i,s){t.Object._fromObject("Circle",i,s)}}(r),function(h){var t=h.fabric||(h.fabric={});if(t.Triangle){t.warn("fabric.Triangle is already defined");return}t.Triangle=t.util.createClass(t.Object,{type:"triangle",width:100,height:100,_render:function(c){var l=this.width/2,i=this.height/2;c.beginPath(),c.moveTo(-l,i),c.lineTo(0,-i),c.lineTo(l,i),c.closePath(),this._renderPaintInOrder(c)},_toSVG:function(){var c=this.width/2,l=this.height/2,i=[-c+" "+l,"0 "+-l,c+" "+l].join(",");return["<polygon ","COMMON_PARTS",'points="',i,'" />']}}),t.Triangle.fromObject=function(c,l){return t.Object._fromObject("Triangle",c,l)}}(r),function(h){var t=h.fabric||(h.fabric={}),c=Math.PI*2;if(t.Ellipse){t.warn("fabric.Ellipse is already defined.");return}t.Ellipse=t.util.createClass(t.Object,{type:"ellipse",rx:0,ry:0,cacheProperties:t.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(l){this.callSuper("initialize",l),this.set("rx",l&&l.rx||0),this.set("ry",l&&l.ry||0)},_set:function(l,i){switch(this.callSuper("_set",l,i),l){case"rx":this.rx=i,this.set("width",i*2);break;case"ry":this.ry=i,this.set("height",i*2);break}return this},getRx:function(){return this.get("rx")*this.get("scaleX")},getRy:function(){return this.get("ry")*this.get("scaleY")},toObject:function(l){return this.callSuper("toObject",["rx","ry"].concat(l))},_toSVG:function(){return["<ellipse ","COMMON_PARTS",'cx="0" cy="0" ','rx="',this.rx,'" ry="',this.ry,`" />
`]},_render:function(l){l.beginPath(),l.save(),l.transform(1,0,0,this.ry/this.rx,0,0),l.arc(0,0,this.rx,0,c,!1),l.restore(),this._renderPaintInOrder(l)}}),t.Ellipse.ATTRIBUTE_NAMES=t.SHARED_ATTRIBUTES.concat("cx cy rx ry".split(" ")),t.Ellipse.fromElement=function(l,i){var s=t.parseAttributes(l,t.Ellipse.ATTRIBUTE_NAMES);s.left=(s.left||0)-s.rx,s.top=(s.top||0)-s.ry,i(new t.Ellipse(s))},t.Ellipse.fromObject=function(l,i){t.Object._fromObject("Ellipse",l,i)}}(r),function(h){var t=h.fabric||(h.fabric={}),c=t.util.object.extend;if(t.Rect){t.warn("fabric.Rect is already defined");return}t.Rect=t.util.createClass(t.Object,{stateProperties:t.Object.prototype.stateProperties.concat("rx","ry"),type:"rect",rx:0,ry:0,cacheProperties:t.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(l){this.callSuper("initialize",l),this._initRxRy()},_initRxRy:function(){this.rx&&!this.ry?this.ry=this.rx:this.ry&&!this.rx&&(this.rx=this.ry)},_render:function(l){var i=this.rx?Math.min(this.rx,this.width/2):0,s=this.ry?Math.min(this.ry,this.height/2):0,n=this.width,o=this.height,f=-this.width/2,a=-this.height/2,d=i!==0||s!==0,p=1-.5522847498;l.beginPath(),l.moveTo(f+i,a),l.lineTo(f+n-i,a),d&&l.bezierCurveTo(f+n-p*i,a,f+n,a+p*s,f+n,a+s),l.lineTo(f+n,a+o-s),d&&l.bezierCurveTo(f+n,a+o-p*s,f+n-p*i,a+o,f+n-i,a+o),l.lineTo(f+i,a+o),d&&l.bezierCurveTo(f+p*i,a+o,f,a+o-p*s,f,a+o-s),l.lineTo(f,a+s),d&&l.bezierCurveTo(f,a+p*s,f+p*i,a,f+i,a),l.closePath(),this._renderPaintInOrder(l)},toObject:function(l){return this.callSuper("toObject",["rx","ry"].concat(l))},_toSVG:function(){var l=-this.width/2,i=-this.height/2;return["<rect ","COMMON_PARTS",'x="',l,'" y="',i,'" rx="',this.rx,'" ry="',this.ry,'" width="',this.width,'" height="',this.height,`" />
`]}}),t.Rect.ATTRIBUTE_NAMES=t.SHARED_ATTRIBUTES.concat("x y rx ry width height".split(" ")),t.Rect.fromElement=function(l,i,s){if(!l)return i(null);s=s||{};var n=t.parseAttributes(l,t.Rect.ATTRIBUTE_NAMES);n.left=n.left||0,n.top=n.top||0,n.height=n.height||0,n.width=n.width||0;var o=new t.Rect(c(s?t.util.object.clone(s):{},n));o.visible=o.visible&&o.width>0&&o.height>0,i(o)},t.Rect.fromObject=function(l,i){return t.Object._fromObject("Rect",l,i)}}(r),function(h){var t=h.fabric||(h.fabric={}),c=t.util.object.extend,l=t.util.array.min,i=t.util.array.max,s=t.util.toFixed,n=t.util.projectStrokeOnPoints;if(t.Polyline){t.warn("fabric.Polyline is already defined");return}t.Polyline=t.util.createClass(t.Object,{type:"polyline",points:null,exactBoundingBox:!1,cacheProperties:t.Object.prototype.cacheProperties.concat("points"),initialize:function(o,f){f=f||{},this.points=o||[],this.callSuper("initialize",f),this._setPositionDimensions(f)},_projectStrokeOnPoints:function(){return n(this.points,this,!0)},_setPositionDimensions:function(o){var f=this._calcDimensions(o),a,d=this.exactBoundingBox?this.strokeWidth:0;this.width=f.width-d,this.height=f.height-d,o.fromSVG||(a=this.translateToGivenOrigin({x:f.left-this.strokeWidth/2+d/2,y:f.top-this.strokeWidth/2+d/2},"left","top",this.originX,this.originY)),typeof o.left>"u"&&(this.left=o.fromSVG?f.left:a.x),typeof o.top>"u"&&(this.top=o.fromSVG?f.top:a.y),this.pathOffset={x:f.left+this.width/2+d/2,y:f.top+this.height/2+d/2}},_calcDimensions:function(){var o=this.exactBoundingBox?this._projectStrokeOnPoints():this.points,f=l(o,"x")||0,a=l(o,"y")||0,d=i(o,"x")||0,p=i(o,"y")||0,v=d-f,b=p-a;return{left:f,top:a,width:v,height:b}},toObject:function(o){return c(this.callSuper("toObject",o),{points:this.points.concat()})},_toSVG:function(){for(var o=[],f=this.pathOffset.x,a=this.pathOffset.y,d=t.Object.NUM_FRACTION_DIGITS,p=0,v=this.points.length;p<v;p++)o.push(s(this.points[p].x-f,d),",",s(this.points[p].y-a,d)," ");return["<"+this.type+" ","COMMON_PARTS",'points="',o.join(""),`" />
`]},commonRender:function(o){var f,a=this.points.length,d=this.pathOffset.x,p=this.pathOffset.y;if(!a||isNaN(this.points[a-1].y))return!1;o.beginPath(),o.moveTo(this.points[0].x-d,this.points[0].y-p);for(var v=0;v<a;v++)f=this.points[v],o.lineTo(f.x-d,f.y-p);return!0},_render:function(o){this.commonRender(o)&&this._renderPaintInOrder(o)},complexity:function(){return this.get("points").length}}),t.Polyline.ATTRIBUTE_NAMES=t.SHARED_ATTRIBUTES.concat(),t.Polyline.fromElementGenerator=function(o){return function(f,a,d){if(!f)return a(null);d||(d={});var p=t.parsePointsAttribute(f.getAttribute("points")),v=t.parseAttributes(f,t[o].ATTRIBUTE_NAMES);v.fromSVG=!0,a(new t[o](p,c(v,d)))}},t.Polyline.fromElement=t.Polyline.fromElementGenerator("Polyline"),t.Polyline.fromObject=function(o,f){return t.Object._fromObject("Polyline",o,f,"points")}}(r),function(h){var t=h.fabric||(h.fabric={}),c=t.util.projectStrokeOnPoints;if(t.Polygon){t.warn("fabric.Polygon is already defined");return}t.Polygon=t.util.createClass(t.Polyline,{type:"polygon",_projectStrokeOnPoints:function(){return c(this.points,this)},_render:function(l){this.commonRender(l)&&(l.closePath(),this._renderPaintInOrder(l))}}),t.Polygon.ATTRIBUTE_NAMES=t.SHARED_ATTRIBUTES.concat(),t.Polygon.fromElement=t.Polyline.fromElementGenerator("Polygon"),t.Polygon.fromObject=function(l,i){t.Object._fromObject("Polygon",l,i,"points")}}(r),function(h){var t=h.fabric||(h.fabric={}),c=t.util.array.min,l=t.util.array.max,i=t.util.object.extend,s=t.util.object.clone,n=t.util.toFixed;if(t.Path){t.warn("fabric.Path is already defined");return}t.Path=t.util.createClass(t.Object,{type:"path",path:null,cacheProperties:t.Object.prototype.cacheProperties.concat("path","fillRule"),stateProperties:t.Object.prototype.stateProperties.concat("path"),initialize:function(o,f){f=s(f||{}),delete f.path,this.callSuper("initialize",f),this._setPath(o||[],f)},_setPath:function(o,f){this.path=t.util.makePathSimpler(Array.isArray(o)?o:t.util.parsePath(o)),t.Polyline.prototype._setPositionDimensions.call(this,f||{})},_renderPathCommands:function(o){var f,a=0,d=0,p=0,v=0,b=0,C=0,w=-this.pathOffset.x,S=-this.pathOffset.y;o.beginPath();for(var E=0,P=this.path.length;E<P;++E)switch(f=this.path[E],f[0]){case"L":p=f[1],v=f[2],o.lineTo(p+w,v+S);break;case"M":p=f[1],v=f[2],a=p,d=v,o.moveTo(p+w,v+S);break;case"C":p=f[5],v=f[6],b=f[3],C=f[4],o.bezierCurveTo(f[1]+w,f[2]+S,b+w,C+S,p+w,v+S);break;case"Q":o.quadraticCurveTo(f[1]+w,f[2]+S,f[3]+w,f[4]+S),p=f[3],v=f[4],b=f[1],C=f[2];break;case"z":case"Z":p=a,v=d,o.closePath();break}},_render:function(o){this._renderPathCommands(o),this._renderPaintInOrder(o)},toString:function(){return"#<fabric.Path ("+this.complexity()+'): { "top": '+this.top+', "left": '+this.left+" }>"},toObject:function(o){return i(this.callSuper("toObject",o),{path:this.path.map(function(f){return f.slice()})})},toDatalessObject:function(o){var f=this.toObject(["sourcePath"].concat(o));return f.sourcePath&&delete f.path,f},_toSVG:function(){var o=t.util.joinPath(this.path);return["<path ","COMMON_PARTS",'d="',o,'" stroke-linecap="round" ',`/>
`]},_getOffsetTransform:function(){var o=t.Object.NUM_FRACTION_DIGITS;return" translate("+n(-this.pathOffset.x,o)+", "+n(-this.pathOffset.y,o)+")"},toClipPathSVG:function(o){var f=this._getOffsetTransform();return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(),{reviver:o,additionalTransform:f})},toSVG:function(o){var f=this._getOffsetTransform();return this._createBaseSVGMarkup(this._toSVG(),{reviver:o,additionalTransform:f})},complexity:function(){return this.path.length},_calcDimensions:function(){for(var o=[],f=[],a,d=0,p=0,v=0,b=0,C,w=0,S=this.path.length;w<S;++w){switch(a=this.path[w],a[0]){case"L":v=a[1],b=a[2],C=[];break;case"M":v=a[1],b=a[2],d=v,p=b,C=[];break;case"C":C=t.util.getBoundsOfCurve(v,b,a[1],a[2],a[3],a[4],a[5],a[6]),v=a[5],b=a[6];break;case"Q":C=t.util.getBoundsOfCurve(v,b,a[1],a[2],a[1],a[2],a[3],a[4]),v=a[3],b=a[4];break;case"z":case"Z":v=d,b=p;break}C.forEach(function(U){o.push(U.x),f.push(U.y)}),o.push(v),f.push(b)}var E=c(o)||0,P=c(f)||0,N=l(o)||0,K=l(f)||0,Z=N-E,W=K-P;return{left:E,top:P,width:Z,height:W}}}),t.Path.fromObject=function(o,f){if(typeof o.sourcePath=="string"){var a=o.sourcePath;t.loadSVGFromURL(a,function(d){var p=d[0];p.setOptions(o),o.clipPath?t.util.enlivenObjects([o.clipPath],function(v){p.clipPath=v[0],f&&f(p)}):f&&f(p)})}else t.Object._fromObject("Path",o,f,"path")},t.Path.ATTRIBUTE_NAMES=t.SHARED_ATTRIBUTES.concat(["d"]),t.Path.fromElement=function(o,f,a){var d=t.parseAttributes(o,t.Path.ATTRIBUTE_NAMES);d.fromSVG=!0,f(new t.Path(d.d,i(d,a)))}}(r),function(h){var t=h.fabric||(h.fabric={}),c=t.util.array.min,l=t.util.array.max;t.Group||(t.Group=t.util.createClass(t.Object,t.Collection,{type:"group",strokeWidth:0,subTargetCheck:!1,cacheProperties:[],useSetOnGroup:!1,initialize:function(i,s,n){s=s||{},this._objects=[],n&&this.callSuper("initialize",s),this._objects=i||[];for(var o=this._objects.length;o--;)this._objects[o].group=this;if(n)this._updateObjectsACoords();else{var f=s&&s.centerPoint;s.originX!==void 0&&(this.originX=s.originX),s.originY!==void 0&&(this.originY=s.originY),f||this._calcBounds(),this._updateObjectsCoords(f),delete s.centerPoint,this.callSuper("initialize",s)}this.setCoords()},_updateObjectsACoords:function(){for(var i=!0,s=this._objects.length;s--;)this._objects[s].setCoords(i)},_updateObjectsCoords:function(s){for(var s=s||this.getCenterPoint(),n=this._objects.length;n--;)this._updateObjectCoords(this._objects[n],s)},_updateObjectCoords:function(i,s){var n=i.left,o=i.top,f=!0;i.set({left:n-s.x,top:o-s.y}),i.group=this,i.setCoords(f)},toString:function(){return"#<fabric.Group: ("+this.complexity()+")>"},addWithUpdate:function(i){var s=!!this.group;return this._restoreObjectsState(),t.util.resetObjectTransform(this),i&&(s&&t.util.removeTransformFromObject(i,this.group.calcTransformMatrix()),this._objects.push(i),i.group=this,i._set("canvas",this.canvas)),this._calcBounds(),this._updateObjectsCoords(),this.dirty=!0,s?this.group.addWithUpdate():this.setCoords(),this},removeWithUpdate:function(i){return this._restoreObjectsState(),t.util.resetObjectTransform(this),this.remove(i),this._calcBounds(),this._updateObjectsCoords(),this.setCoords(),this.dirty=!0,this},_onObjectAdded:function(i){this.dirty=!0,i.group=this,i._set("canvas",this.canvas)},_onObjectRemoved:function(i){this.dirty=!0,delete i.group},_set:function(i,s){var n=this._objects.length;if(this.useSetOnGroup)for(;n--;)this._objects[n].setOnGroup(i,s);if(i==="canvas")for(;n--;)this._objects[n]._set(i,s);t.Object.prototype._set.call(this,i,s)},toObject:function(i){var s=this.includeDefaultValues,n=this._objects.filter(function(f){return!f.excludeFromExport}).map(function(f){var a=f.includeDefaultValues;f.includeDefaultValues=s;var d=f.toObject(i);return f.includeDefaultValues=a,d}),o=t.Object.prototype.toObject.call(this,i);return o.objects=n,o},toDatalessObject:function(i){var s,n=this.sourcePath;if(n)s=n;else{var o=this.includeDefaultValues;s=this._objects.map(function(a){var d=a.includeDefaultValues;a.includeDefaultValues=o;var p=a.toDatalessObject(i);return a.includeDefaultValues=d,p})}var f=t.Object.prototype.toDatalessObject.call(this,i);return f.objects=s,f},render:function(i){this._transformDone=!0,this.callSuper("render",i),this._transformDone=!1},shouldCache:function(){var i=t.Object.prototype.shouldCache.call(this);if(i){for(var s=0,n=this._objects.length;s<n;s++)if(this._objects[s].willDrawShadow())return this.ownCaching=!1,!1}return i},willDrawShadow:function(){if(t.Object.prototype.willDrawShadow.call(this))return!0;for(var i=0,s=this._objects.length;i<s;i++)if(this._objects[i].willDrawShadow())return!0;return!1},isOnACache:function(){return this.ownCaching||this.group&&this.group.isOnACache()},drawObject:function(i){for(var s=0,n=this._objects.length;s<n;s++)this._objects[s].render(i);this._drawClipPath(i,this.clipPath)},isCacheDirty:function(i){if(this.callSuper("isCacheDirty",i))return!0;if(!this.statefullCache)return!1;for(var s=0,n=this._objects.length;s<n;s++)if(this._objects[s].isCacheDirty(!0)){if(this._cacheCanvas){var o=this.cacheWidth/this.zoomX,f=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-o/2,-f/2,o,f)}return!0}return!1},_restoreObjectsState:function(){var i=this.calcOwnMatrix();return this._objects.forEach(function(s){t.util.addTransformToObject(s,i),delete s.group,s.setCoords()}),this},destroy:function(){return this._objects.forEach(function(i){i.set("dirty",!0)}),this._restoreObjectsState()},dispose:function(){this.callSuper("dispose"),this.forEachObject(function(i){i.dispose&&i.dispose()}),this._objects=[]},toActiveSelection:function(){if(this.canvas){var i=this._objects,s=this.canvas;this._objects=[];var n=this.toObject();delete n.objects;var o=new t.ActiveSelection([]);return o.set(n),o.type="activeSelection",s.remove(this),i.forEach(function(f){f.group=o,f.dirty=!0,s.add(f)}),o.canvas=s,o._objects=i,s._activeObject=o,o.setCoords(),o}},ungroupOnCanvas:function(){return this._restoreObjectsState()},setObjectsCoords:function(){var i=!0;return this.forEachObject(function(s){s.setCoords(i)}),this},_calcBounds:function(i){for(var s=[],n=[],o,f,a,d=["tr","br","bl","tl"],p=0,v=this._objects.length,b,C=d.length;p<v;++p){for(o=this._objects[p],a=o.calcACoords(),b=0;b<C;b++)f=d[b],s.push(a[f].x),n.push(a[f].y);o.aCoords=a}this._getBounds(s,n,i)},_getBounds:function(i,s,n){var o=new t.Point(c(i),c(s)),f=new t.Point(l(i),l(s)),a=o.y||0,d=o.x||0,p=f.x-o.x||0,v=f.y-o.y||0;this.width=p,this.height=v,n||this.setPositionByOrigin({x:d,y:a},"left","top")},_toSVG:function(i){for(var s=["<g ","COMMON_PARTS",` >
`],n=0,o=this._objects.length;n<o;n++)s.push("		",this._objects[n].toSVG(i));return s.push(`</g>
`),s},getSvgStyles:function(){var i=typeof this.opacity<"u"&&this.opacity!==1?"opacity: "+this.opacity+";":"",s=this.visible?"":" visibility: hidden;";return[i,this.getSvgFilter(),s].join("")},toClipPathSVG:function(i){for(var s=[],n=0,o=this._objects.length;n<o;n++)s.push("	",this._objects[n].toClipPathSVG(i));return this._createBaseClipPathSVGMarkup(s,{reviver:i})}}),t.Group.fromObject=function(i,s){var n=i.objects,o=t.util.object.clone(i,!0);if(delete o.objects,typeof n=="string"){t.loadSVGFromURL(n,function(f){var a=t.util.groupSVGElements(f,i,n),d=o.clipPath;delete o.clipPath,a.set(o),d?t.util.enlivenObjects([d],function(p){a.clipPath=p[0],s&&s(a)}):s&&s(a)});return}t.util.enlivenObjects(n,function(f){t.util.enlivenObjectEnlivables(i,o,function(){s&&s(new t.Group(f,o,!0))})})})}(r),function(h){var t=h.fabric||(h.fabric={});t.ActiveSelection||(t.ActiveSelection=t.util.createClass(t.Group,{type:"activeSelection",initialize:function(c,l){l=l||{},this._objects=c||[];for(var i=this._objects.length;i--;)this._objects[i].group=this;l.originX&&(this.originX=l.originX),l.originY&&(this.originY=l.originY),this._calcBounds(),this._updateObjectsCoords(),t.Object.prototype.initialize.call(this,l),this.setCoords()},toGroup:function(){var c=this._objects.concat();this._objects=[];var l=t.Object.prototype.toObject.call(this),i=new t.Group([]);if(delete l.type,i.set(l),c.forEach(function(n){n.canvas.remove(n),n.group=i}),i._objects=c,!this.canvas)return i;var s=this.canvas;return s.add(i),s._activeObject=i,i.setCoords(),i},onDeselect:function(){return this.destroy(),!1},toString:function(){return"#<fabric.ActiveSelection: ("+this.complexity()+")>"},shouldCache:function(){return!1},isOnACache:function(){return!1},_renderControls:function(c,l,i){c.save(),c.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1,this.callSuper("_renderControls",c,l),i=i||{},typeof i.hasControls>"u"&&(i.hasControls=!1),i.forActiveSelection=!0;for(var s=0,n=this._objects.length;s<n;s++)this._objects[s]._renderControls(c,i);c.restore()}}),t.ActiveSelection.fromObject=function(c,l){t.util.enlivenObjects(c.objects,function(i){delete c.objects,l&&l(new t.ActiveSelection(i,c,!0))})})}(r),function(h){var t=e.util.object.extend;if(h.fabric||(h.fabric={}),h.fabric.Image){e.warn("fabric.Image is already defined.");return}e.Image=e.util.createClass(e.Object,{type:"image",strokeWidth:0,srcFromAttribute:!1,_lastScaleX:1,_lastScaleY:1,_filterScalingX:1,_filterScalingY:1,minimumScaleTrigger:.5,stateProperties:e.Object.prototype.stateProperties.concat("cropX","cropY"),cacheProperties:e.Object.prototype.cacheProperties.concat("cropX","cropY"),cacheKey:"",cropX:0,cropY:0,imageSmoothing:!0,initialize:function(c,l){l||(l={}),this.filters=[],this.cacheKey="texture"+e.Object.__uid++,this.callSuper("initialize",l),this._initElement(c,l)},getElement:function(){return this._element||{}},setElement:function(c,l){return this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._element=c,this._originalElement=c,this._initConfig(l),this.filters.length!==0&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters(),this},removeTexture:function(c){var l=e.filterBackend;l&&l.evictCachesForKey&&l.evictCachesForKey(c)},dispose:function(){this.callSuper("dispose"),this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._cacheContext=void 0,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach(function(c){e.util.cleanUpJsdomNode(this[c]),this[c]=void 0}.bind(this))},getCrossOrigin:function(){return this._originalElement&&(this._originalElement.crossOrigin||null)},getOriginalSize:function(){var c=this.getElement();return{width:c.naturalWidth||c.width,height:c.naturalHeight||c.height}},_stroke:function(c){if(!(!this.stroke||this.strokeWidth===0)){var l=this.width/2,i=this.height/2;c.beginPath(),c.moveTo(-l,-i),c.lineTo(l,-i),c.lineTo(l,i),c.lineTo(-l,i),c.lineTo(-l,-i),c.closePath()}},toObject:function(c){var l=[];this.filters.forEach(function(s){s&&l.push(s.toObject())});var i=t(this.callSuper("toObject",["cropX","cropY"].concat(c)),{src:this.getSrc(),crossOrigin:this.getCrossOrigin(),filters:l});return this.resizeFilter&&(i.resizeFilter=this.resizeFilter.toObject()),i},hasCrop:function(){return this.cropX||this.cropY||this.width<this._element.width||this.height<this._element.height},_toSVG:function(){var c=[],l=[],i,s=this._element,n=-this.width/2,o=-this.height/2,f="",a="";if(!s)return[];if(this.hasCrop()){var d=e.Object.__uid++;c.push('<clipPath id="imageCrop_'+d+`">
`,'	<rect x="'+n+'" y="'+o+'" width="'+this.width+'" height="'+this.height+`" />
`,`</clipPath>
`),f=' clip-path="url(#imageCrop_'+d+')" '}if(this.imageSmoothing||(a='" image-rendering="optimizeSpeed'),l.push("	<image ","COMMON_PARTS",'xlink:href="',this.getSvgSrc(!0),'" x="',n-this.cropX,'" y="',o-this.cropY,'" width="',s.width||s.naturalWidth,'" height="',s.height||s.height,a,'"',f,`></image>
`),this.stroke||this.strokeDashArray){var p=this.fill;this.fill=null,i=["	<rect ",'x="',n,'" y="',o,'" width="',this.width,'" height="',this.height,'" style="',this.getSvgStyles(),`"/>
`],this.fill=p}return this.paintFirst!=="fill"?c=c.concat(i,l):c=c.concat(l,i),c},getSrc:function(c){var l=c?this._element:this._originalElement;return l?l.toDataURL?l.toDataURL():this.srcFromAttribute?l.getAttribute("src"):l.src:this.src||""},setSrc:function(c,l,i){return e.util.loadImage(c,function(s,n){this.setElement(s,i),this._setWidthHeight(),l&&l(this,n)},this,i&&i.crossOrigin),this},toString:function(){return'#<fabric.Image: { src: "'+this.getSrc()+'" }>'},applyResizeFilters:function(){var c=this.resizeFilter,l=this.minimumScaleTrigger,i=this.getTotalObjectScaling(),s=i.scaleX,n=i.scaleY,o=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!c||s>l&&n>l){this._element=o,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=s,this._lastScaleY=n;return}e.filterBackend||(e.filterBackend=e.initFilterBackend());var f=e.util.createCanvasElement(),a=this._filteredEl?this.cacheKey+"_filtered":this.cacheKey,d=o.width,p=o.height;f.width=d,f.height=p,this._element=f,this._lastScaleX=c.scaleX=s,this._lastScaleY=c.scaleY=n,e.filterBackend.applyFilters([c],o,d,p,this._element,a),this._filterScalingX=f.width/this._originalElement.width,this._filterScalingY=f.height/this._originalElement.height},applyFilters:function(c){if(c=c||this.filters||[],c=c.filter(function(o){return o&&!o.isNeutralState()}),this.set("dirty",!0),this.removeTexture(this.cacheKey+"_filtered"),c.length===0)return this._element=this._originalElement,this._filteredEl=null,this._filterScalingX=1,this._filterScalingY=1,this;var l=this._originalElement,i=l.naturalWidth||l.width,s=l.naturalHeight||l.height;if(this._element===this._originalElement){var n=e.util.createCanvasElement();n.width=i,n.height=s,this._element=n,this._filteredEl=n}else this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,i,s),this._lastScaleX=1,this._lastScaleY=1;return e.filterBackend||(e.filterBackend=e.initFilterBackend()),e.filterBackend.applyFilters(c,this._originalElement,i,s,this._element,this.cacheKey),(this._originalElement.width!==this._element.width||this._originalElement.height!==this._element.height)&&(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height),this},_render:function(c){e.util.setImageSmoothing(c,this.imageSmoothing),this.isMoving!==!0&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(c),this._renderPaintInOrder(c)},drawCacheOnCanvas:function(c){e.util.setImageSmoothing(c,this.imageSmoothing),e.Object.prototype.drawCacheOnCanvas.call(this,c)},shouldCache:function(){return this.needsItsOwnCache()},_renderFill:function(c){var l=this._element;if(l){var i=this._filterScalingX,s=this._filterScalingY,n=this.width,o=this.height,f=Math.min,a=Math.max,d=a(this.cropX,0),p=a(this.cropY,0),v=l.naturalWidth||l.width,b=l.naturalHeight||l.height,C=d*i,w=p*s,S=f(n*i,v-C),E=f(o*s,b-w),P=-n/2,N=-o/2,K=f(n,v/i-d),Z=f(o,b/s-p);l&&c.drawImage(l,C,w,S,E,P,N,K,Z)}},_needsResize:function(){var c=this.getTotalObjectScaling();return c.scaleX!==this._lastScaleX||c.scaleY!==this._lastScaleY},_resetWidthHeight:function(){this.set(this.getOriginalSize())},_initElement:function(c,l){this.setElement(e.util.getById(c),l),e.util.addClass(this.getElement(),e.Image.CSS_CANVAS)},_initConfig:function(c){c||(c={}),this.setOptions(c),this._setWidthHeight(c)},_initFilters:function(c,l){c&&c.length?e.util.enlivenObjects(c,function(i){l&&l(i)},"fabric.Image.filters"):l&&l()},_setWidthHeight:function(c){c||(c={});var l=this.getElement();this.width=c.width||l.naturalWidth||l.width||0,this.height=c.height||l.naturalHeight||l.height||0},parsePreserveAspectRatioAttribute:function(){var c=e.util.parsePreserveAspectRatioAttribute(this.preserveAspectRatio||""),l=this._element.width,i=this._element.height,s=1,n=1,o=0,f=0,a=0,d=0,p,v=this.width,b=this.height,C={width:v,height:b};return c&&(c.alignX!=="none"||c.alignY!=="none")?(c.meetOrSlice==="meet"&&(s=n=e.util.findScaleToFit(this._element,C),p=(v-l*s)/2,c.alignX==="Min"&&(o=-p),c.alignX==="Max"&&(o=p),p=(b-i*n)/2,c.alignY==="Min"&&(f=-p),c.alignY==="Max"&&(f=p)),c.meetOrSlice==="slice"&&(s=n=e.util.findScaleToCover(this._element,C),p=l-v/s,c.alignX==="Mid"&&(a=p/2),c.alignX==="Max"&&(a=p),p=i-b/n,c.alignY==="Mid"&&(d=p/2),c.alignY==="Max"&&(d=p),l=v/s,i=b/n)):(s=v/l,n=b/i),{width:l,height:i,scaleX:s,scaleY:n,offsetLeft:o,offsetTop:f,cropX:a,cropY:d}}}),e.Image.CSS_CANVAS="canvas-img",e.Image.prototype.getSvgSrc=e.Image.prototype.getSrc,e.Image.fromObject=function(c,l){var i=e.util.object.clone(c);e.util.loadImage(i.src,function(s,n){if(n){l&&l(null,!0);return}e.Image.prototype._initFilters.call(i,i.filters,function(o){i.filters=o||[],e.Image.prototype._initFilters.call(i,[i.resizeFilter],function(f){i.resizeFilter=f[0],e.util.enlivenObjectEnlivables(i,i,function(){var a=new e.Image(s,i);l(a,!1)})})})},null,i.crossOrigin)},e.Image.fromURL=function(c,l,i){e.util.loadImage(c,function(s,n){l&&l(new e.Image(s,i),n)},null,i&&i.crossOrigin)},e.Image.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("x y width height preserveAspectRatio xlink:href crossOrigin image-rendering".split(" ")),e.Image.fromElement=function(c,l,i){var s=e.parseAttributes(c,e.Image.ATTRIBUTE_NAMES);e.Image.fromURL(s["xlink:href"],l,t(i?e.util.object.clone(i):{},s))}}(r),e.util.object.extend(e.Object.prototype,{_getAngleValueForStraighten:function(){var h=this.angle%360;return h>0?Math.round((h-1)/90)*90:Math.round(h/90)*90},straighten:function(){return this.rotate(this._getAngleValueForStraighten())},fxStraighten:function(h){h=h||{};var t=function(){},c=h.onComplete||t,l=h.onChange||t,i=this;return e.util.animate({target:this,startValue:this.get("angle"),endValue:this._getAngleValueForStraighten(),duration:this.FX_DURATION,onChange:function(s){i.rotate(s),l()},onComplete:function(){i.setCoords(),c()}})}}),e.util.object.extend(e.StaticCanvas.prototype,{straightenObject:function(h){return h.straighten(),this.requestRenderAll(),this},fxStraightenObject:function(h){return h.fxStraighten({onChange:this.requestRenderAllBound})}}),function(){function h(c,l){var i="precision "+l+` float;
void main(){}`,s=c.createShader(c.FRAGMENT_SHADER);return c.shaderSource(s,i),c.compileShader(s),!!c.getShaderParameter(s,c.COMPILE_STATUS)}e.isWebglSupported=function(c){if(e.isLikelyNode)return!1;c=c||e.WebglFilterBackend.prototype.tileSize;var l=document.createElement("canvas"),i=l.getContext("webgl")||l.getContext("experimental-webgl"),s=!1;if(i){e.maxTextureSize=i.getParameter(i.MAX_TEXTURE_SIZE),s=e.maxTextureSize>=c;for(var n=["highp","mediump","lowp"],o=0;o<3;o++)if(h(i,n[o])){e.webGlPrecision=n[o];break}}return this.isSupported=s,s},e.WebglFilterBackend=t;function t(c){c&&c.tileSize&&(this.tileSize=c.tileSize),this.setupGLContext(this.tileSize,this.tileSize),this.captureGPUInfo()}t.prototype={tileSize:2048,resources:{},setupGLContext:function(c,l){this.dispose(),this.createWebGLCanvas(c,l),this.aPosition=new Float32Array([0,0,0,1,1,0,1,1]),this.chooseFastestCopyGLTo2DMethod(c,l)},chooseFastestCopyGLTo2DMethod:function(c,l){var i=typeof window.performance<"u",s;try{new ImageData(1,1),s=!0}catch{s=!1}var n=typeof ArrayBuffer<"u",o=typeof Uint8ClampedArray<"u";if(i&&s&&n&&o){var f=e.util.createCanvasElement(),a=new ArrayBuffer(c*l*4);if(e.forceGLPutImageData){this.imageBuffer=a,this.copyGLTo2D=y;return}var d={imageBuffer:a,destinationWidth:c,destinationHeight:l,targetCanvas:f},p,v,b;f.width=c,f.height=l,p=window.performance.now(),_.call(d,this.gl,d),v=window.performance.now()-p,p=window.performance.now(),y.call(d,this.gl,d),b=window.performance.now()-p,v>b?(this.imageBuffer=a,this.copyGLTo2D=y):this.copyGLTo2D=_}},createWebGLCanvas:function(c,l){var i=e.util.createCanvasElement();i.width=c,i.height=l;var s={alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1},n=i.getContext("webgl",s);n||(n=i.getContext("experimental-webgl",s)),n&&(n.clearColor(0,0,0,0),this.canvas=i,this.gl=n)},applyFilters:function(c,l,i,s,n,o){var f=this.gl,a;o&&(a=this.getCachedTexture(o,l));var d={originalWidth:l.width||l.originalWidth,originalHeight:l.height||l.originalHeight,sourceWidth:i,sourceHeight:s,destinationWidth:i,destinationHeight:s,context:f,sourceTexture:this.createTexture(f,i,s,!a&&l),targetTexture:this.createTexture(f,i,s),originalTexture:a||this.createTexture(f,i,s,!a&&l),passes:c.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:n},p=f.createFramebuffer();return f.bindFramebuffer(f.FRAMEBUFFER,p),c.forEach(function(v){v&&v.applyTo(d)}),m(d),this.copyGLTo2D(f,d),f.bindTexture(f.TEXTURE_2D,null),f.deleteTexture(d.sourceTexture),f.deleteTexture(d.targetTexture),f.deleteFramebuffer(p),n.getContext("2d").setTransform(1,0,0,1,0,0),d},dispose:function(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()},clearWebGLCaches:function(){this.programCache={},this.textureCache={}},createTexture:function(c,l,i,s,n){var o=c.createTexture();return c.bindTexture(c.TEXTURE_2D,o),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,n||c.NEAREST),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,n||c.NEAREST),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,c.CLAMP_TO_EDGE),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,c.CLAMP_TO_EDGE),s?c.texImage2D(c.TEXTURE_2D,0,c.RGBA,c.RGBA,c.UNSIGNED_BYTE,s):c.texImage2D(c.TEXTURE_2D,0,c.RGBA,l,i,0,c.RGBA,c.UNSIGNED_BYTE,null),o},getCachedTexture:function(c,l){if(this.textureCache[c])return this.textureCache[c];var i=this.createTexture(this.gl,l.width,l.height,l);return this.textureCache[c]=i,i},evictCachesForKey:function(c){this.textureCache[c]&&(this.gl.deleteTexture(this.textureCache[c]),delete this.textureCache[c])},copyGLTo2D:_,captureGPUInfo:function(){if(this.gpuInfo)return this.gpuInfo;var c=this.gl,l={renderer:"",vendor:""};if(!c)return l;var i=c.getExtension("WEBGL_debug_renderer_info");if(i){var s=c.getParameter(i.UNMASKED_RENDERER_WEBGL),n=c.getParameter(i.UNMASKED_VENDOR_WEBGL);s&&(l.renderer=s.toLowerCase()),n&&(l.vendor=n.toLowerCase())}return this.gpuInfo=l,l}}}();function m(h){var t=h.targetCanvas,c=t.width,l=t.height,i=h.destinationWidth,s=h.destinationHeight;(c!==i||l!==s)&&(t.width=i,t.height=s)}function _(h,t){var c=h.canvas,l=t.targetCanvas,i=l.getContext("2d");i.translate(0,l.height),i.scale(1,-1);var s=c.height-l.height;i.drawImage(c,0,s,l.width,l.height,0,0,l.width,l.height)}function y(h,t){var c=t.targetCanvas,l=c.getContext("2d"),i=t.destinationWidth,s=t.destinationHeight,n=i*s*4,o=new Uint8Array(this.imageBuffer,0,n),f=new Uint8ClampedArray(this.imageBuffer,0,n);h.readPixels(0,0,i,s,h.RGBA,h.UNSIGNED_BYTE,o);var a=new ImageData(f,i,s);l.putImageData(a,0,0)}(function(){var h=function(){};e.Canvas2dFilterBackend=t;function t(){}t.prototype={evictCachesForKey:h,dispose:h,clearWebGLCaches:h,resources:{},applyFilters:function(c,l,i,s,n){var o=n.getContext("2d");o.drawImage(l,0,0,i,s);var f=o.getImageData(0,0,i,s),a=o.getImageData(0,0,i,s),d={sourceWidth:i,sourceHeight:s,imageData:f,originalEl:l,originalImageData:a,canvasEl:n,ctx:o,filterBackend:this};return c.forEach(function(p){p.applyTo(d)}),(d.imageData.width!==i||d.imageData.height!==s)&&(n.width=d.imageData.width,n.height=d.imageData.height),o.putImageData(d.imageData,0,0),d}}})(),e.Image=e.Image||{},e.Image.filters=e.Image.filters||{},e.Image.filters.BaseFilter=e.util.createClass({type:"BaseFilter",vertexSource:`attribute vec2 aPosition;
varying vec2 vTexCoord;
void main() {
vTexCoord = aPosition;
gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
}`,fragmentSource:`precision highp float;
varying vec2 vTexCoord;
uniform sampler2D uTexture;
void main() {
gl_FragColor = texture2D(uTexture, vTexCoord);
}`,initialize:function(h){h&&this.setOptions(h)},setOptions:function(h){for(var t in h)this[t]=h[t]},createProgram:function(h,t,c){t=t||this.fragmentSource,c=c||this.vertexSource,e.webGlPrecision!=="highp"&&(t=t.replace(/precision highp float/g,"precision "+e.webGlPrecision+" float"));var l=h.createShader(h.VERTEX_SHADER);if(h.shaderSource(l,c),h.compileShader(l),!h.getShaderParameter(l,h.COMPILE_STATUS))throw new Error("Vertex shader compile error for "+this.type+": "+h.getShaderInfoLog(l));var i=h.createShader(h.FRAGMENT_SHADER);if(h.shaderSource(i,t),h.compileShader(i),!h.getShaderParameter(i,h.COMPILE_STATUS))throw new Error("Fragment shader compile error for "+this.type+": "+h.getShaderInfoLog(i));var s=h.createProgram();if(h.attachShader(s,l),h.attachShader(s,i),h.linkProgram(s),!h.getProgramParameter(s,h.LINK_STATUS))throw new Error('Shader link error for "${this.type}" '+h.getProgramInfoLog(s));var n=this.getAttributeLocations(h,s),o=this.getUniformLocations(h,s)||{};return o.uStepW=h.getUniformLocation(s,"uStepW"),o.uStepH=h.getUniformLocation(s,"uStepH"),{program:s,attributeLocations:n,uniformLocations:o}},getAttributeLocations:function(h,t){return{aPosition:h.getAttribLocation(t,"aPosition")}},getUniformLocations:function(){return{}},sendAttributeData:function(h,t,c){var l=t.aPosition,i=h.createBuffer();h.bindBuffer(h.ARRAY_BUFFER,i),h.enableVertexAttribArray(l),h.vertexAttribPointer(l,2,h.FLOAT,!1,0,0),h.bufferData(h.ARRAY_BUFFER,c,h.STATIC_DRAW)},_setupFrameBuffer:function(h){var t=h.context,c,l;h.passes>1?(c=h.destinationWidth,l=h.destinationHeight,(h.sourceWidth!==c||h.sourceHeight!==l)&&(t.deleteTexture(h.targetTexture),h.targetTexture=h.filterBackend.createTexture(t,c,l)),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,h.targetTexture,0)):(t.bindFramebuffer(t.FRAMEBUFFER,null),t.finish())},_swapTextures:function(h){h.passes--,h.pass++;var t=h.targetTexture;h.targetTexture=h.sourceTexture,h.sourceTexture=t},isNeutralState:function(){var h=this.mainParameter,t=e.Image.filters[this.type].prototype;if(h)if(Array.isArray(t[h])){for(var c=t[h].length;c--;)if(this[h][c]!==t[h][c])return!1;return!0}else return t[h]===this[h];else return!1},applyTo:function(h){h.webgl?(this._setupFrameBuffer(h),this.applyToWebGL(h),this._swapTextures(h)):this.applyTo2d(h)},retrieveShader:function(h){return h.programCache.hasOwnProperty(this.type)||(h.programCache[this.type]=this.createProgram(h.context)),h.programCache[this.type]},applyToWebGL:function(h){var t=h.context,c=this.retrieveShader(h);h.pass===0&&h.originalTexture?t.bindTexture(t.TEXTURE_2D,h.originalTexture):t.bindTexture(t.TEXTURE_2D,h.sourceTexture),t.useProgram(c.program),this.sendAttributeData(t,c.attributeLocations,h.aPosition),t.uniform1f(c.uniformLocations.uStepW,1/h.sourceWidth),t.uniform1f(c.uniformLocations.uStepH,1/h.sourceHeight),this.sendUniformData(t,c.uniformLocations),t.viewport(0,0,h.destinationWidth,h.destinationHeight),t.drawArrays(t.TRIANGLE_STRIP,0,4)},bindAdditionalTexture:function(h,t,c){h.activeTexture(c),h.bindTexture(h.TEXTURE_2D,t),h.activeTexture(h.TEXTURE0)},unbindAdditionalTexture:function(h,t){h.activeTexture(t),h.bindTexture(h.TEXTURE_2D,null),h.activeTexture(h.TEXTURE0)},getMainParameter:function(){return this[this.mainParameter]},setMainParameter:function(h){this[this.mainParameter]=h},sendUniformData:function(){},createHelpLayer:function(h){if(!h.helpLayer){var t=document.createElement("canvas");t.width=h.sourceWidth,t.height=h.sourceHeight,h.helpLayer=t}},toObject:function(){var h={type:this.type},t=this.mainParameter;return t&&(h[t]=this[t]),h},toJSON:function(){return this.toObject()}}),e.Image.filters.BaseFilter.fromObject=function(h,t){var c=new e.Image.filters[h.type](h);return t&&t(c),c},function(h){var t=h.fabric||(h.fabric={}),c=t.Image.filters,l=t.util.createClass;c.ColorMatrix=l(c.BaseFilter,{type:"ColorMatrix",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
varying vec2 vTexCoord;
uniform mat4 uColorMatrix;
uniform vec4 uConstants;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color *= uColorMatrix;
color += uConstants;
gl_FragColor = color;
}`,matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],mainParameter:"matrix",colorsOnly:!0,initialize:function(i){this.callSuper("initialize",i),this.matrix=this.matrix.slice(0)},applyTo2d:function(i){var s=i.imageData,n=s.data,o=n.length,f=this.matrix,a,d,p,v,b,C=this.colorsOnly;for(b=0;b<o;b+=4)a=n[b],d=n[b+1],p=n[b+2],C?(n[b]=a*f[0]+d*f[1]+p*f[2]+f[4]*255,n[b+1]=a*f[5]+d*f[6]+p*f[7]+f[9]*255,n[b+2]=a*f[10]+d*f[11]+p*f[12]+f[14]*255):(v=n[b+3],n[b]=a*f[0]+d*f[1]+p*f[2]+v*f[3]+f[4]*255,n[b+1]=a*f[5]+d*f[6]+p*f[7]+v*f[8]+f[9]*255,n[b+2]=a*f[10]+d*f[11]+p*f[12]+v*f[13]+f[14]*255,n[b+3]=a*f[15]+d*f[16]+p*f[17]+v*f[18]+f[19]*255)},getUniformLocations:function(i,s){return{uColorMatrix:i.getUniformLocation(s,"uColorMatrix"),uConstants:i.getUniformLocation(s,"uConstants")}},sendUniformData:function(i,s){var n=this.matrix,o=[n[0],n[1],n[2],n[3],n[5],n[6],n[7],n[8],n[10],n[11],n[12],n[13],n[15],n[16],n[17],n[18]],f=[n[4],n[9],n[14],n[19]];i.uniformMatrix4fv(s.uColorMatrix,!1,o),i.uniform4fv(s.uConstants,f)}}),t.Image.filters.ColorMatrix.fromObject=t.Image.filters.BaseFilter.fromObject}(r),function(h){var t=h.fabric||(h.fabric={}),c=t.Image.filters,l=t.util.createClass;c.Brightness=l(c.BaseFilter,{type:"Brightness",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uBrightness;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color.rgb += uBrightness;
gl_FragColor = color;
}`,brightness:0,mainParameter:"brightness",applyTo2d:function(i){if(this.brightness!==0){var s=i.imageData,n=s.data,o,f=n.length,a=Math.round(this.brightness*255);for(o=0;o<f;o+=4)n[o]=n[o]+a,n[o+1]=n[o+1]+a,n[o+2]=n[o+2]+a}},getUniformLocations:function(i,s){return{uBrightness:i.getUniformLocation(s,"uBrightness")}},sendUniformData:function(i,s){i.uniform1f(s.uBrightness,this.brightness)}}),t.Image.filters.Brightness.fromObject=t.Image.filters.BaseFilter.fromObject}(r),function(h){var t=h.fabric||(h.fabric={}),c=t.util.object.extend,l=t.Image.filters,i=t.util.createClass;l.Convolute=i(l.BaseFilter,{type:"Convolute",opaque:!1,matrix:[0,0,0,0,1,0,0,0,0],fragmentSource:{Convolute_3_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[9];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 3.0; h+=1.0) {
for (float w = 0.0; w < 3.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_3_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[9];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 3.0; h+=1.0) {
for (float w = 0.0; w < 3.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_5_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[25];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 5.0; h+=1.0) {
for (float w = 0.0; w < 5.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_5_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[25];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 5.0; h+=1.0) {
for (float w = 0.0; w < 5.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_7_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[49];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 7.0; h+=1.0) {
for (float w = 0.0; w < 7.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_7_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[49];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 7.0; h+=1.0) {
for (float w = 0.0; w < 7.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_9_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[81];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 9.0; h+=1.0) {
for (float w = 0.0; w < 9.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_9_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[81];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 9.0; h+=1.0) {
for (float w = 0.0; w < 9.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`},retrieveShader:function(s){var n=Math.sqrt(this.matrix.length),o=this.type+"_"+n+"_"+(this.opaque?1:0),f=this.fragmentSource[o];return s.programCache.hasOwnProperty(o)||(s.programCache[o]=this.createProgram(s.context,f)),s.programCache[o]},applyTo2d:function(s){var n=s.imageData,o=n.data,f=this.matrix,a=Math.round(Math.sqrt(f.length)),d=Math.floor(a/2),p=n.width,v=n.height,b=s.ctx.createImageData(p,v),C=b.data,w=this.opaque?1:0,S,E,P,N,K,Z,W,U,te,re,he,oe,T;for(he=0;he<v;he++)for(re=0;re<p;re++){for(K=(he*p+re)*4,S=0,E=0,P=0,N=0,T=0;T<a;T++)for(oe=0;oe<a;oe++)W=he+T-d,Z=re+oe-d,!(W<0||W>=v||Z<0||Z>=p)&&(U=(W*p+Z)*4,te=f[T*a+oe],S+=o[U]*te,E+=o[U+1]*te,P+=o[U+2]*te,w||(N+=o[U+3]*te));C[K]=S,C[K+1]=E,C[K+2]=P,w?C[K+3]=o[K+3]:C[K+3]=N}s.imageData=b},getUniformLocations:function(s,n){return{uMatrix:s.getUniformLocation(n,"uMatrix"),uOpaque:s.getUniformLocation(n,"uOpaque"),uHalfSize:s.getUniformLocation(n,"uHalfSize"),uSize:s.getUniformLocation(n,"uSize")}},sendUniformData:function(s,n){s.uniform1fv(n.uMatrix,this.matrix)},toObject:function(){return c(this.callSuper("toObject"),{opaque:this.opaque,matrix:this.matrix})}}),t.Image.filters.Convolute.fromObject=t.Image.filters.BaseFilter.fromObject}(r),function(h){var t=h.fabric||(h.fabric={}),c=t.Image.filters,l=t.util.createClass;c.Grayscale=l(c.BaseFilter,{type:"Grayscale",fragmentSource:{average:`precision highp float;
uniform sampler2D uTexture;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float average = (color.r + color.b + color.g) / 3.0;
gl_FragColor = vec4(average, average, average, color.a);
}`,lightness:`precision highp float;
uniform sampler2D uTexture;
uniform int uMode;
varying vec2 vTexCoord;
void main() {
vec4 col = texture2D(uTexture, vTexCoord);
float average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;
gl_FragColor = vec4(average, average, average, col.a);
}`,luminosity:`precision highp float;
uniform sampler2D uTexture;
uniform int uMode;
varying vec2 vTexCoord;
void main() {
vec4 col = texture2D(uTexture, vTexCoord);
float average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;
gl_FragColor = vec4(average, average, average, col.a);
}`},mode:"average",mainParameter:"mode",applyTo2d:function(i){var s=i.imageData,n=s.data,o,f=n.length,a,d=this.mode;for(o=0;o<f;o+=4)d==="average"?a=(n[o]+n[o+1]+n[o+2])/3:d==="lightness"?a=(Math.min(n[o],n[o+1],n[o+2])+Math.max(n[o],n[o+1],n[o+2]))/2:d==="luminosity"&&(a=.21*n[o]+.72*n[o+1]+.07*n[o+2]),n[o]=a,n[o+1]=a,n[o+2]=a},retrieveShader:function(i){var s=this.type+"_"+this.mode;if(!i.programCache.hasOwnProperty(s)){var n=this.fragmentSource[this.mode];i.programCache[s]=this.createProgram(i.context,n)}return i.programCache[s]},getUniformLocations:function(i,s){return{uMode:i.getUniformLocation(s,"uMode")}},sendUniformData:function(i,s){var n=1;i.uniform1i(s.uMode,n)},isNeutralState:function(){return!1}}),t.Image.filters.Grayscale.fromObject=t.Image.filters.BaseFilter.fromObject}(r),function(h){var t=h.fabric||(h.fabric={}),c=t.Image.filters,l=t.util.createClass;c.Invert=l(c.BaseFilter,{type:"Invert",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform int uInvert;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
if (uInvert == 1) {
gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);
} else {
gl_FragColor = color;
}
}`,invert:!0,mainParameter:"invert",applyTo2d:function(i){var s=i.imageData,n=s.data,o,f=n.length;for(o=0;o<f;o+=4)n[o]=255-n[o],n[o+1]=255-n[o+1],n[o+2]=255-n[o+2]},isNeutralState:function(){return!this.invert},getUniformLocations:function(i,s){return{uInvert:i.getUniformLocation(s,"uInvert")}},sendUniformData:function(i,s){i.uniform1i(s.uInvert,this.invert)}}),t.Image.filters.Invert.fromObject=t.Image.filters.BaseFilter.fromObject}(r),function(h){var t=h.fabric||(h.fabric={}),c=t.util.object.extend,l=t.Image.filters,i=t.util.createClass;l.Noise=i(l.BaseFilter,{type:"Noise",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uStepH;
uniform float uNoise;
uniform float uSeed;
varying vec2 vTexCoord;
float rand(vec2 co, float seed, float vScale) {
return fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);
}
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;
gl_FragColor = color;
}`,mainParameter:"noise",noise:0,applyTo2d:function(s){if(this.noise!==0){var n=s.imageData,o=n.data,f,a=o.length,d=this.noise,p;for(f=0,a=o.length;f<a;f+=4)p=(.5-Math.random())*d,o[f]+=p,o[f+1]+=p,o[f+2]+=p}},getUniformLocations:function(s,n){return{uNoise:s.getUniformLocation(n,"uNoise"),uSeed:s.getUniformLocation(n,"uSeed")}},sendUniformData:function(s,n){s.uniform1f(n.uNoise,this.noise/255),s.uniform1f(n.uSeed,Math.random())},toObject:function(){return c(this.callSuper("toObject"),{noise:this.noise})}}),t.Image.filters.Noise.fromObject=t.Image.filters.BaseFilter.fromObject}(r),function(h){var t=h.fabric||(h.fabric={}),c=t.Image.filters,l=t.util.createClass;c.Pixelate=l(c.BaseFilter,{type:"Pixelate",blocksize:4,mainParameter:"blocksize",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uBlocksize;
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
float blockW = uBlocksize * uStepW;
float blockH = uBlocksize * uStepW;
int posX = int(vTexCoord.x / blockW);
int posY = int(vTexCoord.y / blockH);
float fposX = float(posX);
float fposY = float(posY);
vec2 squareCoords = vec2(fposX * blockW, fposY * blockH);
vec4 color = texture2D(uTexture, squareCoords);
gl_FragColor = color;
}`,applyTo2d:function(i){var s=i.imageData,n=s.data,o=s.height,f=s.width,a,d,p,v,b,C,w,S,E,P,N;for(d=0;d<o;d+=this.blocksize)for(p=0;p<f;p+=this.blocksize)for(a=d*4*f+p*4,v=n[a],b=n[a+1],C=n[a+2],w=n[a+3],P=Math.min(d+this.blocksize,o),N=Math.min(p+this.blocksize,f),S=d;S<P;S++)for(E=p;E<N;E++)a=S*4*f+E*4,n[a]=v,n[a+1]=b,n[a+2]=C,n[a+3]=w},isNeutralState:function(){return this.blocksize===1},getUniformLocations:function(i,s){return{uBlocksize:i.getUniformLocation(s,"uBlocksize"),uStepW:i.getUniformLocation(s,"uStepW"),uStepH:i.getUniformLocation(s,"uStepH")}},sendUniformData:function(i,s){i.uniform1f(s.uBlocksize,this.blocksize)}}),t.Image.filters.Pixelate.fromObject=t.Image.filters.BaseFilter.fromObject}(r),function(h){var t=h.fabric||(h.fabric={}),c=t.util.object.extend,l=t.Image.filters,i=t.util.createClass;l.RemoveColor=i(l.BaseFilter,{type:"RemoveColor",color:"#FFFFFF",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec4 uLow;
uniform vec4 uHigh;
varying vec2 vTexCoord;
void main() {
gl_FragColor = texture2D(uTexture, vTexCoord);
if(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {
gl_FragColor.a = 0.0;
}
}`,distance:.02,useAlpha:!1,applyTo2d:function(s){var n=s.imageData,o=n.data,f,a=this.distance*255,d,p,v,b=new t.Color(this.color).getSource(),C=[b[0]-a,b[1]-a,b[2]-a],w=[b[0]+a,b[1]+a,b[2]+a];for(f=0;f<o.length;f+=4)d=o[f],p=o[f+1],v=o[f+2],d>C[0]&&p>C[1]&&v>C[2]&&d<w[0]&&p<w[1]&&v<w[2]&&(o[f+3]=0)},getUniformLocations:function(s,n){return{uLow:s.getUniformLocation(n,"uLow"),uHigh:s.getUniformLocation(n,"uHigh")}},sendUniformData:function(s,n){var o=new t.Color(this.color).getSource(),f=parseFloat(this.distance),a=[0+o[0]/255-f,0+o[1]/255-f,0+o[2]/255-f,1],d=[o[0]/255+f,o[1]/255+f,o[2]/255+f,1];s.uniform4fv(n.uLow,a),s.uniform4fv(n.uHigh,d)},toObject:function(){return c(this.callSuper("toObject"),{color:this.color,distance:this.distance})}}),t.Image.filters.RemoveColor.fromObject=t.Image.filters.BaseFilter.fromObject}(r),function(h){var t=h.fabric||(h.fabric={}),c=t.Image.filters,l=t.util.createClass,i={Brownie:[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0],Vintage:[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0],Kodachrome:[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0],Technicolor:[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0],Polaroid:[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],Sepia:[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0],BlackWhite:[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]};for(var s in i)c[s]=l(c.ColorMatrix,{type:s,matrix:i[s],mainParameter:!1,colorsOnly:!0}),t.Image.filters[s].fromObject=t.Image.filters.BaseFilter.fromObject}(r),function(h){var t=h.fabric,c=t.Image.filters,l=t.util.createClass;c.BlendColor=l(c.BaseFilter,{type:"BlendColor",color:"#F95C63",mode:"multiply",alpha:1,fragmentSource:{multiply:`gl_FragColor.rgb *= uColor.rgb;
`,screen:`gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);
`,add:`gl_FragColor.rgb += uColor.rgb;
`,diff:`gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);
`,subtract:`gl_FragColor.rgb -= uColor.rgb;
`,lighten:`gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);
`,darken:`gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);
`,exclusion:`gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);
`,overlay:`if (uColor.r < 0.5) {
gl_FragColor.r *= 2.0 * uColor.r;
} else {
gl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);
}
if (uColor.g < 0.5) {
gl_FragColor.g *= 2.0 * uColor.g;
} else {
gl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);
}
if (uColor.b < 0.5) {
gl_FragColor.b *= 2.0 * uColor.b;
} else {
gl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);
}
`,tint:`gl_FragColor.rgb *= (1.0 - uColor.a);
gl_FragColor.rgb += uColor.rgb;
`},buildSource:function(i){return`precision highp float;
uniform sampler2D uTexture;
uniform vec4 uColor;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
gl_FragColor = color;
if (color.a > 0.0) {
`+this.fragmentSource[i]+`}
}`},retrieveShader:function(i){var s=this.type+"_"+this.mode,n;return i.programCache.hasOwnProperty(s)||(n=this.buildSource(this.mode),i.programCache[s]=this.createProgram(i.context,n)),i.programCache[s]},applyTo2d:function(i){var s=i.imageData,n=s.data,o=n.length,f,a,d,p,v,b,C,w=1-this.alpha;C=new t.Color(this.color).getSource(),f=C[0]*this.alpha,a=C[1]*this.alpha,d=C[2]*this.alpha;for(var S=0;S<o;S+=4)switch(p=n[S],v=n[S+1],b=n[S+2],this.mode){case"multiply":n[S]=p*f/255,n[S+1]=v*a/255,n[S+2]=b*d/255;break;case"screen":n[S]=255-(255-p)*(255-f)/255,n[S+1]=255-(255-v)*(255-a)/255,n[S+2]=255-(255-b)*(255-d)/255;break;case"add":n[S]=p+f,n[S+1]=v+a,n[S+2]=b+d;break;case"diff":case"difference":n[S]=Math.abs(p-f),n[S+1]=Math.abs(v-a),n[S+2]=Math.abs(b-d);break;case"subtract":n[S]=p-f,n[S+1]=v-a,n[S+2]=b-d;break;case"darken":n[S]=Math.min(p,f),n[S+1]=Math.min(v,a),n[S+2]=Math.min(b,d);break;case"lighten":n[S]=Math.max(p,f),n[S+1]=Math.max(v,a),n[S+2]=Math.max(b,d);break;case"overlay":n[S]=f<128?2*p*f/255:255-2*(255-p)*(255-f)/255,n[S+1]=a<128?2*v*a/255:255-2*(255-v)*(255-a)/255,n[S+2]=d<128?2*b*d/255:255-2*(255-b)*(255-d)/255;break;case"exclusion":n[S]=f+p-2*f*p/255,n[S+1]=a+v-2*a*v/255,n[S+2]=d+b-2*d*b/255;break;case"tint":n[S]=f+p*w,n[S+1]=a+v*w,n[S+2]=d+b*w}},getUniformLocations:function(i,s){return{uColor:i.getUniformLocation(s,"uColor")}},sendUniformData:function(i,s){var n=new t.Color(this.color).getSource();n[0]=this.alpha*n[0]/255,n[1]=this.alpha*n[1]/255,n[2]=this.alpha*n[2]/255,n[3]=this.alpha,i.uniform4fv(s.uColor,n)},toObject:function(){return{type:this.type,color:this.color,mode:this.mode,alpha:this.alpha}}}),t.Image.filters.BlendColor.fromObject=t.Image.filters.BaseFilter.fromObject}(r),function(h){var t=h.fabric,c=t.Image.filters,l=t.util.createClass;c.BlendImage=l(c.BaseFilter,{type:"BlendImage",image:null,mode:"multiply",alpha:1,vertexSource:`attribute vec2 aPosition;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
uniform mat3 uTransformMatrix;
void main() {
vTexCoord = aPosition;
vTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;
gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
}`,fragmentSource:{multiply:`precision highp float;
uniform sampler2D uTexture;
uniform sampler2D uImage;
uniform vec4 uColor;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec4 color2 = texture2D(uImage, vTexCoord2);
color.rgba *= color2.rgba;
gl_FragColor = color;
}`,mask:`precision highp float;
uniform sampler2D uTexture;
uniform sampler2D uImage;
uniform vec4 uColor;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec4 color2 = texture2D(uImage, vTexCoord2);
color.a = color2.a;
gl_FragColor = color;
}`},retrieveShader:function(i){var s=this.type+"_"+this.mode,n=this.fragmentSource[this.mode];return i.programCache.hasOwnProperty(s)||(i.programCache[s]=this.createProgram(i.context,n)),i.programCache[s]},applyToWebGL:function(i){var s=i.context,n=this.createTexture(i.filterBackend,this.image);this.bindAdditionalTexture(s,n,s.TEXTURE1),this.callSuper("applyToWebGL",i),this.unbindAdditionalTexture(s,s.TEXTURE1)},createTexture:function(i,s){return i.getCachedTexture(s.cacheKey,s._element)},calculateMatrix:function(){var i=this.image,s=i._element.width,n=i._element.height;return[1/i.scaleX,0,0,0,1/i.scaleY,0,-i.left/s,-i.top/n,1]},applyTo2d:function(i){var s=i.imageData,n=i.filterBackend.resources,o=s.data,f=o.length,a=s.width,d=s.height,p,v,b,C,w,S,E,P,N,K,Z=this.image,W;n.blendImage||(n.blendImage=t.util.createCanvasElement()),N=n.blendImage,K=N.getContext("2d"),N.width!==a||N.height!==d?(N.width=a,N.height=d):K.clearRect(0,0,a,d),K.setTransform(Z.scaleX,0,0,Z.scaleY,Z.left,Z.top),K.drawImage(Z._element,0,0,a,d),W=K.getImageData(0,0,a,d).data;for(var U=0;U<f;U+=4)switch(w=o[U],S=o[U+1],E=o[U+2],P=o[U+3],p=W[U],v=W[U+1],b=W[U+2],C=W[U+3],this.mode){case"multiply":o[U]=w*p/255,o[U+1]=S*v/255,o[U+2]=E*b/255,o[U+3]=P*C/255;break;case"mask":o[U+3]=C;break}},getUniformLocations:function(i,s){return{uTransformMatrix:i.getUniformLocation(s,"uTransformMatrix"),uImage:i.getUniformLocation(s,"uImage")}},sendUniformData:function(i,s){var n=this.calculateMatrix();i.uniform1i(s.uImage,1),i.uniformMatrix3fv(s.uTransformMatrix,!1,n)},toObject:function(){return{type:this.type,image:this.image&&this.image.toObject(),mode:this.mode,alpha:this.alpha}}}),t.Image.filters.BlendImage.fromObject=function(i,s){t.Image.fromObject(i.image,function(n){var o=t.util.object.clone(i);o.image=n,s(new t.Image.filters.BlendImage(o))})}}(r),function(h){var t=h.fabric||(h.fabric={}),c=Math.pow,l=Math.floor,i=Math.sqrt,s=Math.abs,n=Math.round,o=Math.sin,f=Math.ceil,a=t.Image.filters,d=t.util.createClass;a.Resize=d(a.BaseFilter,{type:"Resize",resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3,getUniformLocations:function(p,v){return{uDelta:p.getUniformLocation(v,"uDelta"),uTaps:p.getUniformLocation(v,"uTaps")}},sendUniformData:function(p,v){p.uniform2fv(v.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),p.uniform1fv(v.uTaps,this.taps)},retrieveShader:function(p){var v=this.getFilterWindow(),b=this.type+"_"+v;if(!p.programCache.hasOwnProperty(b)){var C=this.generateShader(v);p.programCache[b]=this.createProgram(p.context,C)}return p.programCache[b]},getFilterWindow:function(){var p=this.tempScale;return Math.ceil(this.lanczosLobes/p)},getTaps:function(){for(var p=this.lanczosCreate(this.lanczosLobes),v=this.tempScale,b=this.getFilterWindow(),C=new Array(b),w=1;w<=b;w++)C[w-1]=p(w*v);return C},generateShader:function(C){for(var v=new Array(C),b=this.fragmentSourceTOP,C,w=1;w<=C;w++)v[w-1]=w+".0 * uDelta";return b+="uniform float uTaps["+C+`];
`,b+=`void main() {
`,b+=`  vec4 color = texture2D(uTexture, vTexCoord);
`,b+=`  float sum = 1.0;
`,v.forEach(function(S,E){b+="  color += texture2D(uTexture, vTexCoord + "+S+") * uTaps["+E+`];
`,b+="  color += texture2D(uTexture, vTexCoord - "+S+") * uTaps["+E+`];
`,b+="  sum += 2.0 * uTaps["+E+`];
`}),b+=`  gl_FragColor = color / sum;
`,b+="}",b},fragmentSourceTOP:`precision highp float;
uniform sampler2D uTexture;
uniform vec2 uDelta;
varying vec2 vTexCoord;
`,applyTo:function(p){p.webgl?(p.passes++,this.width=p.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=p.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),p.destinationWidth=this.dW,this._setupFrameBuffer(p),this.applyToWebGL(p),this._swapTextures(p),p.sourceWidth=p.destinationWidth,this.height=p.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),p.destinationHeight=this.dH,this._setupFrameBuffer(p),this.applyToWebGL(p),this._swapTextures(p),p.sourceHeight=p.destinationHeight):this.applyTo2d(p)},isNeutralState:function(){return this.scaleX===1&&this.scaleY===1},lanczosCreate:function(p){return function(v){if(v>=p||v<=-p)return 0;if(v<11920929e-14&&v>-11920929e-14)return 1;v*=Math.PI;var b=v/p;return o(v)/v*o(b)/b}},applyTo2d:function(p){var v=p.imageData,b=this.scaleX,C=this.scaleY;this.rcpScaleX=1/b,this.rcpScaleY=1/C;var w=v.width,S=v.height,E=n(w*b),P=n(S*C),N;this.resizeType==="sliceHack"?N=this.sliceByTwo(p,w,S,E,P):this.resizeType==="hermite"?N=this.hermiteFastResize(p,w,S,E,P):this.resizeType==="bilinear"?N=this.bilinearFiltering(p,w,S,E,P):this.resizeType==="lanczos"&&(N=this.lanczosResize(p,w,S,E,P)),p.imageData=N},sliceByTwo:function(p,v,b,C,w){var S=p.imageData,E=.5,P=!1,N=!1,K=v*E,Z=b*E,W=t.filterBackend.resources,U,te,re=0,he=0,oe=v,T=0;for(W.sliceByTwo||(W.sliceByTwo=document.createElement("canvas")),U=W.sliceByTwo,(U.width<v*1.5||U.height<b)&&(U.width=v*1.5,U.height=b),te=U.getContext("2d"),te.clearRect(0,0,v*1.5,b),te.putImageData(S,0,0),C=l(C),w=l(w);!P||!N;)v=K,b=Z,C<l(K*E)?K=l(K*E):(K=C,P=!0),w<l(Z*E)?Z=l(Z*E):(Z=w,N=!0),te.drawImage(U,re,he,v,b,oe,T,K,Z),re=oe,he=T,T+=Z;return te.getImageData(re,he,C,w)},lanczosResize:function(p,v,b,C,w){function S(D){var A,B,O,x,I,L,z,j,Q,F,ie;for(T.x=(D+.5)*Z,k.x=l(T.x),A=0;A<w;A++){for(T.y=(A+.5)*W,k.y=l(T.y),I=0,L=0,z=0,j=0,Q=0,B=k.x-re;B<=k.x+re;B++)if(!(B<0||B>=v)){F=l(1e3*s(B-T.x)),oe[F]||(oe[F]={});for(var H=k.y-he;H<=k.y+he;H++)H<0||H>=b||(ie=l(1e3*s(H-T.y)),oe[F][ie]||(oe[F][ie]=K(i(c(F*U,2)+c(ie*te,2))/1e3)),O=oe[F][ie],O>0&&(x=(H*v+B)*4,I+=O,L+=O*E[x],z+=O*E[x+1],j+=O*E[x+2],Q+=O*E[x+3]))}x=(A*C+D)*4,N[x]=L/I,N[x+1]=z/I,N[x+2]=j/I,N[x+3]=Q/I}return++D<C?S(D):P}var E=p.imageData.data,P=p.ctx.createImageData(C,w),N=P.data,K=this.lanczosCreate(this.lanczosLobes),Z=this.rcpScaleX,W=this.rcpScaleY,U=2/this.rcpScaleX,te=2/this.rcpScaleY,re=f(Z*this.lanczosLobes/2),he=f(W*this.lanczosLobes/2),oe={},T={},k={};return S(0)},bilinearFiltering:function(p,v,b,C,w){var S,E,P,N,K,Z,W,U,te,re,he,oe,T=0,k,D=this.rcpScaleX,A=this.rcpScaleY,B=4*(v-1),O=p.imageData,x=O.data,I=p.ctx.createImageData(C,w),L=I.data;for(W=0;W<w;W++)for(U=0;U<C;U++)for(K=l(D*U),Z=l(A*W),te=D*U-K,re=A*W-Z,k=4*(Z*v+K),he=0;he<4;he++)S=x[k+he],E=x[k+4+he],P=x[k+B+he],N=x[k+B+4+he],oe=S*(1-te)*(1-re)+E*te*(1-re)+P*re*(1-te)+N*te*re,L[T++]=oe;return I},hermiteFastResize:function(p,v,b,C,w){for(var S=this.rcpScaleX,E=this.rcpScaleY,P=f(S/2),N=f(E/2),K=p.imageData,Z=K.data,W=p.ctx.createImageData(C,w),U=W.data,te=0;te<w;te++)for(var re=0;re<C;re++){for(var he=(re+te*C)*4,oe=0,T=0,k=0,D=0,A=0,B=0,O=0,x=(te+.5)*E,I=l(te*E);I<(te+1)*E;I++)for(var L=s(x-(I+.5))/N,z=(re+.5)*S,j=L*L,Q=l(re*S);Q<(re+1)*S;Q++){var F=s(z-(Q+.5))/P,ie=i(j+F*F);ie>1&&ie<-1||(oe=2*ie*ie*ie-3*ie*ie+1,oe>0&&(F=4*(Q+I*v),O+=oe*Z[F+3],k+=oe,Z[F+3]<255&&(oe=oe*Z[F+3]/250),D+=oe*Z[F],A+=oe*Z[F+1],B+=oe*Z[F+2],T+=oe))}U[he]=D/T,U[he+1]=A/T,U[he+2]=B/T,U[he+3]=O/k}return W},toObject:function(){return{type:this.type,scaleX:this.scaleX,scaleY:this.scaleY,resizeType:this.resizeType,lanczosLobes:this.lanczosLobes}}}),t.Image.filters.Resize.fromObject=t.Image.filters.BaseFilter.fromObject}(r),function(h){var t=h.fabric||(h.fabric={}),c=t.Image.filters,l=t.util.createClass;c.Contrast=l(c.BaseFilter,{type:"Contrast",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uContrast;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));
color.rgb = contrastF * (color.rgb - 0.5) + 0.5;
gl_FragColor = color;
}`,contrast:0,mainParameter:"contrast",applyTo2d:function(i){if(this.contrast!==0){var s=i.imageData,n,f,o=s.data,f=o.length,a=Math.floor(this.contrast*255),d=259*(a+255)/(255*(259-a));for(n=0;n<f;n+=4)o[n]=d*(o[n]-128)+128,o[n+1]=d*(o[n+1]-128)+128,o[n+2]=d*(o[n+2]-128)+128}},getUniformLocations:function(i,s){return{uContrast:i.getUniformLocation(s,"uContrast")}},sendUniformData:function(i,s){i.uniform1f(s.uContrast,this.contrast)}}),t.Image.filters.Contrast.fromObject=t.Image.filters.BaseFilter.fromObject}(r),function(h){var t=h.fabric||(h.fabric={}),c=t.Image.filters,l=t.util.createClass;c.Saturation=l(c.BaseFilter,{type:"Saturation",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uSaturation;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float rgMax = max(color.r, color.g);
float rgbMax = max(rgMax, color.b);
color.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;
color.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;
color.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;
gl_FragColor = color;
}`,saturation:0,mainParameter:"saturation",applyTo2d:function(i){if(this.saturation!==0){var s=i.imageData,n=s.data,o=n.length,f=-this.saturation,a,d;for(a=0;a<o;a+=4)d=Math.max(n[a],n[a+1],n[a+2]),n[a]+=d!==n[a]?(d-n[a])*f:0,n[a+1]+=d!==n[a+1]?(d-n[a+1])*f:0,n[a+2]+=d!==n[a+2]?(d-n[a+2])*f:0}},getUniformLocations:function(i,s){return{uSaturation:i.getUniformLocation(s,"uSaturation")}},sendUniformData:function(i,s){i.uniform1f(s.uSaturation,-this.saturation)}}),t.Image.filters.Saturation.fromObject=t.Image.filters.BaseFilter.fromObject}(r),function(h){var t=h.fabric||(h.fabric={}),c=t.Image.filters,l=t.util.createClass;c.Vibrance=l(c.BaseFilter,{type:"Vibrance",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uVibrance;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float max = max(color.r, max(color.g, color.b));
float avg = (color.r + color.g + color.b) / 3.0;
float amt = (abs(max - avg) * 2.0) * uVibrance;
color.r += max != color.r ? (max - color.r) * amt : 0.00;
color.g += max != color.g ? (max - color.g) * amt : 0.00;
color.b += max != color.b ? (max - color.b) * amt : 0.00;
gl_FragColor = color;
}`,vibrance:0,mainParameter:"vibrance",applyTo2d:function(i){if(this.vibrance!==0){var s=i.imageData,n=s.data,o=n.length,f=-this.vibrance,a,d,p,v;for(a=0;a<o;a+=4)d=Math.max(n[a],n[a+1],n[a+2]),p=(n[a]+n[a+1]+n[a+2])/3,v=Math.abs(d-p)*2/255*f,n[a]+=d!==n[a]?(d-n[a])*v:0,n[a+1]+=d!==n[a+1]?(d-n[a+1])*v:0,n[a+2]+=d!==n[a+2]?(d-n[a+2])*v:0}},getUniformLocations:function(i,s){return{uVibrance:i.getUniformLocation(s,"uVibrance")}},sendUniformData:function(i,s){i.uniform1f(s.uVibrance,-this.vibrance)}}),t.Image.filters.Vibrance.fromObject=t.Image.filters.BaseFilter.fromObject}(r),function(h){var t=h.fabric||(h.fabric={}),c=t.Image.filters,l=t.util.createClass;c.Blur=l(c.BaseFilter,{type:"Blur",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec2 uDelta;
varying vec2 vTexCoord;
const float nSamples = 15.0;
vec3 v3offset = vec3(12.9898, 78.233, 151.7182);
float random(vec3 scale) {
return fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);
}
void main() {
vec4 color = vec4(0.0);
float total = 0.0;
float offset = random(v3offset);
for (float t = -nSamples; t <= nSamples; t++) {
float percent = (t + offset - 0.5) / nSamples;
float weight = 1.0 - abs(percent);
color += texture2D(uTexture, vTexCoord + uDelta * percent) * weight;
total += weight;
}
gl_FragColor = color / total;
}`,blur:0,mainParameter:"blur",applyTo:function(i){i.webgl?(this.aspectRatio=i.sourceWidth/i.sourceHeight,i.passes++,this._setupFrameBuffer(i),this.horizontal=!0,this.applyToWebGL(i),this._swapTextures(i),this._setupFrameBuffer(i),this.horizontal=!1,this.applyToWebGL(i),this._swapTextures(i)):this.applyTo2d(i)},applyTo2d:function(i){i.imageData=this.simpleBlur(i)},simpleBlur:function(i){var s=i.filterBackend.resources,n,o,f=i.imageData.width,a=i.imageData.height;s.blurLayer1||(s.blurLayer1=t.util.createCanvasElement(),s.blurLayer2=t.util.createCanvasElement()),n=s.blurLayer1,o=s.blurLayer2,(n.width!==f||n.height!==a)&&(o.width=n.width=f,o.height=n.height=a);var d=n.getContext("2d"),p=o.getContext("2d"),v=15,b,C,w,S,E=this.blur*.06*.5;for(d.putImageData(i.imageData,0,0),p.clearRect(0,0,f,a),S=-v;S<=v;S++)b=(Math.random()-.5)/4,C=S/v,w=E*C*f+b,p.globalAlpha=1-Math.abs(C),p.drawImage(n,w,b),d.drawImage(o,0,0),p.globalAlpha=1,p.clearRect(0,0,o.width,o.height);for(S=-v;S<=v;S++)b=(Math.random()-.5)/4,C=S/v,w=E*C*a+b,p.globalAlpha=1-Math.abs(C),p.drawImage(n,b,w),d.drawImage(o,0,0),p.globalAlpha=1,p.clearRect(0,0,o.width,o.height);i.ctx.drawImage(n,0,0);var P=i.ctx.getImageData(0,0,n.width,n.height);return d.globalAlpha=1,d.clearRect(0,0,n.width,n.height),P},getUniformLocations:function(i,s){return{delta:i.getUniformLocation(s,"uDelta")}},sendUniformData:function(i,s){var n=this.chooseRightDelta();i.uniform2fv(s.delta,n)},chooseRightDelta:function(){var i=1,s=[0,0],n;return this.horizontal?this.aspectRatio>1&&(i=1/this.aspectRatio):this.aspectRatio<1&&(i=this.aspectRatio),n=i*this.blur*.12,this.horizontal?s[0]=n:s[1]=n,s}}),c.Blur.fromObject=t.Image.filters.BaseFilter.fromObject}(r),function(h){var t=h.fabric||(h.fabric={}),c=t.Image.filters,l=t.util.createClass;c.Gamma=l(c.BaseFilter,{type:"Gamma",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec3 uGamma;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec3 correction = (1.0 / uGamma);
color.r = pow(color.r, correction.r);
color.g = pow(color.g, correction.g);
color.b = pow(color.b, correction.b);
gl_FragColor = color;
gl_FragColor.rgb *= color.a;
}`,gamma:[1,1,1],mainParameter:"gamma",initialize:function(i){this.gamma=[1,1,1],c.BaseFilter.prototype.initialize.call(this,i)},applyTo2d:function(i){var s=i.imageData,n=s.data,o=this.gamma,f=n.length,a=1/o[0],d=1/o[1],p=1/o[2],v;for(this.rVals||(this.rVals=new Uint8Array(256),this.gVals=new Uint8Array(256),this.bVals=new Uint8Array(256)),v=0,f=256;v<f;v++)this.rVals[v]=Math.pow(v/255,a)*255,this.gVals[v]=Math.pow(v/255,d)*255,this.bVals[v]=Math.pow(v/255,p)*255;for(v=0,f=n.length;v<f;v+=4)n[v]=this.rVals[n[v]],n[v+1]=this.gVals[n[v+1]],n[v+2]=this.bVals[n[v+2]]},getUniformLocations:function(i,s){return{uGamma:i.getUniformLocation(s,"uGamma")}},sendUniformData:function(i,s){i.uniform3fv(s.uGamma,this.gamma)}}),t.Image.filters.Gamma.fromObject=t.Image.filters.BaseFilter.fromObject}(r),function(h){var t=h.fabric||(h.fabric={}),c=t.Image.filters,l=t.util.createClass;c.Composed=l(c.BaseFilter,{type:"Composed",subFilters:[],initialize:function(i){this.callSuper("initialize",i),this.subFilters=this.subFilters.slice(0)},applyTo:function(i){i.passes+=this.subFilters.length-1,this.subFilters.forEach(function(s){s.applyTo(i)})},toObject:function(){return t.util.object.extend(this.callSuper("toObject"),{subFilters:this.subFilters.map(function(i){return i.toObject()})})},isNeutralState:function(){return!this.subFilters.some(function(i){return!i.isNeutralState()})}}),t.Image.filters.Composed.fromObject=function(i,s){var n=i.subFilters||[],o=n.map(function(a){return new t.Image.filters[a.type](a)}),f=new t.Image.filters.Composed({subFilters:o});return s&&s(f),f}}(r),function(h){var t=h.fabric||(h.fabric={}),c=t.Image.filters,l=t.util.createClass;c.HueRotation=l(c.ColorMatrix,{type:"HueRotation",rotation:0,mainParameter:"rotation",calculateMatrix:function(){var i=this.rotation*Math.PI,s=t.util.cos(i),n=t.util.sin(i),o=1/3,f=Math.sqrt(o)*n,a=1-s;this.matrix=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],this.matrix[0]=s+a/3,this.matrix[1]=o*a-f,this.matrix[2]=o*a+f,this.matrix[5]=o*a+f,this.matrix[6]=s+o*a,this.matrix[7]=o*a-f,this.matrix[10]=o*a-f,this.matrix[11]=o*a+f,this.matrix[12]=s+o*a},isNeutralState:function(i){return this.calculateMatrix(),c.BaseFilter.prototype.isNeutralState.call(this,i)},applyTo:function(i){this.calculateMatrix(),c.BaseFilter.prototype.applyTo.call(this,i)}}),t.Image.filters.HueRotation.fromObject=t.Image.filters.BaseFilter.fromObject}(r),function(h){var t=h.fabric||(h.fabric={}),c=t.util.object.clone;if(t.Text){t.warn("fabric.Text is already defined");return}var l="fontFamily fontWeight fontSize text underline overline linethrough textAlign fontStyle lineHeight textBackgroundColor charSpacing styles direction path pathStartOffset pathSide pathAlign".split(" ");t.Text=t.util.createClass(t.Object,{_dimensionAffectingProps:["fontSize","fontWeight","fontFamily","fontStyle","lineHeight","text","charSpacing","textAlign","styles","path","pathStartOffset","pathSide","pathAlign"],_reNewline:/\r?\n/,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,type:"text",fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:"left",fontStyle:"normal",lineHeight:1.16,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},textBackgroundColor:"",stateProperties:t.Object.prototype.stateProperties.concat(l),cacheProperties:t.Object.prototype.cacheProperties.concat(l),stroke:null,shadow:null,path:null,pathStartOffset:0,pathSide:"left",pathAlign:"baseline",_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.315,overline:-.88},_fontSizeMult:1.13,charSpacing:0,styles:null,_measuringContext:null,deltaY:0,direction:"ltr",_styleProperties:["stroke","strokeWidth","fill","fontFamily","fontSize","fontWeight","fontStyle","underline","overline","linethrough","deltaY","textBackgroundColor"],__charBounds:[],CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2,initialize:function(i,s){this.styles=s?s.styles||{}:{},this.text=i,this.__skipDimension=!0,this.callSuper("initialize",s),this.path&&this.setPathInfo(),this.__skipDimension=!1,this.initDimensions(),this.setCoords(),this.setupState({propertySet:"_dimensionAffectingProps"})},setPathInfo:function(){var i=this.path;i&&(i.segmentsInfo=t.util.getPathSegmentsInfo(i.path))},getMeasuringContext:function(){return t._measuringContext||(t._measuringContext=this.canvas&&this.canvas.contextCache||t.util.createCanvasElement().getContext("2d")),t._measuringContext},_splitText:function(){var i=this._splitTextIntoLines(this.text);return this.textLines=i.lines,this._textLines=i.graphemeLines,this._unwrappedTextLines=i._unwrappedLines,this._text=i.graphemeText,i},initDimensions:function(){this.__skipDimension||(this._splitText(),this._clearCache(),this.path?(this.width=this.path.width,this.height=this.path.height):(this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,this.height=this.calcTextHeight()),this.textAlign.indexOf("justify")!==-1&&this.enlargeSpaces(),this.saveState({propertySet:"_dimensionAffectingProps"}))},enlargeSpaces:function(){for(var i,s,n,o,f,a,d,p=0,v=this._textLines.length;p<v;p++)if(!(this.textAlign!=="justify"&&(p===v-1||this.isEndOfWrapping(p)))&&(o=0,f=this._textLines[p],s=this.getLineWidth(p),s<this.width&&(d=this.textLines[p].match(this._reSpacesAndTabs)))){n=d.length,i=(this.width-s)/n;for(var b=0,C=f.length;b<=C;b++)a=this.__charBounds[p][b],this._reSpaceAndTab.test(f[b])?(a.width+=i,a.kernedWidth+=i,a.left+=o,o+=i):a.left+=o}},isEndOfWrapping:function(i){return i===this._textLines.length-1},missingNewlineOffset:function(){return 1},toString:function(){return"#<fabric.Text ("+this.complexity()+'): { "text": "'+this.text+'", "fontFamily": "'+this.fontFamily+'" }>'},_getCacheCanvasDimensions:function(){var i=this.callSuper("_getCacheCanvasDimensions"),s=this.fontSize;return i.width+=s*i.zoomX,i.height+=s*i.zoomY,i},_render:function(i){var s=this.path;s&&!s.isNotVisible()&&s._render(i),this._setTextStyles(i),this._renderTextLinesBackground(i),this._renderTextDecoration(i,"underline"),this._renderText(i),this._renderTextDecoration(i,"overline"),this._renderTextDecoration(i,"linethrough")},_renderText:function(i){this.paintFirst==="stroke"?(this._renderTextStroke(i),this._renderTextFill(i)):(this._renderTextFill(i),this._renderTextStroke(i))},_setTextStyles:function(i,s,n){if(i.textBaseline="alphabetical",this.path)switch(this.pathAlign){case"center":i.textBaseline="middle";break;case"ascender":i.textBaseline="top";break;case"descender":i.textBaseline="bottom";break}i.font=this._getFontDeclaration(s,n)},calcTextWidth:function(){for(var i=this.getLineWidth(0),s=1,n=this._textLines.length;s<n;s++){var o=this.getLineWidth(s);o>i&&(i=o)}return i},_renderTextLine:function(i,s,n,o,f,a){this._renderChars(i,s,n,o,f,a)},_renderTextLinesBackground:function(i){if(!(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor"))){for(var s,n,o=i.fillStyle,f,a,d=this._getLeftOffset(),p=this._getTopOffset(),v=0,b=0,C,w,S=this.path,E,P=0,N=this._textLines.length;P<N;P++){if(s=this.getHeightOfLine(P),!this.textBackgroundColor&&!this.styleHas("textBackgroundColor",P)){p+=s;continue}f=this._textLines[P],n=this._getLineLeftOffset(P),b=0,v=0,a=this.getValueOfPropertyAt(P,0,"textBackgroundColor");for(var K=0,Z=f.length;K<Z;K++)C=this.__charBounds[P][K],w=this.getValueOfPropertyAt(P,K,"textBackgroundColor"),S?(i.save(),i.translate(C.renderLeft,C.renderTop),i.rotate(C.angle),i.fillStyle=w,w&&i.fillRect(-C.width/2,-s/this.lineHeight*(1-this._fontSizeFraction),C.width,s/this.lineHeight),i.restore()):w!==a?(E=d+n+v,this.direction==="rtl"&&(E=this.width-E-b),i.fillStyle=a,a&&i.fillRect(E,p,b,s/this.lineHeight),v=C.left,b=C.width,a=w):b+=C.kernedWidth;w&&!S&&(E=d+n+v,this.direction==="rtl"&&(E=this.width-E-b),i.fillStyle=w,i.fillRect(E,p,b,s/this.lineHeight)),p+=s}i.fillStyle=o,this._removeShadow(i)}},getFontCache:function(i){var s=i.fontFamily.toLowerCase();t.charWidthsCache[s]||(t.charWidthsCache[s]={});var n=t.charWidthsCache[s],o=i.fontStyle.toLowerCase()+"_"+(i.fontWeight+"").toLowerCase();return n[o]||(n[o]={}),n[o]},_measureChar:function(i,s,n,o){var f=this.getFontCache(s),a=this._getFontDeclaration(s),d=this._getFontDeclaration(o),p=n+i,v=a===d,b,C,w,S=s.fontSize/this.CACHE_FONT_SIZE,E;if(n&&f[n]!==void 0&&(w=f[n]),f[i]!==void 0&&(E=b=f[i]),v&&f[p]!==void 0&&(C=f[p],E=C-w),b===void 0||w===void 0||C===void 0){var P=this.getMeasuringContext();this._setTextStyles(P,s,!0)}return b===void 0&&(E=b=P.measureText(i).width,f[i]=b),w===void 0&&v&&n&&(w=P.measureText(n).width,f[n]=w),v&&C===void 0&&(C=P.measureText(p).width,f[p]=C,E=C-w),{width:b*S,kernedWidth:E*S}},getHeightOfChar:function(i,s){return this.getValueOfPropertyAt(i,s,"fontSize")},measureLine:function(i){var s=this._measureLine(i);return this.charSpacing!==0&&(s.width-=this._getWidthOfCharSpacing()),s.width<0&&(s.width=0),s},_measureLine:function(i){var s=0,n,o,f=this._textLines[i],a,d,p=0,v=new Array(f.length),b=0,C,w,S=this.path,E=this.pathSide==="right";for(this.__charBounds[i]=v,n=0;n<f.length;n++)o=f[n],d=this._getGraphemeBox(o,i,n,a),v[n]=d,s+=d.kernedWidth,a=o;if(v[n]={left:d?d.left+d.width:0,width:0,kernedWidth:0,height:this.fontSize},S){switch(w=S.segmentsInfo[S.segmentsInfo.length-1].length,C=t.util.getPointOnPath(S.path,0,S.segmentsInfo),C.x+=S.pathOffset.x,C.y+=S.pathOffset.y,this.textAlign){case"left":b=E?w-s:0;break;case"center":b=(w-s)/2;break;case"right":b=E?0:w-s;break}for(b+=this.pathStartOffset*(E?-1:1),n=E?f.length-1:0;E?n>=0:n<f.length;E?n--:n++)d=v[n],b>w?b%=w:b<0&&(b+=w),this._setGraphemeOnPath(b,d,C),b+=d.kernedWidth}return{width:s,numOfSpaces:p}},_setGraphemeOnPath:function(i,s,n){var o=i+s.kernedWidth/2,f=this.path,a=t.util.getPointOnPath(f.path,o,f.segmentsInfo);s.renderLeft=a.x-n.x,s.renderTop=a.y-n.y,s.angle=a.angle+(this.pathSide==="right"?Math.PI:0)},_getGraphemeBox:function(i,s,n,o,f){var a=this.getCompleteStyleDeclaration(s,n),d=o?this.getCompleteStyleDeclaration(s,n-1):{},p=this._measureChar(i,a,o,d),v=p.kernedWidth,b=p.width,C;this.charSpacing!==0&&(C=this._getWidthOfCharSpacing(),b+=C,v+=C);var w={width:b,left:0,height:a.fontSize,kernedWidth:v,deltaY:a.deltaY};if(n>0&&!f){var S=this.__charBounds[s][n-1];w.left=S.left+S.width+p.kernedWidth-p.width}return w},getHeightOfLine:function(i){if(this.__lineHeights[i])return this.__lineHeights[i];for(var s=this._textLines[i],n=this.getHeightOfChar(i,0),o=1,f=s.length;o<f;o++)n=Math.max(this.getHeightOfChar(i,o),n);return this.__lineHeights[i]=n*this.lineHeight*this._fontSizeMult},calcTextHeight:function(){for(var i,s=0,n=0,o=this._textLines.length;n<o;n++)i=this.getHeightOfLine(n),s+=n===o-1?i/this.lineHeight:i;return s},_getLeftOffset:function(){return this.direction==="ltr"?-this.width/2:this.width/2},_getTopOffset:function(){return-this.height/2},_renderTextCommon:function(i,s){i.save();for(var n=0,o=this._getLeftOffset(),f=this._getTopOffset(),a=0,d=this._textLines.length;a<d;a++){var p=this.getHeightOfLine(a),v=p/this.lineHeight,b=this._getLineLeftOffset(a);this._renderTextLine(s,i,this._textLines[a],o+b,f+n+v,a),n+=p}i.restore()},_renderTextFill:function(i){!this.fill&&!this.styleHas("fill")||this._renderTextCommon(i,"fillText")},_renderTextStroke:function(i){(!this.stroke||this.strokeWidth===0)&&this.isEmptyStyles()||(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(i),i.save(),this._setLineDash(i,this.strokeDashArray),i.beginPath(),this._renderTextCommon(i,"strokeText"),i.closePath(),i.restore())},_renderChars:function(i,s,n,o,f,a){var d=this.getHeightOfLine(a),p=this.textAlign.indexOf("justify")!==-1,v,b,C="",w,S=0,E,P=this.path,N=!p&&this.charSpacing===0&&this.isEmptyStyles(a)&&!P,K=this.direction==="ltr",Z=this.direction==="ltr"?1:-1,W,U=s.canvas.getAttribute("dir");if(s.save(),U!==this.direction&&(s.canvas.setAttribute("dir",K?"ltr":"rtl"),s.direction=K?"ltr":"rtl",s.textAlign=K?"left":"right"),f-=d*this._fontSizeFraction/this.lineHeight,N){this._renderChar(i,s,a,0,n.join(""),o,f,d),s.restore();return}for(var te=0,re=n.length-1;te<=re;te++)E=te===re||this.charSpacing||P,C+=n[te],w=this.__charBounds[a][te],S===0?(o+=Z*(w.kernedWidth-w.width),S+=w.width):S+=w.kernedWidth,p&&!E&&this._reSpaceAndTab.test(n[te])&&(E=!0),E||(v=v||this.getCompleteStyleDeclaration(a,te),b=this.getCompleteStyleDeclaration(a,te+1),E=t.util.hasStyleChanged(v,b,!1)),E&&(P?(s.save(),s.translate(w.renderLeft,w.renderTop),s.rotate(w.angle),this._renderChar(i,s,a,te,C,-S/2,0,d),s.restore()):(W=o,this._renderChar(i,s,a,te,C,W,f,d)),C="",v=b,o+=Z*S,S=0);s.restore()},_applyPatternGradientTransformText:function(i){var s=t.util.createCanvasElement(),n,o=this.width+this.strokeWidth,f=this.height+this.strokeWidth;return s.width=o,s.height=f,n=s.getContext("2d"),n.beginPath(),n.moveTo(0,0),n.lineTo(o,0),n.lineTo(o,f),n.lineTo(0,f),n.closePath(),n.translate(o/2,f/2),n.fillStyle=i.toLive(n),this._applyPatternGradientTransform(n,i),n.fill(),n.createPattern(s,"no-repeat")},handleFiller:function(i,s,n){var o,f;return n.toLive?n.gradientUnits==="percentage"||n.gradientTransform||n.patternTransform?(o=-this.width/2,f=-this.height/2,i.translate(o,f),i[s]=this._applyPatternGradientTransformText(n),{offsetX:o,offsetY:f}):(i[s]=n.toLive(i,this),this._applyPatternGradientTransform(i,n)):(i[s]=n,{offsetX:0,offsetY:0})},_setStrokeStyles:function(i,s){return i.lineWidth=s.strokeWidth,i.lineCap=this.strokeLineCap,i.lineDashOffset=this.strokeDashOffset,i.lineJoin=this.strokeLineJoin,i.miterLimit=this.strokeMiterLimit,this.handleFiller(i,"strokeStyle",s.stroke)},_setFillStyles:function(i,s){return this.handleFiller(i,"fillStyle",s.fill)},_renderChar:function(i,s,n,o,f,a,d){var p=this._getStyleDeclaration(n,o),v=this.getCompleteStyleDeclaration(n,o),b=i==="fillText"&&v.fill,C=i==="strokeText"&&v.stroke&&v.strokeWidth,w,S;!C&&!b||(s.save(),b&&(w=this._setFillStyles(s,v)),C&&(S=this._setStrokeStyles(s,v)),s.font=this._getFontDeclaration(v),p&&p.textBackgroundColor&&this._removeShadow(s),p&&p.deltaY&&(d+=p.deltaY),b&&s.fillText(f,a-w.offsetX,d-w.offsetY),C&&s.strokeText(f,a-S.offsetX,d-S.offsetY),s.restore())},setSuperscript:function(i,s){return this._setScript(i,s,this.superscript)},setSubscript:function(i,s){return this._setScript(i,s,this.subscript)},_setScript:function(i,s,n){var o=this.get2DCursorLocation(i,!0),f=this.getValueOfPropertyAt(o.lineIndex,o.charIndex,"fontSize"),a=this.getValueOfPropertyAt(o.lineIndex,o.charIndex,"deltaY"),d={fontSize:f*n.size,deltaY:a+f*n.baseline};return this.setSelectionStyles(d,i,s),this},_getLineLeftOffset:function(i){var s=this.getLineWidth(i),n=this.width-s,o=this.textAlign,f=this.direction,d,a=0,d=this.isEndOfWrapping(i);return o==="justify"||o==="justify-center"&&!d||o==="justify-right"&&!d||o==="justify-left"&&!d?0:(o==="center"&&(a=n/2),o==="right"&&(a=n),o==="justify-center"&&(a=n/2),o==="justify-right"&&(a=n),f==="rtl"&&(a-=n),a)},_clearCache:function(){this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]},_shouldClearDimensionCache:function(){var i=this._forceClearCache;return i||(i=this.hasStateChanged("_dimensionAffectingProps")),i&&(this.dirty=!0,this._forceClearCache=!1),i},getLineWidth:function(i){if(this.__lineWidths[i]!==void 0)return this.__lineWidths[i];var s=this.measureLine(i),n=s.width;return this.__lineWidths[i]=n,n},_getWidthOfCharSpacing:function(){return this.charSpacing!==0?this.fontSize*this.charSpacing/1e3:0},getValueOfPropertyAt:function(i,s,n){var o=this._getStyleDeclaration(i,s);return o&&typeof o[n]<"u"?o[n]:this[n]},_renderTextDecoration:function(i,s){if(!(!this[s]&&!this.styleHas(s))){for(var n,o,f,a,d,p,v,b,C=this._getLeftOffset(),w=this._getTopOffset(),S,E,P,N,K,Z,W,U,te=this.path,re=this._getWidthOfCharSpacing(),he=this.offsets[s],oe=0,T=this._textLines.length;oe<T;oe++){if(n=this.getHeightOfLine(oe),!this[s]&&!this.styleHas(s,oe)){w+=n;continue}v=this._textLines[oe],Z=n/this.lineHeight,a=this._getLineLeftOffset(oe),E=0,P=0,b=this.getValueOfPropertyAt(oe,0,s),U=this.getValueOfPropertyAt(oe,0,"fill"),S=w+Z*(1-this._fontSizeFraction),o=this.getHeightOfChar(oe,0),d=this.getValueOfPropertyAt(oe,0,"deltaY");for(var k=0,D=v.length;k<D;k++)if(N=this.__charBounds[oe][k],K=this.getValueOfPropertyAt(oe,k,s),W=this.getValueOfPropertyAt(oe,k,"fill"),f=this.getHeightOfChar(oe,k),p=this.getValueOfPropertyAt(oe,k,"deltaY"),te&&K&&W)i.save(),i.fillStyle=U,i.translate(N.renderLeft,N.renderTop),i.rotate(N.angle),i.fillRect(-N.kernedWidth/2,he*f+p,N.kernedWidth,this.fontSize/15),i.restore();else if((K!==b||W!==U||f!==o||p!==d)&&P>0){var A=C+a+E;this.direction==="rtl"&&(A=this.width-A-P),b&&U&&(i.fillStyle=U,i.fillRect(A,S+he*o+d,P,this.fontSize/15)),E=N.left,P=N.width,b=K,U=W,o=f,d=p}else P+=N.kernedWidth;var A=C+a+E;this.direction==="rtl"&&(A=this.width-A-P),i.fillStyle=W,K&&W&&i.fillRect(A,S+he*o+d,P-re,this.fontSize/15),w+=n}this._removeShadow(i)}},_getFontDeclaration:function(i,s){var n=i||this,o=this.fontFamily,f=t.Text.genericFonts.indexOf(o.toLowerCase())>-1,a=o===void 0||o.indexOf("'")>-1||o.indexOf(",")>-1||o.indexOf('"')>-1||f?n.fontFamily:'"'+n.fontFamily+'"';return[t.isLikelyNode?n.fontWeight:n.fontStyle,t.isLikelyNode?n.fontStyle:n.fontWeight,s?this.CACHE_FONT_SIZE+"px":n.fontSize+"px",a].join(" ")},render:function(i){this.visible&&(this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._shouldClearDimensionCache()&&this.initDimensions(),this.callSuper("render",i)))},_splitTextIntoLines:function(i){for(var s=i.split(this._reNewline),n=new Array(s.length),o=[`
`],f=[],a=0;a<s.length;a++)n[a]=t.util.string.graphemeSplit(s[a]),f=f.concat(n[a],o);return f.pop(),{_unwrappedLines:n,lines:s,graphemeText:f,graphemeLines:n}},toObject:function(i){var s=l.concat(i),n=this.callSuper("toObject",s);return n.styles=t.util.stylesToArray(this.styles,this.text),n.path&&(n.path=this.path.toObject()),n},set:function(i,s){this.callSuper("set",i,s);var n=!1,o=!1;if(typeof i=="object")for(var f in i)f==="path"&&this.setPathInfo(),n=n||this._dimensionAffectingProps.indexOf(f)!==-1,o=o||f==="path";else n=this._dimensionAffectingProps.indexOf(i)!==-1,o=i==="path";return o&&this.setPathInfo(),n&&(this.initDimensions(),this.setCoords()),this},complexity:function(){return 1}}),t.Text.ATTRIBUTE_NAMES=t.SHARED_ATTRIBUTES.concat("x y dx dy font-family font-style font-weight font-size letter-spacing text-decoration text-anchor".split(" ")),t.Text.DEFAULT_SVG_FONT_SIZE=16,t.Text.fromElement=function(i,s,n){if(!i)return s(null);var o=t.parseAttributes(i,t.Text.ATTRIBUTE_NAMES),f=o.textAnchor||"left";if(n=t.util.object.extend(n?c(n):{},o),n.top=n.top||0,n.left=n.left||0,o.textDecoration){var a=o.textDecoration;a.indexOf("underline")!==-1&&(n.underline=!0),a.indexOf("overline")!==-1&&(n.overline=!0),a.indexOf("line-through")!==-1&&(n.linethrough=!0),delete n.textDecoration}"dx"in o&&(n.left+=o.dx),"dy"in o&&(n.top+=o.dy),"fontSize"in n||(n.fontSize=t.Text.DEFAULT_SVG_FONT_SIZE);var d="";"textContent"in i?d=i.textContent:"firstChild"in i&&i.firstChild!==null&&"data"in i.firstChild&&i.firstChild.data!==null&&(d=i.firstChild.data),d=d.replace(/^\s+|\s+$|\n+/g,"").replace(/\s+/g," ");var p=n.strokeWidth;n.strokeWidth=0;var v=new t.Text(d,n),b=v.getScaledHeight()/v.height,C=(v.height+v.strokeWidth)*v.lineHeight-v.height,w=C*b,S=v.getScaledHeight()+w,E=0;f==="center"&&(E=v.getScaledWidth()/2),f==="right"&&(E=v.getScaledWidth()),v.set({left:v.left-E,top:v.top-(S-v.fontSize*(.07+v._fontSizeFraction))/v.lineHeight,strokeWidth:typeof p<"u"?p:1}),s(v)},t.Text.fromObject=function(i,s){var n=c(i),o=i.path;return delete n.path,t.Object._fromObject("Text",n,function(f){f.styles=t.util.stylesFromArray(i.styles,i.text),o?t.Object._fromObject("Path",o,function(a){f.set("path",a),s(f)},"path"):s(f)},"text")},t.Text.genericFonts=["sans-serif","serif","cursive","fantasy","monospace"],t.util.createAccessors&&t.util.createAccessors(t.Text)}(r),function(){e.util.object.extend(e.Text.prototype,{isEmptyStyles:function(h){if(!this.styles||typeof h<"u"&&!this.styles[h])return!0;var t=typeof h>"u"?this.styles:{line:this.styles[h]};for(var c in t)for(var l in t[c])for(var i in t[c][l])return!1;return!0},styleHas:function(h,t){if(!this.styles||!h||h===""||typeof t<"u"&&!this.styles[t])return!1;var c=typeof t>"u"?this.styles:{0:this.styles[t]};for(var l in c)for(var i in c[l])if(typeof c[l][i][h]<"u")return!0;return!1},cleanStyle:function(h){if(!this.styles||!h||h==="")return!1;var t=this.styles,c=0,l,i,s=!0,n=0,o;for(var f in t){l=0;for(var a in t[f]){var o=t[f][a],d=o.hasOwnProperty(h);c++,d?(i?o[h]!==i&&(s=!1):i=o[h],o[h]===this[h]&&delete o[h]):s=!1,Object.keys(o).length!==0?l++:delete t[f][a]}l===0&&delete t[f]}for(var p=0;p<this._textLines.length;p++)n+=this._textLines[p].length;s&&c===n&&(this[h]=i,this.removeStyle(h))},removeStyle:function(h){if(!(!this.styles||!h||h==="")){var t=this.styles,c,l,i;for(l in t){c=t[l];for(i in c)delete c[i][h],Object.keys(c[i]).length===0&&delete c[i];Object.keys(c).length===0&&delete t[l]}}},_extendStyles:function(h,t){var c=this.get2DCursorLocation(h);this._getLineStyle(c.lineIndex)||this._setLineStyle(c.lineIndex),this._getStyleDeclaration(c.lineIndex,c.charIndex)||this._setStyleDeclaration(c.lineIndex,c.charIndex,{}),e.util.object.extend(this._getStyleDeclaration(c.lineIndex,c.charIndex),t)},get2DCursorLocation:function(h,t){typeof h>"u"&&(h=this.selectionStart);for(var c=t?this._unwrappedTextLines:this._textLines,l=c.length,i=0;i<l;i++){if(h<=c[i].length)return{lineIndex:i,charIndex:h};h-=c[i].length+this.missingNewlineOffset(i)}return{lineIndex:i-1,charIndex:c[i-1].length<h?c[i-1].length:h}},getSelectionStyles:function(h,t,c){typeof h>"u"&&(h=this.selectionStart||0),typeof t>"u"&&(t=this.selectionEnd||h);for(var l=[],i=h;i<t;i++)l.push(this.getStyleAtPosition(i,c));return l},getStyleAtPosition:function(h,t){var c=this.get2DCursorLocation(h),l=t?this.getCompleteStyleDeclaration(c.lineIndex,c.charIndex):this._getStyleDeclaration(c.lineIndex,c.charIndex);return l||{}},setSelectionStyles:function(h,t,c){typeof t>"u"&&(t=this.selectionStart||0),typeof c>"u"&&(c=this.selectionEnd||t);for(var l=t;l<c;l++)this._extendStyles(l,h);return this._forceClearCache=!0,this},_getStyleDeclaration:function(h,t){var c=this.styles&&this.styles[h];return c?c[t]:null},getCompleteStyleDeclaration:function(h,t){for(var c=this._getStyleDeclaration(h,t)||{},l={},i,s=0;s<this._styleProperties.length;s++)i=this._styleProperties[s],l[i]=typeof c[i]>"u"?this[i]:c[i];return l},_setStyleDeclaration:function(h,t,c){this.styles[h][t]=c},_deleteStyleDeclaration:function(h,t){delete this.styles[h][t]},_getLineStyle:function(h){return!!this.styles[h]},_setLineStyle:function(h){this.styles[h]={}},_deleteLineStyle:function(h){delete this.styles[h]}})}(),function(){function h(t){t.textDecoration&&(t.textDecoration.indexOf("underline")>-1&&(t.underline=!0),t.textDecoration.indexOf("line-through")>-1&&(t.linethrough=!0),t.textDecoration.indexOf("overline")>-1&&(t.overline=!0),delete t.textDecoration)}e.IText=e.util.createClass(e.Text,e.Observable,{type:"i-text",selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"",cursorDelay:1e3,cursorDuration:600,caching:!0,hiddenTextareaContainer:null,_reSpace:/\s|\n/,_currentCursorOpacity:0,_selectionDirection:null,_abortCursorAnimation:!1,__widthOfSpace:[],inCompositionMode:!1,initialize:function(t,c){this.callSuper("initialize",t,c),this.initBehavior()},setSelectionStart:function(t){t=Math.max(t,0),this._updateAndFire("selectionStart",t)},setSelectionEnd:function(t){t=Math.min(t,this.text.length),this._updateAndFire("selectionEnd",t)},_updateAndFire:function(t,c){this[t]!==c&&(this._fireSelectionChanged(),this[t]=c),this._updateTextarea()},_fireSelectionChanged:function(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})},initDimensions:function(){this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this.callSuper("initDimensions")},render:function(t){this.clearContextTop(),this.callSuper("render",t),this.cursorOffsetCache={},this.renderCursorOrSelection()},_render:function(t){this.callSuper("_render",t)},clearContextTop:function(t){if(!(!this.isEditing||!this.canvas||!this.canvas.contextTop)){var c=this.canvas.contextTop,l=this.canvas.viewportTransform;c.save(),c.transform(l[0],l[1],l[2],l[3],l[4],l[5]),this.transform(c),this._clearTextArea(c),t||c.restore()}},renderCursorOrSelection:function(){if(!(!this.isEditing||!this.canvas||!this.canvas.contextTop)){var t=this._getCursorBoundaries(),c=this.canvas.contextTop;this.clearContextTop(!0),this.selectionStart===this.selectionEnd?this.renderCursor(t,c):this.renderSelection(t,c),c.restore()}},_clearTextArea:function(t){var c=this.width+4,l=this.height+4;t.clearRect(-c/2,-l/2,c,l)},_getCursorBoundaries:function(t){typeof t>"u"&&(t=this.selectionStart);var c=this._getLeftOffset(),l=this._getTopOffset(),i=this._getCursorBoundariesOffsets(t);return{left:c,top:l,leftOffset:i.left,topOffset:i.top}},_getCursorBoundariesOffsets:function(t){if(this.cursorOffsetCache&&"top"in this.cursorOffsetCache)return this.cursorOffsetCache;var c,l,i,s=0,n=0,o,f=this.get2DCursorLocation(t);i=f.charIndex,l=f.lineIndex;for(var a=0;a<l;a++)s+=this.getHeightOfLine(a);c=this._getLineLeftOffset(l);var d=this.__charBounds[l][i];return d&&(n=d.left),this.charSpacing!==0&&i===this._textLines[l].length&&(n-=this._getWidthOfCharSpacing()),o={top:s,left:c+(n>0?n:0)},this.direction==="rtl"&&(o.left*=-1),this.cursorOffsetCache=o,this.cursorOffsetCache},renderCursor:function(t,c){var l=this.get2DCursorLocation(),i=l.lineIndex,s=l.charIndex>0?l.charIndex-1:0,n=this.getValueOfPropertyAt(i,s,"fontSize"),o=this.scaleX*this.canvas.getZoom(),f=this.cursorWidth/o,a=t.topOffset,d=this.getValueOfPropertyAt(i,s,"deltaY");a+=(1-this._fontSizeFraction)*this.getHeightOfLine(i)/this.lineHeight-n*(1-this._fontSizeFraction),this.inCompositionMode&&this.renderSelection(t,c),c.fillStyle=this.cursorColor||this.getValueOfPropertyAt(i,s,"fill"),c.globalAlpha=this.__isMousedown?1:this._currentCursorOpacity,c.fillRect(t.left+t.leftOffset-f/2,a+t.top+d,f,n)},renderSelection:function(t,c){for(var l=this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,i=this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd,s=this.textAlign.indexOf("justify")!==-1,n=this.get2DCursorLocation(l),o=this.get2DCursorLocation(i),f=n.lineIndex,a=o.lineIndex,d=n.charIndex<0?0:n.charIndex,p=o.charIndex<0?0:o.charIndex,v=f;v<=a;v++){var b=this._getLineLeftOffset(v)||0,C=this.getHeightOfLine(v),w=0,S=0,E=0;if(v===f&&(S=this.__charBounds[f][d].left),v>=f&&v<a)E=s&&!this.isEndOfWrapping(v)?this.width:this.getLineWidth(v)||5;else if(v===a)if(p===0)E=this.__charBounds[a][p].left;else{var P=this._getWidthOfCharSpacing();E=this.__charBounds[a][p-1].left+this.__charBounds[a][p-1].width-P}w=C,(this.lineHeight<1||v===a&&this.lineHeight>1)&&(C/=this.lineHeight);var N=t.left+b+S,K=E-S,Z=C,W=0;this.inCompositionMode?(c.fillStyle=this.compositionColor||"black",Z=1,W=C):c.fillStyle=this.selectionColor,this.direction==="rtl"&&(N=this.width-N-K),c.fillRect(N,t.top+t.topOffset+W,K,Z),t.topOffset+=w}},getCurrentCharFontSize:function(){var t=this._getCurrentCharIndex();return this.getValueOfPropertyAt(t.l,t.c,"fontSize")},getCurrentCharColor:function(){var t=this._getCurrentCharIndex();return this.getValueOfPropertyAt(t.l,t.c,"fill")},_getCurrentCharIndex:function(){var t=this.get2DCursorLocation(this.selectionStart,!0),c=t.charIndex>0?t.charIndex-1:0;return{l:t.lineIndex,c}}}),e.IText.fromObject=function(t,c){var l=e.util.stylesFromArray(t.styles,t.text),i=Object.assign({},t,{styles:l});if(h(i),i.styles)for(var s in i.styles)for(var n in i.styles[s])h(i.styles[s][n]);e.Object._fromObject("IText",i,c,"text")}}(),function(){var h=e.util.object.clone;e.util.object.extend(e.IText.prototype,{initBehavior:function(){this.initAddedHandler(),this.initRemovedHandler(),this.initCursorSelectionHandlers(),this.initDoubleClickSimulation(),this.mouseMoveHandler=this.mouseMoveHandler.bind(this)},onDeselect:function(){this.isEditing&&this.exitEditing(),this.selected=!1},initAddedHandler:function(){var t=this;this.on("added",function(){var c=t.canvas;c&&(c._hasITextHandlers||(c._hasITextHandlers=!0,t._initCanvasHandlers(c)),c._iTextInstances=c._iTextInstances||[],c._iTextInstances.push(t))})},initRemovedHandler:function(){var t=this;this.on("removed",function(){var c=t.canvas;c&&(c._iTextInstances=c._iTextInstances||[],e.util.removeFromArray(c._iTextInstances,t),c._iTextInstances.length===0&&(c._hasITextHandlers=!1,t._removeCanvasHandlers(c)))})},_initCanvasHandlers:function(t){t._mouseUpITextHandler=function(){t._iTextInstances&&t._iTextInstances.forEach(function(c){c.__isMousedown=!1})},t.on("mouse:up",t._mouseUpITextHandler)},_removeCanvasHandlers:function(t){t.off("mouse:up",t._mouseUpITextHandler)},_tick:function(){this._currentTickState=this._animateCursor(this,1,this.cursorDuration,"_onTickComplete")},_animateCursor:function(t,c,l,i){var s;return s={isAborted:!1,abort:function(){this.isAborted=!0}},t.animate("_currentCursorOpacity",c,{duration:l,onComplete:function(){s.isAborted||t[i]()},onChange:function(){t.canvas&&t.selectionStart===t.selectionEnd&&t.renderCursorOrSelection()},abort:function(){return s.isAborted}}),s},_onTickComplete:function(){var t=this;this._cursorTimeout1&&clearTimeout(this._cursorTimeout1),this._cursorTimeout1=setTimeout(function(){t._currentTickCompleteState=t._animateCursor(t,0,this.cursorDuration/2,"_tick")},100)},initDelayedCursor:function(t){var c=this,l=t?0:this.cursorDelay;this.abortCursorAnimation(),this._currentCursorOpacity=1,this._cursorTimeout2=setTimeout(function(){c._tick()},l)},abortCursorAnimation:function(){var t=this._currentTickState||this._currentTickCompleteState,c=this.canvas;this._currentTickState&&this._currentTickState.abort(),this._currentTickCompleteState&&this._currentTickCompleteState.abort(),clearTimeout(this._cursorTimeout1),clearTimeout(this._cursorTimeout2),this._currentCursorOpacity=0,t&&c&&c.clearContext(c.contextTop||c.contextContainer)},selectAll:function(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this},getSelectedText:function(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")},findWordBoundaryLeft:function(t){var c=0,l=t-1;if(this._reSpace.test(this._text[l]))for(;this._reSpace.test(this._text[l]);)c++,l--;for(;/\S/.test(this._text[l])&&l>-1;)c++,l--;return t-c},findWordBoundaryRight:function(t){var c=0,l=t;if(this._reSpace.test(this._text[l]))for(;this._reSpace.test(this._text[l]);)c++,l++;for(;/\S/.test(this._text[l])&&l<this._text.length;)c++,l++;return t+c},findLineBoundaryLeft:function(t){for(var c=0,l=t-1;!/\n/.test(this._text[l])&&l>-1;)c++,l--;return t-c},findLineBoundaryRight:function(t){for(var c=0,l=t;!/\n/.test(this._text[l])&&l<this._text.length;)c++,l++;return t+c},searchWordBoundary:function(t,c){for(var l=this._text,i=this._reSpace.test(l[t])?t-1:t,s=l[i],n=e.reNonWord;!n.test(s)&&i>0&&i<l.length;)i+=c,s=l[i];return n.test(s)&&(i+=c===1?0:1),i},selectWord:function(t){t=t||this.selectionStart;var c=this.searchWordBoundary(t,-1),l=this.searchWordBoundary(t,1);this.selectionStart=c,this.selectionEnd=l,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()},selectLine:function(t){t=t||this.selectionStart;var c=this.findLineBoundaryLeft(t),l=this.findLineBoundaryRight(t);return this.selectionStart=c,this.selectionEnd=l,this._fireSelectionChanged(),this._updateTextarea(),this},enterEditing:function(t){if(!(this.isEditing||!this.editable))return this.canvas&&(this.canvas.calcOffset(),this.exitEditingOnOthers(this.canvas)),this.isEditing=!0,this.initHiddenTextarea(t),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick(),this.fire("editing:entered"),this._fireSelectionChanged(),this.canvas?(this.canvas.fire("text:editing:entered",{target:this}),this.initMouseMoveHandler(),this.canvas.requestRenderAll(),this):this},exitEditingOnOthers:function(t){t._iTextInstances&&t._iTextInstances.forEach(function(c){c.selected=!1,c.isEditing&&c.exitEditing()})},initMouseMoveHandler:function(){this.canvas.on("mouse:move",this.mouseMoveHandler)},mouseMoveHandler:function(t){if(!(!this.__isMousedown||!this.isEditing)){document.activeElement!==this.hiddenTextarea&&this.hiddenTextarea.focus();var c=this.getSelectionStartFromPointer(t.e),l=this.selectionStart,i=this.selectionEnd;(c!==this.__selectionStartOnMouseDown||l===i)&&(l===c||i===c)||(c>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=c):(this.selectionStart=c,this.selectionEnd=this.__selectionStartOnMouseDown),(this.selectionStart!==l||this.selectionEnd!==i)&&(this.restartCursorIfNeeded(),this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}},_setEditingProps:function(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0},fromStringToGraphemeSelection:function(t,c,l){var i=l.slice(0,t),s=e.util.string.graphemeSplit(i).length;if(t===c)return{selectionStart:s,selectionEnd:s};var n=l.slice(t,c),o=e.util.string.graphemeSplit(n).length;return{selectionStart:s,selectionEnd:s+o}},fromGraphemeToStringSelection:function(t,c,l){var i=l.slice(0,t),s=i.join("").length;if(t===c)return{selectionStart:s,selectionEnd:s};var n=l.slice(t,c),o=n.join("").length;return{selectionStart:s,selectionEnd:s+o}},_updateTextarea:function(){if(this.cursorOffsetCache={},!!this.hiddenTextarea){if(!this.inCompositionMode){var t=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=t.selectionStart,this.hiddenTextarea.selectionEnd=t.selectionEnd}this.updateTextareaPosition()}},updateFromTextArea:function(){if(this.hiddenTextarea){this.cursorOffsetCache={},this.text=this.hiddenTextarea.value,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords());var t=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value);this.selectionEnd=this.selectionStart=t.selectionEnd,this.inCompositionMode||(this.selectionStart=t.selectionStart),this.updateTextareaPosition()}},updateTextareaPosition:function(){if(this.selectionStart===this.selectionEnd){var t=this._calcTextareaPosition();this.hiddenTextarea.style.left=t.left,this.hiddenTextarea.style.top=t.top}},_calcTextareaPosition:function(){if(!this.canvas)return{x:1,y:1};var t=this.inCompositionMode?this.compositionStart:this.selectionStart,c=this._getCursorBoundaries(t),l=this.get2DCursorLocation(t),i=l.lineIndex,s=l.charIndex,n=this.getValueOfPropertyAt(i,s,"fontSize")*this.lineHeight,o=c.leftOffset,f=this.calcTransformMatrix(),a={x:c.left+o,y:c.top+c.topOffset+n},d=this.canvas.getRetinaScaling(),p=this.canvas.upperCanvasEl,v=p.width/d,b=p.height/d,C=v-n,w=b-n,S=p.clientWidth/v,E=p.clientHeight/b;return a=e.util.transformPoint(a,f),a=e.util.transformPoint(a,this.canvas.viewportTransform),a.x*=S,a.y*=E,a.x<0&&(a.x=0),a.x>C&&(a.x=C),a.y<0&&(a.y=0),a.y>w&&(a.y=w),a.x+=this.canvas._offset.left,a.y+=this.canvas._offset.top,{left:a.x+"px",top:a.y+"px",fontSize:n+"px",charHeight:n}},_saveEditingProps:function(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}},_restoreEditingProps:function(){this._savedProps&&(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor))},exitEditing:function(){var t=this._textBeforeEdit!==this.text,c=this.hiddenTextarea;return this.selected=!1,this.isEditing=!1,this.selectionEnd=this.selectionStart,c&&(c.blur&&c.blur(),c.parentNode&&c.parentNode.removeChild(c)),this.hiddenTextarea=null,this.abortCursorAnimation(),this._restoreEditingProps(),this._currentCursorOpacity=0,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this.fire("editing:exited"),t&&this.fire("modified"),this.canvas&&(this.canvas.off("mouse:move",this.mouseMoveHandler),this.canvas.fire("text:editing:exited",{target:this}),t&&this.canvas.fire("object:modified",{target:this})),this},_removeExtraneousStyles:function(){for(var t in this.styles)this._textLines[t]||delete this.styles[t]},removeStyleFromTo:function(t,c){var l=this.get2DCursorLocation(t,!0),i=this.get2DCursorLocation(c,!0),s=l.lineIndex,n=l.charIndex,o=i.lineIndex,f=i.charIndex,a,d;if(s!==o){if(this.styles[s])for(a=n;a<this._unwrappedTextLines[s].length;a++)delete this.styles[s][a];if(this.styles[o])for(a=f;a<this._unwrappedTextLines[o].length;a++)d=this.styles[o][a],d&&(this.styles[s]||(this.styles[s]={}),this.styles[s][n+a-f]=d);for(a=s+1;a<=o;a++)delete this.styles[a];this.shiftLineStyles(o,s-o)}else if(this.styles[s]){d=this.styles[s];var p=f-n,v,b;for(a=n;a<f;a++)delete d[a];for(b in this.styles[s])v=parseInt(b,10),v>=f&&(d[v-p]=d[b],delete d[b])}},shiftLineStyles:function(t,c){var l=h(this.styles);for(var i in this.styles){var s=parseInt(i,10);s>t&&(this.styles[s+c]=l[s],l[s-c]||delete this.styles[s])}},restartCursorIfNeeded:function(){(!this._currentTickState||this._currentTickState.isAborted||!this._currentTickCompleteState||this._currentTickCompleteState.isAborted)&&this.initDelayedCursor()},insertNewlineStyleObject:function(t,c,l,i){var s,n={},o=!1,f=this._unwrappedTextLines[t].length===c;l||(l=1),this.shiftLineStyles(t,l),this.styles[t]&&(s=this.styles[t][c===0?c:c-1]);for(var a in this.styles[t]){var d=parseInt(a,10);d>=c&&(o=!0,n[d-c]=this.styles[t][a],f&&c===0||delete this.styles[t][a])}var p=!1;for(o&&!f&&(this.styles[t+l]=n,p=!0),p&&l--;l>0;)i&&i[l-1]?this.styles[t+l]={0:h(i[l-1])}:s?this.styles[t+l]={0:h(s)}:delete this.styles[t+l],l--;this._forceClearCache=!0},insertCharStyleObject:function(t,c,l,i){this.styles||(this.styles={});var s=this.styles[t],n=s?h(s):{};l||(l=1);for(var o in n){var f=parseInt(o,10);f>=c&&(s[f+l]=n[f],n[f-l]||delete s[f])}if(this._forceClearCache=!0,i){for(;l--;)Object.keys(i[l]).length&&(this.styles[t]||(this.styles[t]={}),this.styles[t][c+l]=h(i[l]));return}if(s)for(var a=s[c?c-1:1];a&&l--;)this.styles[t][c+l]=h(a)},insertNewStyleBlock:function(t,c,l){for(var i=this.get2DCursorLocation(c,!0),s=[0],n=0,o=0;o<t.length;o++)t[o]===`
`?(n++,s[n]=0):s[n]++;s[0]>0&&(this.insertCharStyleObject(i.lineIndex,i.charIndex,s[0],l),l=l&&l.slice(s[0]+1)),n&&this.insertNewlineStyleObject(i.lineIndex,i.charIndex+s[0],n);for(var o=1;o<n;o++)s[o]>0?this.insertCharStyleObject(i.lineIndex+o,0,s[o],l):l&&this.styles[i.lineIndex+o]&&l[0]&&(this.styles[i.lineIndex+o][0]=l[0]),l=l&&l.slice(s[o]+1);s[o]>0&&this.insertCharStyleObject(i.lineIndex+o,0,s[o],l)},setSelectionStartEndWithShift:function(t,c,l){l<=t?(c===t?this._selectionDirection="left":this._selectionDirection==="right"&&(this._selectionDirection="left",this.selectionEnd=t),this.selectionStart=l):l>t&&l<c?this._selectionDirection==="right"?this.selectionEnd=l:this.selectionStart=l:(c===t?this._selectionDirection="right":this._selectionDirection==="left"&&(this._selectionDirection="right",this.selectionStart=c),this.selectionEnd=l)},setSelectionInBoundaries:function(){var t=this.text.length;this.selectionStart>t?this.selectionStart=t:this.selectionStart<0&&(this.selectionStart=0),this.selectionEnd>t?this.selectionEnd=t:this.selectionEnd<0&&(this.selectionEnd=0)}})}(),e.util.object.extend(e.IText.prototype,{initDoubleClickSimulation:function(){this.__lastClickTime=+new Date,this.__lastLastClickTime=+new Date,this.__lastPointer={},this.on("mousedown",this.onMouseDown)},onMouseDown:function(h){if(this.canvas){this.__newClickTime=+new Date;var t=h.pointer;this.isTripleClick(t)&&(this.fire("tripleclick",h),this._stopEvent(h.e)),this.__lastLastClickTime=this.__lastClickTime,this.__lastClickTime=this.__newClickTime,this.__lastPointer=t,this.__lastIsEditing=this.isEditing,this.__lastSelected=this.selected}},isTripleClick:function(h){return this.__newClickTime-this.__lastClickTime<500&&this.__lastClickTime-this.__lastLastClickTime<500&&this.__lastPointer.x===h.x&&this.__lastPointer.y===h.y},_stopEvent:function(h){h.preventDefault&&h.preventDefault(),h.stopPropagation&&h.stopPropagation()},initCursorSelectionHandlers:function(){this.initMousedownHandler(),this.initMouseupHandler(),this.initClicks()},doubleClickHandler:function(h){this.isEditing&&this.selectWord(this.getSelectionStartFromPointer(h.e))},tripleClickHandler:function(h){this.isEditing&&this.selectLine(this.getSelectionStartFromPointer(h.e))},initClicks:function(){this.on("mousedblclick",this.doubleClickHandler),this.on("tripleclick",this.tripleClickHandler)},_mouseDownHandler:function(h){!this.canvas||!this.editable||h.e.button&&h.e.button!==1||(this.__isMousedown=!0,this.selected&&(this.inCompositionMode=!1,this.setCursorByClick(h.e)),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection()))},_mouseDownHandlerBefore:function(h){!this.canvas||!this.editable||h.e.button&&h.e.button!==1||(this.selected=this===this.canvas._activeObject)},initMousedownHandler:function(){this.on("mousedown",this._mouseDownHandler),this.on("mousedown:before",this._mouseDownHandlerBefore)},initMouseupHandler:function(){this.on("mouseup",this.mouseUpHandler)},mouseUpHandler:function(h){if(this.__isMousedown=!1,!(!this.editable||this.group||h.transform&&h.transform.actionPerformed||h.e.button&&h.e.button!==1)){if(this.canvas){var t=this.canvas._activeObject;if(t&&t!==this)return}this.__lastSelected&&!this.__corner?(this.selected=!1,this.__lastSelected=!1,this.enterEditing(h.e),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection()):this.selected=!0}},setCursorByClick:function(h){var t=this.getSelectionStartFromPointer(h),c=this.selectionStart,l=this.selectionEnd;h.shiftKey?this.setSelectionStartEndWithShift(c,l,t):(this.selectionStart=t,this.selectionEnd=t),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())},getSelectionStartFromPointer:function(h){for(var t=this.getLocalPointer(h),c=0,l=0,i=0,s=0,n=0,o,f,a=0,d=this._textLines.length;a<d&&i<=t.y;a++)i+=this.getHeightOfLine(a)*this.scaleY,n=a,a>0&&(s+=this._textLines[a-1].length+this.missingNewlineOffset(a-1));o=this._getLineLeftOffset(n),l=o*this.scaleX,f=this._textLines[n],this.direction==="rtl"&&(t.x=this.width*this.scaleX-t.x+l);for(var p=0,v=f.length;p<v&&(c=l,l+=this.__charBounds[n][p].kernedWidth*this.scaleX,l<=t.x);p++)s++;return this._getNewSelectionStartFromOffset(t,c,l,s,v)},_getNewSelectionStartFromOffset:function(h,t,c,l,i){var s=h.x-t,n=c-h.x,o=n>s||n<0?0:1,f=l+o;return this.flipX&&(f=i-f),f>this._text.length&&(f=this._text.length),f}}),e.util.object.extend(e.IText.prototype,{initHiddenTextarea:function(){this.hiddenTextarea=e.document.createElement("textarea"),this.hiddenTextarea.setAttribute("autocapitalize","off"),this.hiddenTextarea.setAttribute("autocorrect","off"),this.hiddenTextarea.setAttribute("autocomplete","off"),this.hiddenTextarea.setAttribute("spellcheck","false"),this.hiddenTextarea.setAttribute("data-fabric-hiddentextarea",""),this.hiddenTextarea.setAttribute("wrap","off");var h=this._calcTextareaPosition();this.hiddenTextarea.style.cssText="position: absolute; top: "+h.top+"; left: "+h.left+"; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; padding-top: "+h.fontSize+";",this.hiddenTextareaContainer?this.hiddenTextareaContainer.appendChild(this.hiddenTextarea):e.document.body.appendChild(this.hiddenTextarea),e.util.addListener(this.hiddenTextarea,"keydown",this.onKeyDown.bind(this)),e.util.addListener(this.hiddenTextarea,"keyup",this.onKeyUp.bind(this)),e.util.addListener(this.hiddenTextarea,"input",this.onInput.bind(this)),e.util.addListener(this.hiddenTextarea,"copy",this.copy.bind(this)),e.util.addListener(this.hiddenTextarea,"cut",this.copy.bind(this)),e.util.addListener(this.hiddenTextarea,"paste",this.paste.bind(this)),e.util.addListener(this.hiddenTextarea,"compositionstart",this.onCompositionStart.bind(this)),e.util.addListener(this.hiddenTextarea,"compositionupdate",this.onCompositionUpdate.bind(this)),e.util.addListener(this.hiddenTextarea,"compositionend",this.onCompositionEnd.bind(this)),!this._clickHandlerInitialized&&this.canvas&&(e.util.addListener(this.canvas.upperCanvasEl,"click",this.onClick.bind(this)),this._clickHandlerInitialized=!0)},keysMap:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorRight",36:"moveCursorLeft",37:"moveCursorLeft",38:"moveCursorUp",39:"moveCursorRight",40:"moveCursorDown"},keysMapRtl:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorLeft",36:"moveCursorRight",37:"moveCursorRight",38:"moveCursorUp",39:"moveCursorLeft",40:"moveCursorDown"},ctrlKeysMapUp:{67:"copy",88:"cut"},ctrlKeysMapDown:{65:"selectAll"},onClick:function(){this.hiddenTextarea&&this.hiddenTextarea.focus()},onKeyDown:function(h){if(this.isEditing){var t=this.direction==="rtl"?this.keysMapRtl:this.keysMap;if(h.keyCode in t)this[t[h.keyCode]](h);else if(h.keyCode in this.ctrlKeysMapDown&&(h.ctrlKey||h.metaKey))this[this.ctrlKeysMapDown[h.keyCode]](h);else return;h.stopImmediatePropagation(),h.preventDefault(),h.keyCode>=33&&h.keyCode<=40?(this.inCompositionMode=!1,this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}},onKeyUp:function(h){if(!this.isEditing||this._copyDone||this.inCompositionMode){this._copyDone=!1;return}if(h.keyCode in this.ctrlKeysMapUp&&(h.ctrlKey||h.metaKey))this[this.ctrlKeysMapUp[h.keyCode]](h);else return;h.stopImmediatePropagation(),h.preventDefault(),this.canvas&&this.canvas.requestRenderAll()},onInput:function(h){var t=this.fromPaste;if(this.fromPaste=!1,h&&h.stopPropagation(),!!this.isEditing){var c=this._splitTextIntoLines(this.hiddenTextarea.value).graphemeText,l=this._text.length,i=c.length,s,n,o=i-l,f=this.selectionStart,a=this.selectionEnd,d=f!==a,p,v,b;if(this.hiddenTextarea.value===""){this.styles={},this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll());return}var C=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value),w=f>C.selectionStart;d?(s=this._text.slice(f,a),o+=a-f):i<l&&(w?s=this._text.slice(a+o,a):s=this._text.slice(f,f-o)),n=c.slice(C.selectionEnd-o,C.selectionEnd),s&&s.length&&(n.length&&(p=this.getSelectionStyles(f,f+1,!1),p=n.map(function(){return p[0]})),d?(v=f,b=a):w?(v=a-s.length,b=a):(v=a,b=a+s.length),this.removeStyleFromTo(v,b)),n.length&&(t&&n.join("")===e.copiedText&&!e.disableStyleCopyPaste&&(p=e.copiedTextStyle),this.insertNewStyleBlock(n,f,p)),this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())}},onCompositionStart:function(){this.inCompositionMode=!0},onCompositionEnd:function(){this.inCompositionMode=!1},onCompositionUpdate:function(h){this.compositionStart=h.target.selectionStart,this.compositionEnd=h.target.selectionEnd,this.updateTextareaPosition()},copy:function(){this.selectionStart!==this.selectionEnd&&(e.copiedText=this.getSelectedText(),e.disableStyleCopyPaste?e.copiedTextStyle=null:e.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0)},paste:function(){this.fromPaste=!0},_getClipboardData:function(h){return h&&h.clipboardData||e.window.clipboardData},_getWidthBeforeCursor:function(h,t){var c=this._getLineLeftOffset(h),l;return t>0&&(l=this.__charBounds[h][t-1],c+=l.left+l.width),c},getDownCursorOffset:function(h,t){var c=this._getSelectionForOffset(h,t),l=this.get2DCursorLocation(c),i=l.lineIndex;if(i===this._textLines.length-1||h.metaKey||h.keyCode===34)return this._text.length-c;var s=l.charIndex,n=this._getWidthBeforeCursor(i,s),o=this._getIndexOnLine(i+1,n),f=this._textLines[i].slice(s);return f.length+o+1+this.missingNewlineOffset(i)},_getSelectionForOffset:function(h,t){return h.shiftKey&&this.selectionStart!==this.selectionEnd&&t?this.selectionEnd:this.selectionStart},getUpCursorOffset:function(h,t){var c=this._getSelectionForOffset(h,t),l=this.get2DCursorLocation(c),i=l.lineIndex;if(i===0||h.metaKey||h.keyCode===33)return-c;var s=l.charIndex,n=this._getWidthBeforeCursor(i,s),o=this._getIndexOnLine(i-1,n),f=this._textLines[i].slice(0,s),a=this.missingNewlineOffset(i-1);return-this._textLines[i-1].length+o-f.length+(1-a)},_getIndexOnLine:function(h,t){for(var c=this._textLines[h],l=this._getLineLeftOffset(h),i=l,s=0,n,o,f=0,a=c.length;f<a;f++)if(n=this.__charBounds[h][f].width,i+=n,i>t){o=!0;var d=i-n,p=i,v=Math.abs(d-t),b=Math.abs(p-t);s=b<v?f:f-1;break}return o||(s=c.length-1),s},moveCursorDown:function(h){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",h)},moveCursorUp:function(h){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorUpOrDown("Up",h)},_moveCursorUpOrDown:function(h,t){var c="get"+h+"CursorOffset",l=this[c](t,this._selectionDirection==="right");t.shiftKey?this.moveCursorWithShift(l):this.moveCursorWithoutShift(l),l!==0&&(this.setSelectionInBoundaries(),this.abortCursorAnimation(),this._currentCursorOpacity=1,this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorWithShift:function(h){var t=this._selectionDirection==="left"?this.selectionStart+h:this.selectionEnd+h;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,t),h!==0},moveCursorWithoutShift:function(h){return h<0?(this.selectionStart+=h,this.selectionEnd=this.selectionStart):(this.selectionEnd+=h,this.selectionStart=this.selectionEnd),h!==0},moveCursorLeft:function(h){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorLeftOrRight("Left",h)},_move:function(h,t,c){var l;if(h.altKey)l=this["findWordBoundary"+c](this[t]);else if(h.metaKey||h.keyCode===35||h.keyCode===36)l=this["findLineBoundary"+c](this[t]);else return this[t]+=c==="Left"?-1:1,!0;if(typeof l<"u"&&this[t]!==l)return this[t]=l,!0},_moveLeft:function(h,t){return this._move(h,t,"Left")},_moveRight:function(h,t){return this._move(h,t,"Right")},moveCursorLeftWithoutShift:function(h){var t=!0;return this._selectionDirection="left",this.selectionEnd===this.selectionStart&&this.selectionStart!==0&&(t=this._moveLeft(h,"selectionStart")),this.selectionEnd=this.selectionStart,t},moveCursorLeftWithShift:function(h){if(this._selectionDirection==="right"&&this.selectionStart!==this.selectionEnd)return this._moveLeft(h,"selectionEnd");if(this.selectionStart!==0)return this._selectionDirection="left",this._moveLeft(h,"selectionStart")},moveCursorRight:function(h){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",h)},_moveCursorLeftOrRight:function(h,t){var c="moveCursor"+h+"With";this._currentCursorOpacity=1,t.shiftKey?c+="Shift":c+="outShift",this[c](t)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorRightWithShift:function(h){if(this._selectionDirection==="left"&&this.selectionStart!==this.selectionEnd)return this._moveRight(h,"selectionStart");if(this.selectionEnd!==this._text.length)return this._selectionDirection="right",this._moveRight(h,"selectionEnd")},moveCursorRightWithoutShift:function(h){var t=!0;return this._selectionDirection="right",this.selectionStart===this.selectionEnd?(t=this._moveRight(h,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,t},removeChars:function(h,t){typeof t>"u"&&(t=h+1),this.removeStyleFromTo(h,t),this._text.splice(h,t-h),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()},insertChars:function(h,t,c,l){typeof l>"u"&&(l=c),l>c&&this.removeStyleFromTo(c,l);var i=e.util.string.graphemeSplit(h);this.insertNewStyleBlock(i,c,t),this._text=[].concat(this._text.slice(0,c),i,this._text.slice(l)),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()}}),function(){var h=e.util.toFixed,t=/  +/g;e.util.object.extend(e.Text.prototype,{_toSVG:function(){var c=this._getSVGLeftTopOffsets(),l=this._getSVGTextAndBg(c.textTop,c.textLeft);return this._wrapSVGTextAndBg(l)},toSVG:function(c){return this._createBaseSVGMarkup(this._toSVG(),{reviver:c,noStyle:!0,withShadow:!0})},_getSVGLeftTopOffsets:function(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}},_wrapSVGTextAndBg:function(c){var l=!0,i=this.getSvgTextDecoration(this);return[c.textBgRects.join(""),'		<text xml:space="preserve" ',this.fontFamily?'font-family="'+this.fontFamily.replace(/"/g,"'")+'" ':"",this.fontSize?'font-size="'+this.fontSize+'" ':"",this.fontStyle?'font-style="'+this.fontStyle+'" ':"",this.fontWeight?'font-weight="'+this.fontWeight+'" ':"",i?'text-decoration="'+i+'" ':"",'style="',this.getSvgStyles(l),'"',this.addPaintOrder()," >",c.textSpans.join(""),`</text>
`]},_getSVGTextAndBg:function(c,l){var i=[],s=[],n=c,o;this._setSVGBg(s);for(var f=0,a=this._textLines.length;f<a;f++)o=this._getLineLeftOffset(f),(this.textBackgroundColor||this.styleHas("textBackgroundColor",f))&&this._setSVGTextLineBg(s,f,l+o,n),this._setSVGTextLineText(i,f,l+o,n),n+=this.getHeightOfLine(f);return{textSpans:i,textBgRects:s}},_createTextCharSpan:function(c,l,i,s){var n=c!==c.trim()||c.match(t),o=this.getSvgSpanStyles(l,n),f=o?'style="'+o+'"':"",a=l.deltaY,d="",p=e.Object.NUM_FRACTION_DIGITS;return a&&(d=' dy="'+h(a,p)+'" '),['<tspan x="',h(i,p),'" y="',h(s,p),'" ',d,f,">",e.util.string.escapeXml(c),"</tspan>"].join("")},_setSVGTextLineText:function(c,l,i,s){var n=this.getHeightOfLine(l),o=this.textAlign.indexOf("justify")!==-1,f,a,d="",p,v,b=0,C=this._textLines[l],w;s+=n*(1-this._fontSizeFraction)/this.lineHeight;for(var S=0,E=C.length-1;S<=E;S++)w=S===E||this.charSpacing,d+=C[S],p=this.__charBounds[l][S],b===0?(i+=p.kernedWidth-p.width,b+=p.width):b+=p.kernedWidth,o&&!w&&this._reSpaceAndTab.test(C[S])&&(w=!0),w||(f=f||this.getCompleteStyleDeclaration(l,S),a=this.getCompleteStyleDeclaration(l,S+1),w=e.util.hasStyleChanged(f,a,!0)),w&&(v=this._getStyleDeclaration(l,S)||{},c.push(this._createTextCharSpan(d,v,i,s)),d="",f=a,i+=b,b=0)},_pushTextBgRect:function(c,l,i,s,n,o){var f=e.Object.NUM_FRACTION_DIGITS;c.push("		<rect ",this._getFillAttributes(l),' x="',h(i,f),'" y="',h(s,f),'" width="',h(n,f),'" height="',h(o,f),`"></rect>
`)},_setSVGTextLineBg:function(c,l,i,s){for(var n=this._textLines[l],o=this.getHeightOfLine(l)/this.lineHeight,f=0,a=0,d,p,v=this.getValueOfPropertyAt(l,0,"textBackgroundColor"),b=0,C=n.length;b<C;b++)d=this.__charBounds[l][b],p=this.getValueOfPropertyAt(l,b,"textBackgroundColor"),p!==v?(v&&this._pushTextBgRect(c,v,i+a,s,f,o),a=d.left,f=d.width,v=p):f+=d.kernedWidth;p&&this._pushTextBgRect(c,p,i+a,s,f,o)},_getFillAttributes:function(c){var l=c&&typeof c=="string"?new e.Color(c):"";return!l||!l.getSource()||l.getAlpha()===1?'fill="'+c+'"':'opacity="'+l.getAlpha()+'" fill="'+l.setAlpha(1).toRgb()+'"'},_getSVGLineTopOffset:function(c){for(var l=0,i=0,s=0;s<c;s++)l+=this.getHeightOfLine(s);return i=this.getHeightOfLine(s),{lineTop:l,offset:(this._fontSizeMult-this._fontSizeFraction)*i/(this.lineHeight*this._fontSizeMult)}},getSvgStyles:function(c){var l=e.Object.prototype.getSvgStyles.call(this,c);return l+" white-space: pre;"}})}(),function(h){var t=h.fabric||(h.fabric={});t.Textbox=t.util.createClass(t.IText,t.Observable,{type:"textbox",minWidth:20,dynamicMinWidth:2,__cachedLines:null,lockScalingFlip:!0,noScaleCache:!1,_dimensionAffectingProps:t.Text.prototype._dimensionAffectingProps.concat("width"),_wordJoiners:/[ \t\r]/,splitByGrapheme:!1,initDimensions:function(){this.__skipDimension||(this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),this.textAlign.indexOf("justify")!==-1&&this.enlargeSpaces(),this.height=this.calcTextHeight(),this.saveState({propertySet:"_dimensionAffectingProps"}))},_generateStyleMap:function(c){for(var l=0,i=0,s=0,n={},o=0;o<c.graphemeLines.length;o++)c.graphemeText[s]===`
`&&o>0?(i=0,s++,l++):!this.splitByGrapheme&&this._reSpaceAndTab.test(c.graphemeText[s])&&o>0&&(i++,s++),n[o]={line:l,offset:i},s+=c.graphemeLines[o].length,i+=c.graphemeLines[o].length;return n},styleHas:function(c,l){if(this._styleMap&&!this.isWrapping){var i=this._styleMap[l];i&&(l=i.line)}return t.Text.prototype.styleHas.call(this,c,l)},isEmptyStyles:function(c){if(!this.styles)return!0;var l=0,i=c+1,s,n,o=!1,f=this._styleMap[c],a=this._styleMap[c+1];f&&(c=f.line,l=f.offset),a&&(i=a.line,o=i===c,s=a.offset),n=typeof c>"u"?this.styles:{line:this.styles[c]};for(var d in n)for(var p in n[d])if(p>=l&&(!o||p<s))for(var v in n[d][p])return!1;return!0},_getStyleDeclaration:function(c,l){if(this._styleMap&&!this.isWrapping){var i=this._styleMap[c];if(!i)return null;c=i.line,l=i.offset+l}return this.callSuper("_getStyleDeclaration",c,l)},_setStyleDeclaration:function(c,l,i){var s=this._styleMap[c];c=s.line,l=s.offset+l,this.styles[c][l]=i},_deleteStyleDeclaration:function(c,l){var i=this._styleMap[c];c=i.line,l=i.offset+l,delete this.styles[c][l]},_getLineStyle:function(c){var l=this._styleMap[c];return!!this.styles[l.line]},_setLineStyle:function(c){var l=this._styleMap[c];this.styles[l.line]={}},_wrapText:function(c,l){var i=[],s;for(this.isWrapping=!0,s=0;s<c.length;s++)i=i.concat(this._wrapLine(c[s],s,l));return this.isWrapping=!1,i},_measureWord:function(c,l,i){var s=0,n,o=!0;i=i||0;for(var f=0,a=c.length;f<a;f++){var d=this._getGraphemeBox(c[f],l,f+i,n,o);s+=d.kernedWidth,n=c[f]}return s},_wrapLine:function(c,l,i,N){var n=0,o=this.splitByGrapheme,f=[],a=[],d=o?t.util.string.graphemeSplit(c):c.split(this._wordJoiners),p="",v=0,b=o?"":" ",C=0,w=0,S=0,E=!0,P=this._getWidthOfCharSpacing(),N=N||0;d.length===0&&d.push([]),i-=N;for(var K=0;K<d.length;K++)p=o?d[K]:t.util.string.graphemeSplit(d[K]),C=this._measureWord(p,l,v),v+=p.length,n+=w+C-P,n>i&&!E?(f.push(a),a=[],n=C,E=!0):n+=P,!E&&!o&&a.push(b),a=a.concat(p),w=o?0:this._measureWord([b],l,v),v++,E=!1,C>S&&(S=C);return K&&f.push(a),S+N>this.dynamicMinWidth&&(this.dynamicMinWidth=S-P+N),f},isEndOfWrapping:function(c){return!this._styleMap[c+1]||this._styleMap[c+1].line!==this._styleMap[c].line},missingNewlineOffset:function(c){return this.splitByGrapheme?this.isEndOfWrapping(c)?1:0:1},_splitTextIntoLines:function(c){for(var l=t.Text.prototype._splitTextIntoLines.call(this,c),i=this._wrapText(l.lines,this.width),s=new Array(i.length),n=0;n<i.length;n++)s[n]=i[n].join("");return l.lines=s,l.graphemeLines=i,l},getMinWidth:function(){return Math.max(this.minWidth,this.dynamicMinWidth)},_removeExtraneousStyles:function(){var c={};for(var l in this._styleMap)this._textLines[l]&&(c[this._styleMap[l].line]=1);for(var l in this.styles)c[l]||delete this.styles[l]},toObject:function(c){return this.callSuper("toObject",["minWidth","splitByGrapheme"].concat(c))}}),t.Textbox.fromObject=function(c,l){var i=t.util.stylesFromArray(c.styles,c.text),s=Object.assign({},c,{styles:i});return t.Object._fromObject("Textbox",s,l,"text")}}(r),function(){var h=e.controlsUtils,t=h.scaleSkewCursorStyleHandler,c=h.scaleCursorStyleHandler,l=h.scalingEqually,i=h.scalingYOrSkewingX,s=h.scalingXOrSkewingY,n=h.scaleOrSkewActionName,o=e.Object.prototype.controls;if(o.ml=new e.Control({x:-.5,y:0,cursorStyleHandler:t,actionHandler:s,getActionName:n}),o.mr=new e.Control({x:.5,y:0,cursorStyleHandler:t,actionHandler:s,getActionName:n}),o.mb=new e.Control({x:0,y:.5,cursorStyleHandler:t,actionHandler:i,getActionName:n}),o.mt=new e.Control({x:0,y:-.5,cursorStyleHandler:t,actionHandler:i,getActionName:n}),o.tl=new e.Control({x:-.5,y:-.5,cursorStyleHandler:c,actionHandler:l}),o.tr=new e.Control({x:.5,y:-.5,cursorStyleHandler:c,actionHandler:l}),o.bl=new e.Control({x:-.5,y:.5,cursorStyleHandler:c,actionHandler:l}),o.br=new e.Control({x:.5,y:.5,cursorStyleHandler:c,actionHandler:l}),o.mtr=new e.Control({x:0,y:-.5,actionHandler:h.rotationWithSnapping,cursorStyleHandler:h.rotationStyleHandler,offsetY:-40,withConnection:!0,actionName:"rotate"}),e.Textbox){var f=e.Textbox.prototype.controls={};f.mtr=o.mtr,f.tr=o.tr,f.br=o.br,f.tl=o.tl,f.bl=o.bl,f.mt=o.mt,f.mb=o.mb,f.mr=new e.Control({x:.5,y:0,actionHandler:h.changeWidth,cursorStyleHandler:t,actionName:"resizing"}),f.ml=new e.Control({x:-.5,y:0,actionHandler:h.changeWidth,cursorStyleHandler:t,actionName:"resizing"})}}()})(gt);const nt={Decorate:1,Background:2,Photo:3,Save:4,Drawing:5};var tc={grad:.9,turn:360,rad:360/(2*Math.PI)},it=function(r){return typeof r=="string"?r.length>0:typeof r=="number"},Ne=function(r,e,u){return e===void 0&&(e=0),u===void 0&&(u=Math.pow(10,e)),Math.round(u*r)/u+0},Ge=function(r,e,u){return e===void 0&&(e=0),u===void 0&&(u=1),r>u?u:r>e?r:e},bs=function(r){return(r=isFinite(r)?r%360:0)>0?r:r+360},zn=function(r){return{r:Ge(r.r,0,255),g:Ge(r.g,0,255),b:Ge(r.b,0,255),a:Ge(r.a)}},Fi=function(r){return{r:Ne(r.r),g:Ne(r.g),b:Ne(r.b),a:Ne(r.a,3)}},ic=/^#([0-9a-f]{3,8})$/i,ii=function(r){var e=r.toString(16);return e.length<2?"0"+e:e},Cs=function(r){var e=r.r,u=r.g,g=r.b,m=r.a,_=Math.max(e,u,g),y=_-Math.min(e,u,g),h=y?_===e?(u-g)/y:_===u?2+(g-e)/y:4+(e-u)/y:0;return{h:60*(h<0?h+6:h),s:_?y/_*100:0,v:_/255*100,a:m}},ws=function(r){var e=r.h,u=r.s,g=r.v,m=r.a;e=e/360*6,u/=100,g/=100;var _=Math.floor(e),y=g*(1-u),h=g*(1-(e-_)*u),t=g*(1-(1-e+_)*u),c=_%6;return{r:255*[g,h,y,y,t,g][c],g:255*[t,g,g,h,y,y][c],b:255*[y,y,t,g,g,h][c],a:m}},Yn=function(r){return{h:bs(r.h),s:Ge(r.s,0,100),l:Ge(r.l,0,100),a:Ge(r.a)}},Vn=function(r){return{h:Ne(r.h),s:Ne(r.s),l:Ne(r.l),a:Ne(r.a,3)}},Gn=function(r){return ws((u=(e=r).s,{h:e.h,s:(u*=((g=e.l)<50?g:100-g)/100)>0?2*u/(g+u)*100:0,v:g+u,a:e.a}));var e,u,g},qt=function(r){return{h:(e=Cs(r)).h,s:(m=(200-(u=e.s))*(g=e.v)/100)>0&&m<200?u*g/100/(m<=100?m:200-m)*100:0,l:m/2,a:e.a};var e,u,g,m},nc=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,rc=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,sc=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,ac=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Zi={string:[[function(r){var e=ic.exec(r);return e?(r=e[1]).length<=4?{r:parseInt(r[0]+r[0],16),g:parseInt(r[1]+r[1],16),b:parseInt(r[2]+r[2],16),a:r.length===4?Ne(parseInt(r[3]+r[3],16)/255,2):1}:r.length===6||r.length===8?{r:parseInt(r.substr(0,2),16),g:parseInt(r.substr(2,2),16),b:parseInt(r.substr(4,2),16),a:r.length===8?Ne(parseInt(r.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(r){var e=sc.exec(r)||ac.exec(r);return e?e[2]!==e[4]||e[4]!==e[6]?null:zn({r:Number(e[1])/(e[2]?100/255:1),g:Number(e[3])/(e[4]?100/255:1),b:Number(e[5])/(e[6]?100/255:1),a:e[7]===void 0?1:Number(e[7])/(e[8]?100:1)}):null},"rgb"],[function(r){var e=nc.exec(r)||rc.exec(r);if(!e)return null;var u,g,m=Yn({h:(u=e[1],g=e[2],g===void 0&&(g="deg"),Number(u)*(tc[g]||1)),s:Number(e[3]),l:Number(e[4]),a:e[5]===void 0?1:Number(e[5])/(e[6]?100:1)});return Gn(m)},"hsl"]],object:[[function(r){var e=r.r,u=r.g,g=r.b,m=r.a,_=m===void 0?1:m;return it(e)&&it(u)&&it(g)?zn({r:Number(e),g:Number(u),b:Number(g),a:Number(_)}):null},"rgb"],[function(r){var e=r.h,u=r.s,g=r.l,m=r.a,_=m===void 0?1:m;if(!it(e)||!it(u)||!it(g))return null;var y=Yn({h:Number(e),s:Number(u),l:Number(g),a:Number(_)});return Gn(y)},"hsl"],[function(r){var e=r.h,u=r.s,g=r.v,m=r.a,_=m===void 0?1:m;if(!it(e)||!it(u)||!it(g))return null;var y=function(h){return{h:bs(h.h),s:Ge(h.s,0,100),v:Ge(h.v,0,100),a:Ge(h.a)}}({h:Number(e),s:Number(u),v:Number(g),a:Number(_)});return ws(y)},"hsv"]]},qn=function(r,e){for(var u=0;u<e.length;u++){var g=e[u][0](r);if(g)return[g,e[u][1]]}return[null,void 0]},oc=function(r){return typeof r=="string"?qn(r.trim(),Zi.string):typeof r=="object"&&r!==null?qn(r,Zi.object):[null,void 0]},Ri=function(r,e){var u=qt(r);return{h:u.h,s:Ge(u.s+100*e,0,100),l:u.l,a:u.a}},Li=function(r){return(299*r.r+587*r.g+114*r.b)/1e3/255},Kn=function(r,e){var u=qt(r);return{h:u.h,s:u.s,l:Ge(u.l+100*e,0,100),a:u.a}},$i=function(){function r(e){this.parsed=oc(e)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return r.prototype.isValid=function(){return this.parsed!==null},r.prototype.brightness=function(){return Ne(Li(this.rgba),2)},r.prototype.isDark=function(){return Li(this.rgba)<.5},r.prototype.isLight=function(){return Li(this.rgba)>=.5},r.prototype.toHex=function(){return e=Fi(this.rgba),u=e.r,g=e.g,m=e.b,y=(_=e.a)<1?ii(Ne(255*_)):"","#"+ii(u)+ii(g)+ii(m)+y;var e,u,g,m,_,y},r.prototype.toRgb=function(){return Fi(this.rgba)},r.prototype.toRgbString=function(){return e=Fi(this.rgba),u=e.r,g=e.g,m=e.b,(_=e.a)<1?"rgba("+u+", "+g+", "+m+", "+_+")":"rgb("+u+", "+g+", "+m+")";var e,u,g,m,_},r.prototype.toHsl=function(){return Vn(qt(this.rgba))},r.prototype.toHslString=function(){return e=Vn(qt(this.rgba)),u=e.h,g=e.s,m=e.l,(_=e.a)<1?"hsla("+u+", "+g+"%, "+m+"%, "+_+")":"hsl("+u+", "+g+"%, "+m+"%)";var e,u,g,m,_},r.prototype.toHsv=function(){return e=Cs(this.rgba),{h:Ne(e.h),s:Ne(e.s),v:Ne(e.v),a:Ne(e.a,3)};var e},r.prototype.invert=function(){return We({r:255-(e=this.rgba).r,g:255-e.g,b:255-e.b,a:e.a});var e},r.prototype.saturate=function(e){return e===void 0&&(e=.1),We(Ri(this.rgba,e))},r.prototype.desaturate=function(e){return e===void 0&&(e=.1),We(Ri(this.rgba,-e))},r.prototype.grayscale=function(){return We(Ri(this.rgba,-1))},r.prototype.lighten=function(e){return e===void 0&&(e=.1),We(Kn(this.rgba,e))},r.prototype.darken=function(e){return e===void 0&&(e=.1),We(Kn(this.rgba,-e))},r.prototype.rotate=function(e){return e===void 0&&(e=15),this.hue(this.hue()+e)},r.prototype.alpha=function(e){return typeof e=="number"?We({r:(u=this.rgba).r,g:u.g,b:u.b,a:e}):Ne(this.rgba.a,3);var u},r.prototype.hue=function(e){var u=qt(this.rgba);return typeof e=="number"?We({h:e,s:u.s,l:u.l,a:u.a}):Ne(u.h)},r.prototype.isEqual=function(e){return this.toHex()===We(e).toHex()},r}(),We=function(r){return r instanceof $i?r:new $i(r)},Jn=[],lc=function(r){r.forEach(function(e){Jn.indexOf(e)<0&&(e($i,Zi),Jn.push(e))})},Bi=function(r){var e=r/255;return e<.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)},ji=function(r){return .2126*Bi(r.r)+.7152*Bi(r.g)+.0722*Bi(r.b)};function cc(r){r.prototype.luminance=function(){return e=ji(this.rgba),(u=2)===void 0&&(u=0),g===void 0&&(g=Math.pow(10,u)),Math.round(g*e)/g+0;var e,u,g},r.prototype.contrast=function(e){e===void 0&&(e="#FFF");var u,g,m,_,y,h,t,c=e instanceof r?e:new r(e);return _=this.rgba,y=c.toRgb(),h=ji(_),t=ji(y),u=h>t?(h+.05)/(t+.05):(t+.05)/(h+.05),(g=2)===void 0&&(g=0),m===void 0&&(m=Math.pow(10,g)),Math.floor(m*u)/m+0},r.prototype.isReadable=function(e,u){return e===void 0&&(e="#FFF"),u===void 0&&(u={}),this.contrast(e)>=(h=(y=(g=u).size)===void 0?"normal":y,(_=(m=g.level)===void 0?"AA":m)==="AAA"&&h==="normal"?7:_==="AA"&&h==="large"?3:4.5);var g,m,_,y,h}}const kt=[];function hc(r,e){return{subscribe:mt(r,e).subscribe}}function mt(r,e=ye){let u;const g=new Set;function m(h){if(xe(r,h)&&(r=h,u)){const t=!kt.length;for(const c of g)c[1](),kt.push(c,r);if(t){for(let c=0;c<kt.length;c+=2)kt[c][0](kt[c+1]);kt.length=0}}}function _(h){m(h(r))}function y(h,t=ye){const c=[h,t];return g.add(c),g.size===1&&(u=e(m)||ye),h(r),()=>{g.delete(c),g.size===0&&u&&(u(),u=null)}}return{set:m,update:_,subscribe:y}}function uc(r,e,u){const g=!Array.isArray(r),m=g?[r]:r,_=e.length<2;return hc(u,y=>{let h=!1;const t=[];let c=0,l=ye;const i=()=>{if(c)return;l();const n=e(g?t[0]:t,y);_?y(n):l=bi(n)?n:ye},s=m.map((n,o)=>fn(n,f=>{t[o]=f,c&=~(1<<o),h&&i()},()=>{c|=1<<o}));return h=!0,i(),function(){Me(s),l(),h=!1}})}const rt=mt({ArrowLeft:0,ArrowUp:0,ArrowRight:0,ArrowDown:0}),pn=uc(rt,r=>({...r,ArrowV:r.ArrowUp+r.ArrowDown,ArrowH:r.ArrowLeft+r.ArrowRight,ArrowVH:r.ArrowUp+r.ArrowDown+r.ArrowLeft+r.ArrowRight}));function mn(r,e=.001,u=.01){const _=Math.min(1,Math.max(1,r-50)/50);return e+(u-e)/2*(1-Math.cos(Math.PI*_))}const{window:Ut}=gn;function fc(r){let e,u,g,m,_,y;var h=r[2].pickerIndicator;function t(c){return{props:{pos:c[9],isDark:c[5],hex:We({h:c[3],s:c[0],v:c[1],a:1}).toHex()}}}return h&&(u=Oe(h,t(r))),{c(){var c,l;e=ee("div"),u&&be(u.$$.fragment),M(e,"class","picker svelte-uiwgvv"),M(e,"tabindex","0"),Ye(e,"--color-bg",r[8]),M(e,"aria-label","saturation and brightness picker (arrow keyboard navigation)"),M(e,"aria-valuemin",0),M(e,"aria-valuemax",100),M(e,"aria-valuetext",g="saturation "+((c=r[9].x)==null?void 0:c.toFixed())+"%, brightness "+((l=r[9].y)==null?void 0:l.toFixed())+"%")},m(c,l){ae(c,e,l),u&&ve(u,e,null),r[18](e),m=!0,_||(y=[ce(e,"mousedown",xt(Ze(r[10]))),ce(e,"touchstart",r[16]),ce(e,"touchmove",xt(Ze(r[16]))),ce(e,"touchend",r[16])],_=!0)},p(c,l){var s,n;const i={};if(l&512&&(i.pos=c[9]),l&32&&(i.isDark=c[5]),l&11&&(i.hex=We({h:c[3],s:c[0],v:c[1],a:1}).toHex()),l&4&&h!==(h=c[2].pickerIndicator)){if(u){Le();const o=u;fe(o.$$.fragment,1,0,()=>{_e(o,1)}),Be()}h?(u=Oe(h,t(c)),be(u.$$.fragment),le(u.$$.fragment,1),ve(u,e,null)):u=null}else h&&u.$set(i);(!m||l&256)&&Ye(e,"--color-bg",c[8]),(!m||l&512&&g!==(g="saturation "+((s=c[9].x)==null?void 0:s.toFixed())+"%, brightness "+((n=c[9].y)==null?void 0:n.toFixed())+"%"))&&M(e,"aria-valuetext",g)},i(c){m||(u&&le(u.$$.fragment,c),m=!0)},o(c){u&&fe(u.$$.fragment,c),m=!1},d(c){c&&se(e),u&&_e(u),r[18](null),_=!1,Me(y)}}}function dc(r){let e,u,g,m,_;var y=r[2].pickerWrapper;function h(t){return{props:{focused:t[7],toRight:t[4],$$slots:{default:[fc]},$$scope:{ctx:t}}}}return y&&(e=Oe(y,h(r))),{c(){e&&be(e.$$.fragment),u=tt()},m(t,c){e&&ve(e,t,c),ae(t,u,c),g=!0,m||(_=[ce(Ut,"mouseup",r[11]),ce(Ut,"mousedown",r[13]),ce(Ut,"mousemove",r[12]),ce(Ut,"keyup",r[14]),ce(Ut,"keydown",r[15])],m=!0)},p(t,[c]){const l={};if(c&128&&(l.focused=t[7]),c&16&&(l.toRight=t[4]),c&67109743&&(l.$$scope={dirty:c,ctx:t}),c&4&&y!==(y=t[2].pickerWrapper)){if(e){Le();const i=e;fe(i.$$.fragment,1,0,()=>{_e(i,1)}),Be()}y?(e=Oe(y,h(t)),be(e.$$.fragment),le(e.$$.fragment,1),ve(e,u.parentNode,u)):e=null}else y&&e.$set(l)},i(t){g||(e&&le(e.$$.fragment,t),g=!0)},o(t){e&&fe(e.$$.fragment,t),g=!1},d(t){t&&se(u),e&&_e(e,t),m=!1,Me(_)}}}function Qn(r,e,u){return Math.min(Math.max(e,r),u)}function gc(r,e,u){let g,m;De(r,rt,W=>u(22,g=W)),De(r,pn,W=>u(23,m=W));let{components:_}=e,{h:y}=e,{s:h}=e,{v:t}=e,{isOpen:c}=e,{toRight:l}=e,{isDark:i}=e,s,n=!1,o=!1,f,a,d,p={x:100,y:0};function v(W){let U={x:W.offsetX,y:W.offsetY},te=s.getBoundingClientRect().width,re=s.getBoundingClientRect().height;u(0,h=Qn(U.x/te,0,1)*100),u(1,t=Qn((re-U.y)/re,0,1)*100)}function b(W){W.button===0&&(n=!0,v(W))}function C(){n=!1}function w(W){n&&v({offsetX:Math.max(0,Math.min(s.getBoundingClientRect().width,W.clientX-s.getBoundingClientRect().left)),offsetY:Math.max(0,Math.min(s.getBoundingClientRect().height,W.clientY-s.getBoundingClientRect().top))})}function S(W){W.target.isSameNode(s)||u(7,o=!1)}function E(W){var U;W.key==="Tab"&&u(7,o=!!((U=document.activeElement)!=null&&U.isSameNode(s))),!W.repeat&&o&&N()}function P(W){o&&m.ArrowVH&&(W.preventDefault(),W.repeat||N())}function N(){m.ArrowVH?f||(a=0,f=window.setInterval(()=>{let W=mn(++a);u(0,h=Math.min(100,Math.max(0,h+(g.ArrowRight-g.ArrowLeft)*W*100))),u(1,t=Math.min(100,Math.max(0,t+(g.ArrowUp-g.ArrowDown)*W*100)))},10)):f&&(clearInterval(f),f=void 0)}function K(W){W.preventDefault(),v({offsetX:W.changedTouches[0].clientX-s.getBoundingClientRect().left,offsetY:W.changedTouches[0].clientY-s.getBoundingClientRect().top})}function Z(W){Se[W?"unshift":"push"](()=>{s=W,u(6,s)})}return r.$$set=W=>{"components"in W&&u(2,_=W.components),"h"in W&&u(3,y=W.h),"s"in W&&u(0,h=W.s),"v"in W&&u(1,t=W.v),"isOpen"in W&&u(17,c=W.isOpen),"toRight"in W&&u(4,l=W.toRight),"isDark"in W&&u(5,i=W.isDark)},r.$$.update=()=>{r.$$.dirty&8&&typeof y=="number"&&u(8,d=We({h:y,s:100,v:100,a:1}).toHex()),r.$$.dirty&67&&typeof h=="number"&&typeof t=="number"&&s&&u(9,p={x:h,y:100-t})},[h,t,_,y,l,i,s,o,d,p,b,C,w,S,E,P,K,c,Z]}class pc extends Ae{constructor(e){super(),Ee(this,e,gc,dc,xe,{components:2,h:3,s:0,v:1,isOpen:17,toRight:4,isDark:5})}}const{window:ni}=gn;function mc(r){let e,u,g,m,_,y;var h=r[1].sliderIndicator;function t(c){return{props:{pos:c[4],toRight:c[2]}}}return h&&(u=Oe(h,t(r))),{c(){e=ee("div"),u&&be(u.$$.fragment),M(e,"class","slider svelte-14nweqy"),M(e,"tabindex","0"),M(e,"aria-label","hue picker (arrow keyboard navigation)"),M(e,"aria-valuemin",0),M(e,"aria-valuemax",360),M(e,"aria-valuenow",g=Math.round(r[0])),Re(e,"to-right",r[2])},m(c,l){ae(c,e,l),u&&ve(u,e,null),r[12](e),m=!0,_||(y=[ce(e,"mousedown",xt(Ze(r[6]))),ce(e,"touchstart",r[11]),ce(e,"touchmove",xt(Ze(r[11]))),ce(e,"touchend",r[11])],_=!0)},p(c,l){const i={};if(l&16&&(i.pos=c[4]),l&4&&(i.toRight=c[2]),l&2&&h!==(h=c[1].sliderIndicator)){if(u){Le();const s=u;fe(s.$$.fragment,1,0,()=>{_e(s,1)}),Be()}h?(u=Oe(h,t(c)),be(u.$$.fragment),le(u.$$.fragment,1),ve(u,e,null)):u=null}else h&&u.$set(i);(!m||l&1&&g!==(g=Math.round(c[0])))&&M(e,"aria-valuenow",g),(!m||l&4)&&Re(e,"to-right",c[2])},i(c){m||(u&&le(u.$$.fragment,c),m=!0)},o(c){u&&fe(u.$$.fragment,c),m=!1},d(c){c&&se(e),u&&_e(u),r[12](null),_=!1,Me(y)}}}function vc(r){let e,u,g,m,_;var y=r[1].sliderWrapper;function h(t){return{props:{focused:t[5],toRight:t[2],$$slots:{default:[mc]},$$scope:{ctx:t}}}}return y&&(e=Oe(y,h(r))),{c(){e&&be(e.$$.fragment),u=tt()},m(t,c){e&&ve(e,t,c),ae(t,u,c),g=!0,m||(_=[ce(ni,"mouseup",r[7]),ce(ni,"mousemove",r[8]),ce(ni,"keyup",r[9]),ce(ni,"keydown",r[10])],m=!0)},p(t,[c]){const l={};if(c&32&&(l.focused=t[5]),c&4&&(l.toRight=t[2]),c&1048607&&(l.$$scope={dirty:c,ctx:t}),c&2&&y!==(y=t[1].sliderWrapper)){if(e){Le();const i=e;fe(i.$$.fragment,1,0,()=>{_e(i,1)}),Be()}y?(e=Oe(y,h(t)),be(e.$$.fragment),le(e.$$.fragment,1),ve(e,u.parentNode,u)):e=null}else y&&e.$set(l)},i(t){g||(e&&le(e.$$.fragment,t),g=!0)},o(t){e&&fe(e.$$.fragment,t),g=!1},d(t){t&&se(u),e&&_e(e,t),m=!1,Me(_)}}}function _c(r,e,u){let g,m;De(r,rt,S=>u(16,g=S)),De(r,pn,S=>u(17,m=S));let{components:_}=e,{toRight:y}=e,h,t=!1,{h:c}=e,l=0,i=!1,s,n;function o(S){const E=y?h.getBoundingClientRect().width:h.getBoundingClientRect().height,P=Math.max(0,Math.min(E,S));u(0,c=P/E*360)}function f(S){S.button===0&&(t=!0,o(y?S.offsetX:S.offsetY))}function a(){t=!1}function d(S){t&&o(y?S.clientX-h.getBoundingClientRect().left:S.clientY-h.getBoundingClientRect().top)}function p(S){var E;S.key==="Tab"&&u(5,i=!!((E=document.activeElement)!=null&&E.isSameNode(h))),!S.repeat&&i&&b()}function v(S){i&&m.ArrowVH&&(S.preventDefault(),S.repeat||b())}function b(){m.ArrowVH?s||(n=0,s=window.setInterval(()=>{const S=mn(++n),E=y?g.ArrowRight-g.ArrowLeft:g.ArrowDown-g.ArrowUp;u(0,c=Math.min(360,Math.max(0,c+E*360*S)))},10)):s&&(clearInterval(s),s=void 0)}function C(S){S.preventDefault(),o(y?S.changedTouches[0].clientX-h.getBoundingClientRect().left:S.changedTouches[0].clientY-h.getBoundingClientRect().top)}function w(S){Se[S?"unshift":"push"](()=>{h=S,u(3,h)})}return r.$$set=S=>{"components"in S&&u(1,_=S.components),"toRight"in S&&u(2,y=S.toRight),"h"in S&&u(0,c=S.h)},r.$$.update=()=>{r.$$.dirty&9&&typeof c=="number"&&h&&u(4,l=100*c/360)},[c,_,y,h,l,i,f,a,d,p,v,C,w]}class yc extends Ae{constructor(e){super(),Ee(this,e,_c,vc,xe,{components:1,toRight:2,h:0})}}const{window:ri}=gn;function bc(r){let e,u,g,m,_,y,h;var t=r[0].alphaIndicator;function c(l){return{props:{pos:l[5],toRight:l[2]}}}return t&&(u=Oe(t,c(r))),{c(){var l,i;e=ee("div"),u&&be(u.$$.fragment),M(e,"class","alpha svelte-f2vq53"),M(e,"tabindex","0"),Ye(e,"--alpha-color",(l=r[1])==null?void 0:l.substring(0,7)),M(e,"aria-label","transparency picker (arrow keyboard navigation)"),M(e,"aria-valuemin",0),M(e,"aria-valuemax",100),M(e,"aria-valuenow",g=Math.round(r[5])),M(e,"aria-valuetext",m=((i=r[5])==null?void 0:i.toFixed())+"%"),Re(e,"to-right",r[2])},m(l,i){ae(l,e,i),u&&ve(u,e,null),r[14](e),_=!0,y||(h=[ce(e,"mousedown",xt(Ze(r[6]))),ce(e,"touchstart",r[11]),ce(e,"touchmove",xt(Ze(r[11]))),ce(e,"touchend",r[11])],y=!0)},p(l,i){var n,o;const s={};if(i&32&&(s.pos=l[5]),i&4&&(s.toRight=l[2]),i&1&&t!==(t=l[0].alphaIndicator)){if(u){Le();const f=u;fe(f.$$.fragment,1,0,()=>{_e(f,1)}),Be()}t?(u=Oe(t,c(l)),be(u.$$.fragment),le(u.$$.fragment,1),ve(u,e,null)):u=null}else t&&u.$set(s);(!_||i&2)&&Ye(e,"--alpha-color",(n=l[1])==null?void 0:n.substring(0,7)),(!_||i&32&&g!==(g=Math.round(l[5])))&&M(e,"aria-valuenow",g),(!_||i&32&&m!==(m=((o=l[5])==null?void 0:o.toFixed())+"%"))&&M(e,"aria-valuetext",m),(!_||i&4)&&Re(e,"to-right",l[2])},i(l){_||(u&&le(u.$$.fragment,l),_=!0)},o(l){u&&fe(u.$$.fragment,l),_=!1},d(l){l&&se(e),u&&_e(u),r[14](null),y=!1,Me(h)}}}function Cc(r){let e,u,g,m,_;var y=r[0].alphaWrapper;function h(t){return{props:{focused:t[4],toRight:t[2],$$slots:{default:[bc]},$$scope:{ctx:t}}}}return y&&(e=Oe(y,h(r))),{c(){e&&be(e.$$.fragment),u=tt()},m(t,c){e&&ve(e,t,c),ae(t,u,c),g=!0,m||(_=[ce(ri,"mouseup",r[7]),ce(ri,"mousemove",r[8]),ce(ri,"keyup",r[9]),ce(ri,"keydown",r[10])],m=!0)},p(t,[c]){const l={};if(c&16&&(l.focused=t[4]),c&4&&(l.toRight=t[2]),c&4194351&&(l.$$scope={dirty:c,ctx:t}),c&1&&y!==(y=t[0].alphaWrapper)){if(e){Le();const i=e;fe(i.$$.fragment,1,0,()=>{_e(i,1)}),Be()}y?(e=Oe(y,h(t)),be(e.$$.fragment),le(e.$$.fragment,1),ve(e,u.parentNode,u)):e=null}else y&&e.$set(l)},i(t){g||(e&&le(e.$$.fragment,t),g=!0)},o(t){e&&fe(e.$$.fragment,t),g=!1},d(t){t&&se(u),e&&_e(e,t),m=!1,Me(_)}}}function wc(r,e,u){let g,m;De(r,rt,P=>u(18,g=P)),De(r,pn,P=>u(19,m=P));let{components:_}=e,{isOpen:y}=e,{a:h=1}=e,{hex:t}=e,{toRight:c}=e,l,i=!1,s=!1,n,o,f;function a(P){const N=c?l.getBoundingClientRect().width:l.getBoundingClientRect().height,K=Math.max(0,Math.min(N,P));u(12,h=K/N)}function d(P){P.button===0&&(i=!0,a(c?P.offsetX:P.offsetY))}function p(){i=!1}function v(P){i&&a(c?P.clientX-l.getBoundingClientRect().left:P.clientY-l.getBoundingClientRect().top)}function b(P){var N;P.key==="Tab"&&u(4,s=!!((N=document.activeElement)!=null&&N.isSameNode(l))),!P.repeat&&s&&w()}function C(P){s&&m.ArrowVH&&(P.preventDefault(),P.repeat||w())}function w(){m.ArrowVH?n||(o=0,n=window.setInterval(()=>{const P=mn(++o),N=c?g.ArrowRight-g.ArrowLeft:g.ArrowDown-g.ArrowUp;u(12,h=Math.min(1,Math.max(0,h+N*P)))},10)):n&&(clearInterval(n),n=void 0)}function S(P){P.preventDefault(),a(c?P.changedTouches[0].clientX-l.getBoundingClientRect().left:P.changedTouches[0].clientY-l.getBoundingClientRect().top)}function E(P){Se[P?"unshift":"push"](()=>{l=P,u(3,l)})}return r.$$set=P=>{"components"in P&&u(0,_=P.components),"isOpen"in P&&u(13,y=P.isOpen),"a"in P&&u(12,h=P.a),"hex"in P&&u(1,t=P.hex),"toRight"in P&&u(2,c=P.toRight)},r.$$.update=()=>{r.$$.dirty&4104&&typeof h=="number"&&l&&u(5,f=100*h)},[_,t,c,l,s,f,d,p,v,b,C,S,h,y,E]}class Sc extends Ae{constructor(e){super(),Ee(this,e,wc,Cc,xe,{components:0,isOpen:13,a:12,hex:1,toRight:2})}}function Tc(r){let e,u,g,m,_,y,h,t,c,l=r[2]&&Zn(r);return{c(){e=ee("div"),u=ee("input"),g=ge(),m=ee("input"),_=ge(),y=ee("input"),h=ge(),l&&l.c(),M(u,"aria-label","hue chanel color"),u.value=r[8],M(u,"type","number"),M(u,"min","0"),M(u,"max","360"),M(u,"class","svelte-11z4jba"),M(m,"aria-label","saturation chanel color"),m.value=r[7],M(m,"type","number"),M(m,"min","0"),M(m,"max","100"),M(m,"class","svelte-11z4jba"),M(y,"aria-label","brightness chanel color"),y.value=r[6],M(y,"type","number"),M(y,"min","0"),M(y,"max","100"),M(y,"class","svelte-11z4jba"),M(e,"class","input-container svelte-11z4jba")},m(i,s){ae(i,e,s),q(e,u),q(e,g),q(e,m),q(e,_),q(e,y),q(e,h),l&&l.m(e,null),t||(c=[ce(u,"input",r[12]("h")),ce(m,"input",r[12]("s")),ce(y,"input",r[12]("v"))],t=!0)},p(i,s){s&256&&u.value!==i[8]&&(u.value=i[8]),s&128&&m.value!==i[7]&&(m.value=i[7]),s&64&&y.value!==i[6]&&(y.value=i[6]),i[2]?l?l.p(i,s):(l=Zn(i),l.c(),l.m(e,null)):l&&(l.d(1),l=null)},d(i){i&&se(e),l&&l.d(),t=!1,Me(c)}}}function xc(r){let e,u,g,m,_,y,h,t,c,l,i,s,n=r[2]&&$n(r);return{c(){e=ee("div"),u=ee("input"),m=ge(),_=ee("input"),h=ge(),t=ee("input"),l=ge(),n&&n.c(),M(u,"aria-label","red chanel color"),u.value=g=r[0].r,M(u,"type","number"),M(u,"min","0"),M(u,"max","255"),M(u,"class","svelte-11z4jba"),M(_,"aria-label","green chanel color"),_.value=y=r[0].g,M(_,"type","number"),M(_,"min","0"),M(_,"max","255"),M(_,"class","svelte-11z4jba"),M(t,"aria-label","blue chanel color"),t.value=c=r[0].b,M(t,"type","number"),M(t,"min","0"),M(t,"max","255"),M(t,"class","svelte-11z4jba"),M(e,"class","input-container svelte-11z4jba")},m(o,f){ae(o,e,f),q(e,u),q(e,m),q(e,_),q(e,h),q(e,t),q(e,l),n&&n.m(e,null),i||(s=[ce(u,"input",r[11]("r")),ce(_,"input",r[11]("g")),ce(t,"input",r[11]("b"))],i=!0)},p(o,f){f&1&&g!==(g=o[0].r)&&u.value!==g&&(u.value=g),f&1&&y!==(y=o[0].g)&&_.value!==y&&(_.value=y),f&1&&c!==(c=o[0].b)&&t.value!==c&&(t.value=c),o[2]?n?n.p(o,f):(n=$n(o),n.c(),n.m(e,null)):n&&(n.d(1),n=null)},d(o){o&&se(e),n&&n.d(),i=!1,Me(s)}}}function Oc(r){let e,u,g,m,_,y=r[2]&&er(r);return{c(){e=ee("div"),u=ee("input"),g=ge(),y&&y.c(),u.value=r[1],Ye(u,"flex","3"),M(u,"class","svelte-11z4jba"),M(e,"class","input-container svelte-11z4jba")},m(h,t){ae(h,e,t),q(e,u),q(e,g),y&&y.m(e,null),m||(_=ce(u,"input",r[10]),m=!0)},p(h,t){t&2&&u.value!==h[1]&&(u.value=h[1]),h[2]?y?y.p(h,t):(y=er(h),y.c(),y.m(e,null)):y&&(y.d(1),y=null)},d(h){h&&se(e),y&&y.d(),m=!1,_()}}}function Zn(r){let e,u,g;return{c(){e=ee("input"),M(e,"aria-label","transparency chanel color"),e.value=r[5],M(e,"type","number"),M(e,"min","0"),M(e,"max","1"),M(e,"step","0.01"),M(e,"class","svelte-11z4jba")},m(m,_){ae(m,e,_),u||(g=ce(e,"input",r[12]("a")),u=!0)},p(m,_){_&32&&e.value!==m[5]&&(e.value=m[5])},d(m){m&&se(e),u=!1,g()}}}function $n(r){let e,u,g;return{c(){e=ee("input"),M(e,"aria-label","transparency chanel color"),e.value=r[5],M(e,"type","number"),M(e,"min","0"),M(e,"max","1"),M(e,"step","0.01"),M(e,"class","svelte-11z4jba")},m(m,_){ae(m,e,_),u||(g=ce(e,"input",r[11]("a")),u=!0)},p(m,_){_&32&&e.value!==m[5]&&(e.value=m[5])},d(m){m&&se(e),u=!1,g()}}}function er(r){let e,u,g;return{c(){e=ee("input"),M(e,"aria-label","hexadecimal color"),e.value=r[5],M(e,"type","number"),M(e,"min","0"),M(e,"max","1"),M(e,"step","0.01"),M(e,"class","svelte-11z4jba")},m(m,_){ae(m,e,_),u||(g=ce(e,"input",r[11]("a")),u=!0)},p(m,_){_&32&&e.value!==m[5]&&(e.value=m[5])},d(m){m&&se(e),u=!1,g()}}}function tr(r){let e,u=r[9][r[4]]+"",g,m,_,y;return{c(){e=ee("button"),g=Ke(u),M(e,"aria-label",m="change inputs to "+r[9][(r[4]+1)%3]),M(e,"class","svelte-11z4jba")},m(h,t){ae(h,e,t),q(e,g),_||(y=ce(e,"click",r[14]),_=!0)},p(h,t){t&16&&u!==(u=h[9][h[4]]+"")&&Ot(g,u),t&16&&m!==(m="change inputs to "+h[9][(h[4]+1)%3])&&M(e,"aria-label",m)},d(h){h&&se(e),_=!1,y()}}}function Ec(r){let e,u;function g(h,t){return h[4]===0?Oc:h[4]===1?xc:Tc}let m=g(r),_=m(r),y=r[3]&&tr(r);return{c(){e=ee("div"),_.c(),u=ge(),y&&y.c(),M(e,"class","text-input svelte-11z4jba")},m(h,t){ae(h,e,t),_.m(e,null),q(e,u),y&&y.m(e,null)},p(h,[t]){m===(m=g(h))&&_?_.p(h,t):(_.d(1),_=m(h),_&&(_.c(),_.m(e,u))),h[3]?y?y.p(h,t):(y=tr(h),y.c(),y.m(e,null)):y&&(y.d(1),y=null)},i:ye,o:ye,d(h){h&&se(e),_.d(),y&&y.d()}}}const Ac=/^#?([A-F0-9]{6}|[A-F0-9]{8})$/i;function kc(r,e,u){let g,m,_,y,{isAlpha:h}=e,{rgb:t}=e,{hsv:c}=e,{hex:l}=e,{canChangeMode:i}=e;const s=["HEX","RGB","HSV"];let n=0;function o(p){const v=p.target;Ac.test(v.value)&&u(1,l=v.value)}function f(p){return function(v){u(0,t={...t,[p]:parseFloat(v.target.value)})}}function a(p){return function(v){u(13,c={...c,[p]:parseFloat(v.target.value)})}}const d=()=>u(4,n=(n+1)%3);return r.$$set=p=>{"isAlpha"in p&&u(2,h=p.isAlpha),"rgb"in p&&u(0,t=p.rgb),"hsv"in p&&u(13,c=p.hsv),"hex"in p&&u(1,l=p.hex),"canChangeMode"in p&&u(3,i=p.canChangeMode)},r.$$.update=()=>{r.$$.dirty&8192&&u(8,g=Math.round(c.h)),r.$$.dirty&8192&&u(7,m=Math.round(c.s)),r.$$.dirty&8192&&u(6,_=Math.round(c.v)),r.$$.dirty&8192&&u(5,y=c.a===void 0?1:Math.round(c.a*100)/100)},[t,l,h,i,n,y,_,m,g,s,o,f,a,c,d]}class Dc extends Ae{constructor(e){super(),Ee(this,e,kc,Ec,xe,{isAlpha:2,rgb:0,hsv:13,hex:1,canChangeMode:3})}}function Pc(r){let e,u;return{c(){e=ee("div"),M(e,"class","slider-indicator svelte-htgglv"),M(e,"style",u=`top: calc(${r[0]/200*186}% + 2px);`)},m(g,m){ae(g,e,m)},p(g,[m]){m&1&&u!==(u=`top: calc(${g[0]/200*186}% + 2px);`)&&M(e,"style",u)},i:ye,o:ye,d(g){g&&se(e)}}}function Mc(r,e,u){let{pos:g}=e,{toRight:m}=e;return r.$$set=_=>{"pos"in _&&u(0,g=_.pos),"toRight"in _&&u(1,m=_.toRight)},[g,m]}class ir extends Ae{constructor(e){super(),Ee(this,e,Mc,Pc,xe,{pos:0,toRight:1})}}function Ic(r){let e,u;return{c(){e=ee("div"),M(e,"class","picker-indicator svelte-1nw247x"),M(e,"style",u=`left: calc(${r[0].x/200*186}% + 2px); top: calc(${r[0].y/200*186}% + 2px); box-shadow: 0 0 4px ${r[1]?"white":"black"};`)},m(g,m){ae(g,e,m)},p(g,[m]){m&3&&u!==(u=`left: calc(${g[0].x/200*186}% + 2px); top: calc(${g[0].y/200*186}% + 2px); box-shadow: 0 0 4px ${g[1]?"white":"black"};`)&&M(e,"style",u)},i:ye,o:ye,d(g){g&&se(e)}}}function Fc(r,e,u){let{pos:g}=e,{hex:m}=e,{isDark:_}=e;return r.$$set=y=>{"pos"in y&&u(0,g=y.pos),"hex"in y&&u(2,m=y.hex),"isDark"in y&&u(1,_=y.isDark)},[g,_,m]}class Rc extends Ae{constructor(e){super(),Ee(this,e,Fc,Ic,xe,{pos:0,hex:2,isDark:1})}}function Lc(r){let e,u;return{c:ye,m(g,m){e||(u=[ce(window,"keyup",r[0]),ce(window,"keydown",r[1])],e=!0)},p:ye,i:ye,o:ye,d(g){e=!1,Me(u)}}}function Bc(r,e,u){let g;De(r,rt,y=>u(2,g=y));function m(y){["ArrowLeft","ArrowUp","ArrowRight","ArrowDown"].includes(y.key)&&(Xe(rt,g[y.key]=0,g),rt.set(g))}function _(y){["ArrowLeft","ArrowUp","ArrowRight","ArrowDown"].includes(y.key)&&(y.repeat||(Xe(rt,g[y.key]=1,g),rt.set(g)))}return[m,_]}class jc extends Ae{constructor(e){super(),Ee(this,e,Bc,Lc,xe,{})}}function Nc(r){let e,u;const g=r[3].default,m=It(g,r,r[2],null);return{c(){e=ee("div"),m&&m.c(),M(e,"class","picker-wrapper svelte-1isc651"),Re(e,"focused",r[0])},m(_,y){ae(_,e,y),m&&m.m(e,null),u=!0},p(_,[y]){m&&m.p&&(!u||y&4)&&Rt(m,g,_,_[2],u?Ft(g,_[2],y,null):Lt(_[2]),null),(!u||y&1)&&Re(e,"focused",_[0])},i(_){u||(le(m,_),u=!0)},o(_){fe(m,_),u=!1},d(_){_&&se(e),m&&m.d(_)}}}function Hc(r,e,u){let{$$slots:g={},$$scope:m}=e,{focused:_}=e,{toRight:y}=e;return r.$$set=h=>{"focused"in h&&u(0,_=h.focused),"toRight"in h&&u(1,y=h.toRight),"$$scope"in h&&u(2,m=h.$$scope)},[_,y,m,g]}class Wc extends Ae{constructor(e){super(),Ee(this,e,Hc,Nc,xe,{focused:0,toRight:1})}}function Xc(r){let e,u;const g=r[3].default,m=It(g,r,r[2],null);return{c(){e=ee("div"),m&&m.c(),M(e,"class","slider-wrapper svelte-1udewng"),Re(e,"focused",r[0])},m(_,y){ae(_,e,y),m&&m.m(e,null),u=!0},p(_,[y]){m&&m.p&&(!u||y&4)&&Rt(m,g,_,_[2],u?Ft(g,_[2],y,null):Lt(_[2]),null),(!u||y&1)&&Re(e,"focused",_[0])},i(_){u||(le(m,_),u=!0)},o(_){fe(m,_),u=!1},d(_){_&&se(e),m&&m.d(_)}}}function Uc(r,e,u){let{$$slots:g={},$$scope:m}=e,{focused:_}=e,{toRight:y}=e;return r.$$set=h=>{"focused"in h&&u(0,_=h.focused),"toRight"in h&&u(1,y=h.toRight),"$$scope"in h&&u(2,m=h.$$scope)},[_,y,m,g]}class nr extends Ae{constructor(e){super(),Ee(this,e,Uc,Xc,xe,{focused:0,toRight:1})}}function zc(r){let e,u,g,m,_,y,h,t,c,l,i;return{c(){e=ee("label"),u=ee("div"),g=ee("input"),m=ge(),_=ee("div"),y=ge(),h=ee("div"),t=ge(),c=Ke(r[2]),M(g,"type","color"),g.value=r[1],M(g,"aria-haspopup","dialog"),M(g,"class","svelte-2ybi8r"),M(_,"class","alpha svelte-2ybi8r"),M(h,"class","color svelte-2ybi8r"),Ye(h,"background",r[1]),M(u,"class","container svelte-2ybi8r"),M(e,"class","svelte-2ybi8r")},m(s,n){ae(s,e,n),q(e,u),q(u,g),q(u,m),q(u,_),q(u,y),q(u,h),q(e,t),q(e,c),r[4](e),l||(i=[ce(g,"click",Ze(Yc)),ce(g,"mousedown",Ze(Vc)),ce(e,"click",Ze(Gc)),ce(e,"mousedown",Ze(qc))],l=!0)},p(s,[n]){n&2&&(g.value=s[1]),n&2&&Ye(h,"background",s[1]),n&4&&Ot(c,s[2])},i:ye,o:ye,d(s){s&&se(e),r[4](null),l=!1,Me(i)}}}const Yc=()=>{},Vc=()=>{},Gc=()=>{},qc=()=>{};function Kc(r,e,u){let{labelWrapper:g}=e,{hex:m}=e,{label:_}=e,{isOpen:y}=e;function h(t){Se[t?"unshift":"push"](()=>{g=t,u(0,g)})}return r.$$set=t=>{"labelWrapper"in t&&u(0,g=t.labelWrapper),"hex"in t&&u(1,m=t.hex),"label"in t&&u(2,_=t.label),"isOpen"in t&&u(3,y=t.isOpen)},[g,m,_,y,h]}class Jc extends Ae{constructor(e){super(),Ee(this,e,Kc,zc,xe,{labelWrapper:0,hex:1,label:2,isOpen:3})}}function Qc(r){let e,u,g;const m=r[5].default,_=It(m,r,r[4],null);return{c(){e=ee("div"),_&&_.c(),M(e,"class","wrapper svelte-160vdtq"),M(e,"role",u=r[2]?"dialog":void 0),M(e,"aria-label","color picker"),Re(e,"isOpen",r[1]),Re(e,"isPopup",r[2])},m(y,h){ae(y,e,h),_&&_.m(e,null),r[6](e),g=!0},p(y,[h]){_&&_.p&&(!g||h&16)&&Rt(_,m,y,y[4],g?Ft(m,y[4],h,null):Lt(y[4]),null),(!g||h&4&&u!==(u=y[2]?"dialog":void 0))&&M(e,"role",u),(!g||h&2)&&Re(e,"isOpen",y[1]),(!g||h&4)&&Re(e,"isPopup",y[2])},i(y){g||(le(_,y),g=!0)},o(y){fe(_,y),g=!1},d(y){y&&se(e),_&&_.d(y),r[6](null)}}}function Zc(r,e,u){let{$$slots:g={},$$scope:m}=e,{wrapper:_}=e,{isOpen:y}=e,{isPopup:h}=e,{toRight:t}=e;function c(l){Se[l?"unshift":"push"](()=>{_=l,u(0,_)})}return r.$$set=l=>{"wrapper"in l&&u(0,_=l.wrapper),"isOpen"in l&&u(1,y=l.isOpen),"isPopup"in l&&u(2,h=l.isPopup),"toRight"in l&&u(3,t=l.toRight),"$$scope"in l&&u(4,m=l.$$scope)},[_,y,h,t,m,g,c]}class $c extends Ae{constructor(e){super(),Ee(this,e,Zc,Qc,xe,{wrapper:0,isOpen:1,isPopup:2,toRight:3})}}function rr(r,e,u){const g=r.slice();return g[9]=e[u].contrast,g[10]=e[u].hex,g[11]=e[u].placeholder,g[12]=e[u].reverse,g[13]=e[u].size,g}function sr(r){let e,u,g;var m=r[0].a11ySingleNotice;function _(y){return{props:{contrast:y[9],textColor:y[12]?y[10]:y[1],bgColor:y[12]?y[1]:y[10],placeholder:y[11],size:y[13]}}}return m&&(e=Oe(m,_(r))),{c(){e&&be(e.$$.fragment),u=tt()},m(y,h){e&&ve(e,y,h),ae(y,u,h),g=!0},p(y,h){const t={};if(h&16&&(t.contrast=y[9]),h&18&&(t.textColor=y[12]?y[10]:y[1]),h&18&&(t.bgColor=y[12]?y[1]:y[10]),h&16&&(t.placeholder=y[11]),h&16&&(t.size=y[13]),h&1&&m!==(m=y[0].a11ySingleNotice)){if(e){Le();const c=e;fe(c.$$.fragment,1,0,()=>{_e(c,1)}),Be()}m?(e=Oe(m,_(y)),be(e.$$.fragment),le(e.$$.fragment,1),ve(e,u.parentNode,u)):e=null}else m&&e.$set(t)},i(y){g||(e&&le(e.$$.fragment,y),g=!0)},o(y){e&&fe(e.$$.fragment,y),g=!1},d(y){y&&se(u),e&&_e(e,y)}}}function ar(r){let e;return{c(){e=ee("span"),M(e,"class","svelte-1s4dluu")},m(u,g){ae(u,e,g),e.innerHTML=r[2]},p(u,g){g&4&&(e.innerHTML=u[2])},d(u){u&&se(e)}}}function eh(r){let e,u,g,m,_,y,h,t,c;var l=r[0].a11ySummary;function i(a){return{props:{a11yColors:a[4],hex:a[1]}}}l&&(g=Oe(l,i(r)));let s=r[4],n=[];for(let a=0;a<s.length;a+=1)n[a]=sr(rr(r,s,a));const o=a=>fe(n[a],1,1,()=>{n[a]=null});let f=r[2]&&ar(r);return{c(){e=ee("details"),u=ee("summary"),g&&be(g.$$.fragment),_=ge(),y=ee("div");for(let a=0;a<n.length;a+=1)n[a].c();h=ge(),f&&f.c(),M(u,"tabindex",m=r[5]?-1:void 0),M(u,"class","svelte-1s4dluu"),M(y,"class","svelte-1s4dluu"),M(e,"class",t="a11y-notice "+(r[5]?"not-closable":"")+" svelte-1s4dluu"),e.open=r[3]},m(a,d){ae(a,e,d),q(e,u),g&&ve(g,u,null),q(e,_),q(e,y);for(let p=0;p<n.length;p+=1)n[p]&&n[p].m(y,null);q(y,h),f&&f.m(y,null),c=!0},p(a,[d]){const p={};if(d&16&&(p.a11yColors=a[4]),d&2&&(p.hex=a[1]),d&1&&l!==(l=a[0].a11ySummary)){if(g){Le();const v=g;fe(v.$$.fragment,1,0,()=>{_e(v,1)}),Be()}l?(g=Oe(l,i(a)),be(g.$$.fragment),le(g.$$.fragment,1),ve(g,u,null)):g=null}else l&&g.$set(p);if((!c||d&32&&m!==(m=a[5]?-1:void 0))&&M(u,"tabindex",m),d&19){s=a[4];let v;for(v=0;v<s.length;v+=1){const b=rr(a,s,v);n[v]?(n[v].p(b,d),le(n[v],1)):(n[v]=sr(b),n[v].c(),le(n[v],1),n[v].m(y,h))}for(Le(),v=s.length;v<n.length;v+=1)o(v);Be()}a[2]?f?f.p(a,d):(f=ar(a),f.c(),f.m(y,null)):f&&(f.d(1),f=null),(!c||d&32&&t!==(t="a11y-notice "+(a[5]?"not-closable":"")+" svelte-1s4dluu"))&&M(e,"class",t),(!c||d&8)&&(e.open=a[3])},i(a){if(!c){g&&le(g.$$.fragment,a);for(let d=0;d<s.length;d+=1)le(n[d]);c=!0}},o(a){g&&fe(g.$$.fragment,a),n=n.filter(Boolean);for(let d=0;d<n.length;d+=1)fe(n[d]);c=!1},d(a){a&&se(e),g&&_e(g),Bt(n,a),f&&f.d()}}}function th(r,e,u){let g,m,{components:_}=e,{a11yColors:y}=e,{hex:h}=e,{color:t}=e,{a11yGuidelines:c}=e,{isA11yOpen:l}=e,{isA11yClosable:i}=e;return r.$$set=s=>{"components"in s&&u(0,_=s.components),"a11yColors"in s&&u(6,y=s.a11yColors),"hex"in s&&u(1,h=s.hex),"color"in s&&u(7,t=s.color),"a11yGuidelines"in s&&u(2,c=s.a11yGuidelines),"isA11yOpen"in s&&u(3,l=s.isA11yOpen),"isA11yClosable"in s&&u(8,i=s.isA11yClosable)},r.$$.update=()=>{r.$$.dirty&264&&u(5,g=l&&!i),r.$$.dirty&192&&u(4,m=y.map(s=>({...s,contrast:t==null?void 0:t.contrast(s.hex)})))},[_,h,c,l,m,g,y,t,i]}class ih extends Ae{constructor(e){super(),Ee(this,e,th,eh,xe,{components:0,a11yColors:6,hex:1,color:7,a11yGuidelines:2,isA11yOpen:3,isA11yClosable:8})}}function nh(r){let e,u,g=(r[2]||"Lorem Ipsum")+"",m,_,y,h,t,c,l=(r[3]>=10?r[3].toFixed(1):r[3])+"",i,s,n,o,f;return{c(){e=ee("div"),u=ee("p"),m=Ke(g),y=ge(),h=ee("div"),t=ee("p"),c=Ke("contrast: "),i=Ke(l),s=ge(),n=ee("span"),n.textContent="AA",o=ge(),f=ee("span"),f.textContent="AAA",M(u,"class",_="lorem "+(r[4]==="large"&&"large")+" svelte-obnxge"),Ye(u,"color",r[0]),Ye(u,"background-color",r[1]),M(t,"class","svelte-obnxge"),M(n,"class","grade svelte-obnxge"),Re(n,"grade-ok",r[3]>(r[4]==="large"?3:4.5)),M(f,"class","grade svelte-obnxge"),Re(f,"grade-ok",r[3]>(r[4]==="large"?4.5:7)),M(h,"class","score svelte-obnxge"),M(e,"class","a11y-single-notice svelte-obnxge")},m(a,d){ae(a,e,d),q(e,u),q(u,m),q(e,y),q(e,h),q(h,t),q(t,c),q(t,i),q(h,s),q(h,n),q(h,o),q(h,f)},p(a,[d]){d&4&&g!==(g=(a[2]||"Lorem Ipsum")+"")&&Ot(m,g),d&16&&_!==(_="lorem "+(a[4]==="large"&&"large")+" svelte-obnxge")&&M(u,"class",_),d&1&&Ye(u,"color",a[0]),d&2&&Ye(u,"background-color",a[1]),d&8&&l!==(l=(a[3]>=10?a[3].toFixed(1):a[3])+"")&&Ot(i,l),d&24&&Re(n,"grade-ok",a[3]>(a[4]==="large"?3:4.5)),d&24&&Re(f,"grade-ok",a[3]>(a[4]==="large"?4.5:7))},i:ye,o:ye,d(a){a&&se(e)}}}function rh(r,e,u){let{textColor:g}=e,{bgColor:m}=e,{placeholder:_=void 0}=e,{contrast:y=1}=e,{size:h=void 0}=e;return r.$$set=t=>{"textColor"in t&&u(0,g=t.textColor),"bgColor"in t&&u(1,m=t.bgColor),"placeholder"in t&&u(2,_=t.placeholder),"contrast"in t&&u(3,y=t.contrast),"size"in t&&u(4,h=t.size)},[g,m,_,y,h]}class sh extends Ae{constructor(e){super(),Ee(this,e,rh,nh,xe,{textColor:0,bgColor:1,placeholder:2,contrast:3,size:4})}}function ah(r){let e;return{c(){e=Ke(r[0])},m(u,g){ae(u,e,g)},p(u,[g]){g&1&&Ot(e,u[0])},i:ye,o:ye,d(u){u&&se(e)}}}function oh({contrast:r,size:e}){return r?e==="large"?r<3?2:r<4.5?1:0:r<4.5?2:r<7?1:0:1}function lh(r,e,u){let g,m,{a11yColors:_}=e,{hex:y}=e;return r.$$set=h=>{"a11yColors"in h&&u(1,_=h.a11yColors),"hex"in h&&u(2,y=h.hex)},r.$$.update=()=>{r.$$.dirty&2&&u(3,g=_.map(oh).reduce((h,t)=>h+t)),r.$$.dirty&8&&u(0,m=g?`⚠️ ${g} contrast grade${g&&"s"} fail`:"Contrast grade information")},[m,_,y,g]}class ch extends Ae{constructor(e){super(),Ee(this,e,lh,ah,xe,{a11yColors:1,hex:2})}}function hh(r){let e;return{c(){e=ee("input"),M(e,"type","hidden"),e.value=r[2]},m(u,g){ae(u,e,g)},p(u,g){g[0]&4&&(e.value=u[2])},i:ye,o:ye,d(u){u&&se(e)}}}function uh(r){let e,u,g,m,_;function y(l){r[25](l)}function h(l){r[26](l)}var t=r[21]().input;function c(l){let i={hex:l[2],label:l[6]};return l[19]!==void 0&&(i.labelWrapper=l[19]),l[3]!==void 0&&(i.isOpen=l[3]),{props:i}}return t&&(e=Oe(t,c(r)),Se.push(()=>Fe(e,"labelWrapper",y)),Se.push(()=>Fe(e,"isOpen",h))),{c(){e&&be(e.$$.fragment),m=tt()},m(l,i){e&&ve(e,l,i),ae(l,m,i),_=!0},p(l,i){const s={};if(i[0]&4&&(s.hex=l[2]),i[0]&64&&(s.label=l[6]),!u&&i[0]&524288&&(u=!0,s.labelWrapper=l[19],Ue(()=>u=!1)),!g&&i[0]&8&&(g=!0,s.isOpen=l[3],Ue(()=>g=!1)),t!==(t=l[21]().input)){if(e){Le();const n=e;fe(n.$$.fragment,1,0,()=>{_e(n,1)}),Be()}t?(e=Oe(t,c(l)),Se.push(()=>Fe(e,"labelWrapper",y)),Se.push(()=>Fe(e,"isOpen",h)),be(e.$$.fragment),le(e.$$.fragment,1),ve(e,m.parentNode,m)):e=null}else t&&e.$set(s)},i(l){_||(e&&le(e.$$.fragment,l),_=!0)},o(l){e&&fe(e.$$.fragment,l),_=!1},d(l){l&&se(m),e&&_e(e,l)}}}function or(r){let e,u,g,m;function _(t){r[31](t)}function y(t){r[32](t)}let h={components:r[21](),hex:r[2],toRight:r[17]};return r[1].a!==void 0&&(h.a=r[1].a),r[3]!==void 0&&(h.isOpen=r[3]),e=new Sc({props:h}),Se.push(()=>Fe(e,"a",_)),Se.push(()=>Fe(e,"isOpen",y)),{c(){be(e.$$.fragment)},m(t,c){ve(e,t,c),m=!0},p(t,c){const l={};c[0]&4&&(l.hex=t[2]),c[0]&131072&&(l.toRight=t[17]),!u&&c[0]&2&&(u=!0,l.a=t[1].a,Ue(()=>u=!1)),!g&&c[0]&8&&(g=!0,l.isOpen=t[3],Ue(()=>g=!1)),e.$set(l)},i(t){m||(le(e.$$.fragment,t),m=!0)},o(t){fe(e.$$.fragment,t),m=!1},d(t){_e(e,t)}}}function lr(r){let e,u,g,m,_,y;function h(s){r[33](s)}function t(s){r[34](s)}function c(s){r[35](s)}var l=r[21]().textInput;function i(s){let n={isAlpha:s[7],canChangeMode:s[10]};return s[2]!==void 0&&(n.hex=s[2]),s[0]!==void 0&&(n.rgb=s[0]),s[1]!==void 0&&(n.hsv=s[1]),{props:n}}return l&&(e=Oe(l,i(r)),Se.push(()=>Fe(e,"hex",h)),Se.push(()=>Fe(e,"rgb",t)),Se.push(()=>Fe(e,"hsv",c))),{c(){e&&be(e.$$.fragment),_=tt()},m(s,n){e&&ve(e,s,n),ae(s,_,n),y=!0},p(s,n){const o={};if(n[0]&128&&(o.isAlpha=s[7]),n[0]&1024&&(o.canChangeMode=s[10]),!u&&n[0]&4&&(u=!0,o.hex=s[2],Ue(()=>u=!1)),!g&&n[0]&1&&(g=!0,o.rgb=s[0],Ue(()=>g=!1)),!m&&n[0]&2&&(m=!0,o.hsv=s[1],Ue(()=>m=!1)),l!==(l=s[21]().textInput)){if(e){Le();const f=e;fe(f.$$.fragment,1,0,()=>{_e(f,1)}),Be()}l?(e=Oe(l,i(s)),Se.push(()=>Fe(e,"hex",h)),Se.push(()=>Fe(e,"rgb",t)),Se.push(()=>Fe(e,"hsv",c)),be(e.$$.fragment),le(e.$$.fragment,1),ve(e,_.parentNode,_)):e=null}else l&&e.$set(o)},i(s){y||(e&&le(e.$$.fragment,s),y=!0)},o(s){e&&fe(e.$$.fragment,s),y=!1},d(s){s&&se(_),e&&_e(e,s)}}}function cr(r){let e,u,g;var m=r[21]().a11yNotice;function _(y){return{props:{components:y[21](),a11yColors:y[12],color:y[4],hex:y[2],a11yGuidelines:y[13],isA11yOpen:y[14],isA11yClosable:y[15]}}}return m&&(e=Oe(m,_(r))),{c(){e&&be(e.$$.fragment),u=tt()},m(y,h){e&&ve(e,y,h),ae(y,u,h),g=!0},p(y,h){const t={};if(h[0]&4096&&(t.a11yColors=y[12]),h[0]&16&&(t.color=y[4]),h[0]&4&&(t.hex=y[2]),h[0]&8192&&(t.a11yGuidelines=y[13]),h[0]&16384&&(t.isA11yOpen=y[14]),h[0]&32768&&(t.isA11yClosable=y[15]),m!==(m=y[21]().a11yNotice)){if(e){Le();const c=e;fe(c.$$.fragment,1,0,()=>{_e(c,1)}),Be()}m?(e=Oe(m,_(y)),be(e.$$.fragment),le(e.$$.fragment,1),ve(e,u.parentNode,u)):e=null}else m&&e.$set(t)},i(y){g||(e&&le(e.$$.fragment,y),g=!0)},o(y){e&&fe(e.$$.fragment,y),g=!1},d(y){y&&se(u),e&&_e(e,y)}}}function fh(r){let e,u,g,m,_,y,h,t,c,l,i,s;function n(w){r[27](w)}function o(w){r[28](w)}function f(w){r[29](w)}let a={components:r[21](),h:r[1].h,toRight:r[17],isDark:r[5]};r[1].s!==void 0&&(a.s=r[1].s),r[1].v!==void 0&&(a.v=r[1].v),r[3]!==void 0&&(a.isOpen=r[3]),e=new pc({props:a}),Se.push(()=>Fe(e,"s",n)),Se.push(()=>Fe(e,"v",o)),Se.push(()=>Fe(e,"isOpen",f));function d(w){r[30](w)}let p={components:r[21](),toRight:r[17]};r[1].h!==void 0&&(p.h=r[1].h),y=new yc({props:p}),Se.push(()=>Fe(y,"h",d));let v=r[7]&&or(r),b=r[9]&&lr(r),C=r[11]&&cr(r);return{c(){be(e.$$.fragment),_=ge(),be(y.$$.fragment),t=ge(),v&&v.c(),c=ge(),b&&b.c(),l=ge(),C&&C.c(),i=tt()},m(w,S){ve(e,w,S),ae(w,_,S),ve(y,w,S),ae(w,t,S),v&&v.m(w,S),ae(w,c,S),b&&b.m(w,S),ae(w,l,S),C&&C.m(w,S),ae(w,i,S),s=!0},p(w,S){const E={};S[0]&2&&(E.h=w[1].h),S[0]&131072&&(E.toRight=w[17]),S[0]&32&&(E.isDark=w[5]),!u&&S[0]&2&&(u=!0,E.s=w[1].s,Ue(()=>u=!1)),!g&&S[0]&2&&(g=!0,E.v=w[1].v,Ue(()=>g=!1)),!m&&S[0]&8&&(m=!0,E.isOpen=w[3],Ue(()=>m=!1)),e.$set(E);const P={};S[0]&131072&&(P.toRight=w[17]),!h&&S[0]&2&&(h=!0,P.h=w[1].h,Ue(()=>h=!1)),y.$set(P),w[7]?v?(v.p(w,S),S[0]&128&&le(v,1)):(v=or(w),v.c(),le(v,1),v.m(c.parentNode,c)):v&&(Le(),fe(v,1,1,()=>{v=null}),Be()),w[9]?b?(b.p(w,S),S[0]&512&&le(b,1)):(b=lr(w),b.c(),le(b,1),b.m(l.parentNode,l)):b&&(Le(),fe(b,1,1,()=>{b=null}),Be()),w[11]?C?(C.p(w,S),S[0]&2048&&le(C,1)):(C=cr(w),C.c(),le(C,1),C.m(i.parentNode,i)):C&&(Le(),fe(C,1,1,()=>{C=null}),Be())},i(w){s||(le(e.$$.fragment,w),le(y.$$.fragment,w),le(v),le(b),le(C),s=!0)},o(w){fe(e.$$.fragment,w),fe(y.$$.fragment,w),fe(v),fe(b),fe(C),s=!1},d(w){_e(e,w),w&&se(_),_e(y,w),w&&se(t),v&&v.d(w),w&&se(c),b&&b.d(w),w&&se(l),C&&C.d(w),w&&se(i)}}}function dh(r){let e,u,g,m,_,y,h,t,c,l,i;e=new jc({});const s=[uh,hh],n=[];function o(p,v){return p[8]?0:1}m=o(r),_=n[m]=s[m](r);function f(p){r[36](p)}var a=r[21]().wrapper;function d(p){let v={isOpen:p[3],isPopup:p[16],toRight:p[17],$$slots:{default:[fh]},$$scope:{ctx:p}};return p[20]!==void 0&&(v.wrapper=p[20]),{props:v}}return a&&(h=Oe(a,d(r)),Se.push(()=>Fe(h,"wrapper",f))),{c(){be(e.$$.fragment),u=ge(),g=ee("span"),_.c(),y=ge(),h&&be(h.$$.fragment),M(g,"class","color-picker svelte-7ntk55")},m(p,v){ve(e,p,v),ae(p,u,v),ae(p,g,v),n[m].m(g,null),q(g,y),h&&ve(h,g,null),r[37](g),c=!0,l||(i=[ce(window,"mousedown",r[22]),ce(window,"keyup",r[23])],l=!0)},p(p,v){let b=m;m=o(p),m===b?n[m].p(p,v):(Le(),fe(n[b],1,1,()=>{n[b]=null}),Be(),_=n[m],_?_.p(p,v):(_=n[m]=s[m](p),_.c()),le(_,1),_.m(g,y));const C={};if(v[0]&8&&(C.isOpen=p[3]),v[0]&65536&&(C.isPopup=p[16]),v[0]&131072&&(C.toRight=p[17]),v[0]&196287|v[1]&8192&&(C.$$scope={dirty:v,ctx:p}),!t&&v[0]&1048576&&(t=!0,C.wrapper=p[20],Ue(()=>t=!1)),a!==(a=p[21]().wrapper)){if(h){Le();const w=h;fe(w.$$.fragment,1,0,()=>{_e(w,1)}),Be()}a?(h=Oe(a,d(p)),Se.push(()=>Fe(h,"wrapper",f)),be(h.$$.fragment),le(h.$$.fragment,1),ve(h,g,null)):h=null}else a&&h.$set(C)},i(p){c||(le(e.$$.fragment,p),le(_),h&&le(h.$$.fragment,p),c=!0)},o(p){fe(e.$$.fragment,p),fe(_),h&&fe(h.$$.fragment,p),c=!1},d(p){_e(e,p),p&&se(u),p&&se(g),n[m].d(),h&&_e(h),r[37](null),l=!1,Me(i)}}}function gh(r,e,u){lc([cc]);let{components:g={}}=e;const m=zl();let{label:_="Choose a color"}=e,{isAlpha:y=!0}=e,{isInput:h=!0}=e,{isTextInput:t=!0}=e,{canChangeMode:c=!0}=e,{isA11y:l=!1}=e,{a11yColors:i=[{hex:"#ffffff"}]}=e,{a11yGuidelines:s='<p style="margin: 0; font-size: 12px;">Learn more at <a href="https://webaim.org/articles/contrast/" target="_blank">WebAIM contrast guide</a></p>'}=e,{isA11yOpen:n=!1}=e,{isA11yClosable:o=!0}=e,{isPopup:f=h}=e,{isOpen:a=!h}=e,{toRight:d=!1}=e,{rgb:p={r:255,g:0,b:0,a:1}}=e,{hsv:v={h:0,s:100,v:100,a:1}}=e,{hex:b="#ff0000"}=e,{color:C=void 0}=e,{isDark:w=!1}=e,S={r:255,g:0,b:0,a:1},E={h:0,s:100,v:100,a:1},P="#ff0000",N;const K={sliderIndicator:ir,pickerIndicator:Rc,alphaIndicator:ir,pickerWrapper:Wc,sliderWrapper:nr,alphaWrapper:nr,textInput:Dc,a11yNotice:ih,a11ySingleNotice:sh,a11ySummary:ch,input:Jc,wrapper:$c};function Z(){return{...K,...g}}let W,U;function te({target:F}){h&&(W.contains(F)||W.isSameNode(F)?u(3,a=!a):a&&!U.contains(F)&&u(3,a=!1))}function re(F){F.key==="Tab"&&u(3,a=N==null?void 0:N.contains(document.activeElement))}function he(){v.h===E.h&&v.s===E.s&&v.v===E.v&&v.a===E.a&&p.r===S.r&&p.g===S.g&&p.b===S.b&&p.a===S.a&&b===P||(v.a===void 0&&u(1,v.a=1,v),E.a===void 0&&(E.a=1),p.a===void 0&&u(0,p.a=1,p),S.a===void 0&&(S.a=1),(b==null?void 0:b.substring(7))==="ff"&&u(2,b=b.substring(0,7)),(b==null?void 0:b.substring(7))==="ff"&&u(2,b=b.substring(0,7)),v.h!==E.h||v.s!==E.s||v.v!==E.v||v.a!==E.a?(u(4,C=We(v)),u(0,p=C.toRgb()),u(2,b=C.toHex())):p.r!==S.r||p.g!==S.g||p.b!==S.b||p.a!==S.a?(u(4,C=We(p)),u(2,b=C.toHex()),u(1,v=C.toHsv())):b!==P&&(u(4,C=We(b)),u(0,p=C.toRgb()),u(1,v=C.toHsv())),C&&u(5,w=C.isDark()),E=Object.assign({},v),S=Object.assign({},p),P=b,m("input",{color:C,hsv:v,rgb:p,hex:b}))}function oe(F){W=F,u(19,W)}function T(F){a=F,u(3,a)}function k(F){r.$$.not_equal(v.s,F)&&(v.s=F,u(1,v))}function D(F){r.$$.not_equal(v.v,F)&&(v.v=F,u(1,v))}function A(F){a=F,u(3,a)}function B(F){r.$$.not_equal(v.h,F)&&(v.h=F,u(1,v))}function O(F){r.$$.not_equal(v.a,F)&&(v.a=F,u(1,v))}function x(F){a=F,u(3,a)}function I(F){b=F,u(2,b)}function L(F){p=F,u(0,p)}function z(F){v=F,u(1,v)}function j(F){U=F,u(20,U)}function Q(F){Se[F?"unshift":"push"](()=>{N=F,u(18,N)})}return r.$$set=F=>{"components"in F&&u(24,g=F.components),"label"in F&&u(6,_=F.label),"isAlpha"in F&&u(7,y=F.isAlpha),"isInput"in F&&u(8,h=F.isInput),"isTextInput"in F&&u(9,t=F.isTextInput),"canChangeMode"in F&&u(10,c=F.canChangeMode),"isA11y"in F&&u(11,l=F.isA11y),"a11yColors"in F&&u(12,i=F.a11yColors),"a11yGuidelines"in F&&u(13,s=F.a11yGuidelines),"isA11yOpen"in F&&u(14,n=F.isA11yOpen),"isA11yClosable"in F&&u(15,o=F.isA11yClosable),"isPopup"in F&&u(16,f=F.isPopup),"isOpen"in F&&u(3,a=F.isOpen),"toRight"in F&&u(17,d=F.toRight),"rgb"in F&&u(0,p=F.rgb),"hsv"in F&&u(1,v=F.hsv),"hex"in F&&u(2,b=F.hex),"color"in F&&u(4,C=F.color),"isDark"in F&&u(5,w=F.isDark)},r.$$.update=()=>{r.$$.dirty[0]&7&&(v||p||b)&&he()},[p,v,b,a,C,w,_,y,h,t,c,l,i,s,n,o,f,d,N,W,U,Z,te,re,g,oe,T,k,D,A,B,O,x,I,L,z,j,Q]}class ph extends Ae{constructor(e){super(),Ee(this,e,gh,dh,xe,{components:24,label:6,isAlpha:7,isInput:8,isTextInput:9,canChangeMode:10,isA11y:11,a11yColors:12,a11yGuidelines:13,isA11yOpen:14,isA11yClosable:15,isPopup:16,isOpen:3,toRight:17,rgb:0,hsv:1,hex:2,color:4,isDark:5},null,[-1,-1])}}const mh=(r,e)=>Math.floor(Math.random()*(e-r+1))+r,hr=["#ff595e","#ff924c","#ffca3a","#8ac926","#1982c4","#6a4c93","#ff99b6","#ffb7b2"],en=["#1A1A1A","#ffffff","#ff595e","#ff924c","#ffca3a","#8ac926","#1982c4","#6a4c93","#ff99b6"],vh="/assets/glasses-ca8642be.png",_h="/assets/laptop-afa03861.png",yh="/assets/hair-416c3326.png",bh="/assets/coffee-7794bf02.png",Ch="/assets/goggles-96bb4daf.png",wh="/assets/hairband-299cc720.png",Sh="/assets/headphones-03d51a37.png",Th="/assets/basketball-c95eb96a.png",xh="/assets/basketballVest-e07faa60.png",Oh="/assets/airpot-e41e8be4.png",Eh="/assets/ballCap-ee5c5a8a.png",Ah="/assets/darkCircles-879e0de1.png",kh="/assets/toast-22dec998.png",Dh="/assets/watch-c2396f29.png",Ph="/assets/sneakers-1f8f079a.png",Mh="/assets/cookie-9d57dbff.png",Ih="/assets/hardHat-6b531677.png",gi=mt(hr[mh(0,hr.length-1)]),ze=mt(),jt=mt(600),Ss={glasses:!1,hair:!1,laptop:!1,coffee:!1,goggles:!1,hairband:!1,headphones:!1,basketball:!1,basketballVest:!1,airpot:!1,ballCap:!1,darkCircles:!1,hardHat:!1,toast:!1,watch:!1,sneakers:!1,cookie:!1},Mt={glasses:{title:"안경",src:vh},hair:{title:"앞머리",src:yh},laptop:{title:"노트북",src:_h},coffee:{title:"커피",src:bh},goggles:{title:"고글",src:Ch},headphones:{title:"헤드폰",src:Sh},hairband:{title:"농구 머리띠",src:wh},basketballVest:{title:"농구 조끼",src:xh},basketball:{title:"농구 공",src:Th},airpot:{title:"에어팟",src:Oh},ballCap:{title:"볼캡",src:Eh},darkCircles:{title:"다크써클",src:Ah},hardHat:{title:"안전모",src:Ih},toast:{title:"토스트",src:kh},watch:{title:"애플워치",src:Dh},sneakers:{title:"운동화",src:Ph},cookie:{title:"쿠키",src:Mh}},vn=mt(Ss),Fh=r=>{vn.update(e=>({...e,[r]:!e[r]}))},Rh=()=>{vn.set(Ss)};function Lh(r){let e,u,g,m,_,y,h,t,c,l,i,s,n,o,f,a,d,p,v,b,C,w;function S(P){r[5](P)}let E={isA11yClosable:!1,label:"선택하기"};return r[0]!==void 0&&(E.hex=r[0]),t=new ph({props:E}),Se.push(()=>Fe(t,"hex",S)),{c(){e=ee("div"),u=ee("h2"),u.textContent="배경을 꾸며보세요!",g=ge(),m=ee("ul"),_=ee("li"),y=ee("h3"),y.textContent="배경색",h=ge(),be(t.$$.fragment),l=ge(),i=ee("li"),s=ee("h3"),s.textContent="배경이미지",n=ge(),o=ee("div"),f=ee("button"),f.textContent="이미지",a=ge(),d=ee("button"),d.textContent="제거",p=ge(),v=ee("input"),M(u,"class","svelte-1sm4ylp"),M(y,"class","svelte-1sm4ylp"),M(_,"class","svelte-1sm4ylp"),M(s,"class","svelte-1sm4ylp"),M(f,"class","svelte-1sm4ylp"),M(d,"class","svelte-1sm4ylp"),M(o,"class","buttonWrapper svelte-1sm4ylp"),M(i,"class","svelte-1sm4ylp"),M(m,"class","svelte-1sm4ylp"),M(e,"class","container svelte-1sm4ylp"),M(v,"type","file"),M(v,"accept","image/*"),Ye(v,"display","none")},m(P,N){ae(P,e,N),q(e,u),q(e,g),q(e,m),q(m,_),q(_,y),q(_,h),ve(t,_,null),q(m,l),q(m,i),q(i,s),q(i,n),q(i,o),q(o,f),q(o,a),q(o,d),ae(P,p,N),ae(P,v,N),r[7](v),b=!0,C||(w=[ce(f,"click",r[6]),ce(d,"click",r[3]),ce(v,"change",r[2])],C=!0)},p(P,[N]){const K={};!c&&N&1&&(c=!0,K.hex=P[0],Ue(()=>c=!1)),t.$set(K)},i(P){b||(le(t.$$.fragment,P),b=!0)},o(P){fe(t.$$.fragment,P),b=!1},d(P){P&&se(e),_e(t),P&&se(p),P&&se(v),r[7](null),C=!1,Me(w)}}}function Bh(r,e,u){let g,m;De(r,ze,i=>u(4,g=i)),De(r,gi,i=>u(0,m=i));let _;Ht(()=>{st(ct,"배경 탭 진입")});const y=i=>{const s=i.currentTarget.files;if(!s)return;const n=s[0];if(!n)return;h();const o=URL.createObjectURL(n);gt.fabric.Image.fromURL(o,function(f){f.set("itemType","background"),g.setBackgroundImage(f,g.renderAll.bind(g),{scaleX:g.width/f.width,scaleY:g.height/f.height,selectable:!0})})},h=()=>{g.setBackgroundImage(null,g.renderAll.bind(g))};function t(i){m=i,gi.set(m)}const c=()=>{_.click()};function l(i){Se[i?"unshift":"push"](()=>{_=i,u(1,_)})}return r.$$.update=()=>{r.$$.dirty&17&&g&&g.setBackgroundColor(m,()=>{g.renderAll()})},[m,_,y,h,g,t,c,l]}class jh extends Ae{constructor(e){super(),Ee(this,e,Bh,Lh,xe,{})}}function Nh(r){let e,u,g,m,_,y,h,t,c,l,i,s,n;return{c(){e=ee("div"),u=ee("h2"),u.textContent="사진을 추가해보세요!",g=ge(),m=ee("div"),m.innerHTML=`<p>사진을 이동하고 크기를 조절해보세요.</p> 
    <p>삭제하고 싶은 사진은 선택 후 제거 버튼을 클릭하세요.</p>`,_=ge(),y=ee("div"),h=ee("button"),h.textContent="추가",t=ge(),c=ee("button"),c.textContent="제거",l=ge(),i=ee("input"),M(u,"class","svelte-x4lqyk"),M(m,"class","detail svelte-x4lqyk"),M(h,"class","svelte-x4lqyk"),M(c,"class","svelte-x4lqyk"),Re(c,"hasActiveObject",r[1]),M(y,"class","photo-buttons svelte-x4lqyk"),M(i,"type","file"),M(i,"accept","image/*"),Ye(i,"display","none"),M(e,"class","container svelte-x4lqyk")},m(o,f){ae(o,e,f),q(e,u),q(e,g),q(e,m),q(e,_),q(e,y),q(y,h),q(y,t),q(y,c),q(e,l),q(e,i),r[7](i),s||(n=[ce(h,"click",r[6]),ce(c,"click",r[3]),ce(i,"change",r[2])],s=!0)},p(o,[f]){f&2&&Re(c,"hasActiveObject",o[1])},i:ye,o:ye,d(o){o&&se(e),r[7](null),s=!1,Me(n)}}}function Hh(r,e,u){let g,m,_;De(r,ze,a=>u(4,g=a)),De(r,jt,a=>u(10,m=a)),De(r,gi,a=>u(5,_=a));let y,h=0,t=null,c=!1;Ht(()=>{st(ct,"사진 탭 진입"),g.on("selection:created",s),g.on("selection:cleared",n)}),_s(()=>{g.off("selection:created",s),g.off("selection:cleared",n)});const l=a=>{const d=a.currentTarget.files;if(!d)return;const p=d[0];if(!p)return;const v=URL.createObjectURL(p);h+=1,gt.fabric.Image.fromURL(v,function(b){b.set({left:h*10,top:h*10}),b.set("itemType","photo"),b.scaleToWidth(m/6),g.add(b),g.setActiveObject(b)}),g.renderAll()},i=()=>{const a=g.getActiveObjects();a&&(a.forEach(d=>{g.remove(d),h-=1}),u(1,c=!1)),g.discardActiveObject()},s=a=>{t=g.getActiveObjects(),u(1,c=t.length>0)},n=a=>{u(1,c=!1)},o=()=>{y.click()};function f(a){Se[a?"unshift":"push"](()=>{y=a,u(0,y)})}return r.$$.update=()=>{r.$$.dirty&48&&g&&g.setBackgroundColor(_,()=>{g.renderAll()})},[y,c,l,i,g,_,o,f]}class Wh extends Ae{constructor(e){super(),Ee(this,e,Hh,Nh,xe,{})}}function ur(r,e,u){const g=r.slice();return g[7]=e[u],g}function fr(r){let e,u,g=Mt[r[7]].title+"",m,_,y,h,t;return{c(){e=ee("li"),u=ee("button"),m=Ke(g),y=ge(),M(u,"class",_=et(r[0][r[7]]?"active":"")+" svelte-122p4th"),M(e,"class","svelte-122p4th")},m(c,l){ae(c,e,l),q(e,u),q(u,m),q(e,y),h||(t=ce(u,"click",r[1](r[7])),h=!0)},p(c,l){r=c,l&1&&_!==(_=et(r[0][r[7]]?"active":"")+" svelte-122p4th")&&M(u,"class",_)},d(c){c&&se(e),h=!1,t()}}}function Xh(r){let e,u,g,m,_,y,h,t,c,l=Object.keys(Mt),i=[];for(let s=0;s<l.length;s+=1)i[s]=fr(ur(r,l,s));return{c(){e=ee("div"),u=ee("h2"),u.textContent="아이템을 추가해 꾸며주세요!",g=ge(),m=ee("ul"),_=ee("li"),y=ee("button"),y.textContent="초기화 하기",h=ge();for(let s=0;s<i.length;s+=1)i[s].c();M(u,"class","svelte-122p4th"),M(y,"class","reset svelte-122p4th"),M(_,"class","svelte-122p4th"),M(m,"class","toolbar svelte-122p4th"),M(e,"class","container svelte-122p4th")},m(s,n){ae(s,e,n),q(e,u),q(e,g),q(e,m),q(m,_),q(_,y),q(m,h);for(let o=0;o<i.length;o+=1)i[o]&&i[o].m(m,null);t||(c=ce(y,"click",r[2]),t=!0)},p(s,[n]){if(n&3){l=Object.keys(Mt);let o;for(o=0;o<l.length;o+=1){const f=ur(s,l,o);i[o]?i[o].p(f,n):(i[o]=fr(f),i[o].c(),i[o].m(m,null))}for(;o<i.length;o+=1)i[o].d(1);i.length=l.length}},i:ye,o:ye,d(s){s&&se(e),Bt(i,s),t=!1,c()}}}function Uh(r,e,u){let g,m,_;De(r,vn,l=>u(0,g=l)),De(r,ze,l=>u(3,m=l)),De(r,jt,l=>u(4,_=l)),Ht(()=>{st(ct,"꾸미기 탭 진입")});const y=l=>{let i=Mt[l].src;st(ct,`${Mt[l].title} 추가`),gt.fabric.Image.fromURL(i,function(s){s.scaleToWidth(_),s.scaleToWidth(_),s.selectable=!1,s.set("itemType","costume"),s.set("costume",l),m.add(s),m.getObjects().forEach(n=>{(n.costume==="basketball"||n.costume==="laptop")&&m.moveTo(n,100)}),m.renderAll()})},h=l=>{const i=m.getObjects();st(ct,`${Mt[l].title} 제거`),i.filter(n=>n.costume===l).forEach(n=>m.remove(n))},t=l=>()=>{Fh(l)},c=()=>{st(ct,"초기화 버튼 클릭"),Rh()};return r.$$.update=()=>{if(r.$$.dirty&9&&m){const l=m.getObjects();for(const i in g){const s=l.find(n=>n.costume===i);s&&!g[i]&&h(i),!s&&g[i]&&y(i)}}},[g,t,c,m]}class zh extends Ae{constructor(e){super(),Ee(this,e,Uh,Xh,xe,{})}}const Yh="/assets/watermark-c2d43a34.png",Vh="/assets/close-7faef788.svg";const Gh=r=>({}),dr=r=>({});function qh(r){let e,u,g,m,_,y,h,t,c,l;const i=r[3].header,s=It(i,r,r[2],dr),n=r[3].default,o=It(n,r,r[2],null);return{c(){e=ee("dialog"),u=ee("div"),s&&s.c(),g=ge(),o&&o.c(),m=ge(),_=ee("button"),y=ee("img"),Jt(y.src,h=Vh)||M(y,"src",h),M(y,"aria-hidden",""),M(y,"alt","닫기"),M(_,"class","close svelte-ckxgtn"),_.autofocus=!0,M(_,"aria-label","닫기"),M(u,"class","svelte-ckxgtn"),M(e,"class","svelte-ckxgtn")},m(f,a){ae(f,e,a),q(e,u),s&&s.m(u,null),q(u,g),o&&o.m(u,null),q(u,m),q(u,_),q(_,y),r[6](e),t=!0,_.focus(),c||(l=[ce(_,"click",r[5]),ce(u,"click",xt(r[4])),ce(e,"close",r[7]),ce(e,"click",Wl(r[8]))],c=!0)},p(f,[a]){s&&s.p&&(!t||a&4)&&Rt(s,i,f,f[2],t?Ft(i,f[2],a,Gh):Lt(f[2]),dr),o&&o.p&&(!t||a&4)&&Rt(o,n,f,f[2],t?Ft(n,f[2],a,null):Lt(f[2]),null)},i(f){t||(le(s,f),le(o,f),t=!0)},o(f){fe(s,f),fe(o,f),t=!1},d(f){f&&se(e),s&&s.d(f),o&&o.d(f),r[6](null),c=!1,Me(l)}}}function Kh(r,e,u){let{$$slots:g={},$$scope:m}=e,{showModal:_}=e,y;function h(s){Yl.call(this,r,s)}const t=()=>y.close();function c(s){Se[s?"unshift":"push"](()=>{y=s,u(1,y)})}const l=()=>u(0,_=!1),i=()=>y.close();return r.$$set=s=>{"showModal"in s&&u(0,_=s.showModal),"$$scope"in s&&u(2,m=s.$$scope)},r.$$.update=()=>{r.$$.dirty&3&&y&&_&&y.showModal()},[_,y,m,g,h,t,c,l,i]}class Jh extends Ae{constructor(e){super(),Ee(this,e,Kh,qh,xe,{showModal:0})}}function Qh(r){let e,u,g,m,_,y;return{c(){e=ee("img"),g=ge(),m=ee("button"),m.textContent="저장하기",Jt(e.src,u=r[1])||M(e,"src",u),M(e,"alt","데브진스"),M(m,"class","save svelte-1cdxw3x")},m(h,t){ae(h,e,t),ae(h,g,t),ae(h,m,t),_||(y=ce(m,"click",r[3]),_=!0)},p(h,t){t&2&&!Jt(e.src,u=h[1])&&M(e,"src",u)},d(h){h&&se(e),h&&se(g),h&&se(m),_=!1,y()}}}function Zh(r){let e;return{c(){e=ee("h2"),e.textContent="짜잔~ 완성된 이미지에요.",M(e,"slot","header"),M(e,"class","svelte-1cdxw3x")},m(u,g){ae(u,e,g)},p:ye,d(u){u&&se(e)}}}function $h(r){let e,u,g,m,_,y,h,t,c,l;function i(n){r[4](n)}let s={$$slots:{header:[Zh],default:[Qh]},$$scope:{ctx:r}};return r[0]!==void 0&&(s.showModal=r[0]),e=new Jh({props:s}),Se.push(()=>Fe(e,"showModal",i)),{c(){be(e.$$.fragment),g=ge(),m=ee("div"),_=ee("h2"),_.textContent="최종 결과물이 맘에 드시나요?",y=ge(),h=ee("button"),h.textContent="만족해요!",M(_,"class","svelte-1cdxw3x"),M(h,"class","svelte-1cdxw3x"),M(m,"class","container svelte-1cdxw3x")},m(n,o){ve(e,n,o),ae(n,g,o),ae(n,m,o),q(m,_),q(m,y),q(m,h),t=!0,c||(l=ce(h,"click",r[2]),c=!0)},p(n,[o]){const f={};o&130&&(f.$$scope={dirty:o,ctx:n}),!u&&o&1&&(u=!0,f.showModal=n[0],Ue(()=>u=!1)),e.$set(f)},i(n){t||(le(e.$$.fragment,n),t=!0)},o(n){fe(e.$$.fragment,n),t=!1},d(n){_e(e,n),n&&se(g),n&&se(m),c=!1,l()}}}function eu(r,e,u){let g,m;De(r,ze,l=>u(5,g=l)),De(r,jt,l=>u(6,m=l));let _=!1,y="";Ht(()=>{st(ct,"저장 탭 진입")});const h=()=>{gt.fabric.Image.fromURL(Yh,function(l){l.scaleToWidth(m),l.scaleToWidth(m),l.selectable=!1,g.add(l),g.renderAll(),u(1,y=g.toDataURL({format:"png",quality:1,multiplier:4})),g.remove(l),u(0,_=!0)})},t=()=>{const l=document.createElement("a");l.download="dev-jeans.png",l.href=y,l.click()};function c(l){_=l,u(0,_)}return[_,y,h,t,c]}class tu extends Ae{constructor(e){super(),Ee(this,e,eu,$h,xe,{})}}const tn=mt(nt.Decorate);function gr(r,e,u){const g=r.slice();return g[3]=e[u],g}function pr(r,e,u){const g=r.slice();return g[3]=e[u],g}function mr(r){let e,u,g=r[3].label+"",m,_,y,h,t;return{c(){e=ee("li"),u=ee("button"),m=Ke(g),_=ge(),M(u,"type","button"),M(u,"class","svelte-bzko04"),M(e,"class",y=et(r[1]===r[3].value?"active":"")+" svelte-bzko04")},m(c,l){ae(c,e,l),q(e,u),q(u,m),q(e,_),h||(t=ce(u,"click",function(){bi(r[2](r[3].value))&&r[2](r[3].value).apply(this,arguments)}),h=!0)},p(c,l){r=c,l&1&&g!==(g=r[3].label+"")&&Ot(m,g),l&3&&y!==(y=et(r[1]===r[3].value?"active":"")+" svelte-bzko04")&&M(e,"class",y)},d(c){c&&se(e),h=!1,t()}}}function vr(r){let e,u,g,m;var _=r[3].component;function y(h){return{}}return _&&(u=Oe(_,y())),{c(){e=ee("div"),u&&be(u.$$.fragment),g=ge(),M(e,"class","box svelte-bzko04")},m(h,t){ae(h,e,t),u&&ve(u,e,null),q(e,g),m=!0},p(h,t){if(t&1&&_!==(_=h[3].component)){if(u){Le();const c=u;fe(c.$$.fragment,1,0,()=>{_e(c,1)}),Be()}_?(u=Oe(_,y()),be(u.$$.fragment),le(u.$$.fragment,1),ve(u,e,g)):u=null}},i(h){m||(u&&le(u.$$.fragment,h),m=!0)},o(h){u&&fe(u.$$.fragment,h),m=!1},d(h){h&&se(e),u&&_e(u)}}}function _r(r){let e,u,g=r[1]==r[3].value&&vr(r);return{c(){g&&g.c(),e=tt()},m(m,_){g&&g.m(m,_),ae(m,e,_),u=!0},p(m,_){m[1]==m[3].value?g?(g.p(m,_),_&3&&le(g,1)):(g=vr(m),g.c(),le(g,1),g.m(e.parentNode,e)):g&&(Le(),fe(g,1,1,()=>{g=null}),Be())},i(m){u||(le(g),u=!0)},o(m){fe(g),u=!1},d(m){g&&g.d(m),m&&se(e)}}}function iu(r){let e,u,g,m,_=r[0],y=[];for(let l=0;l<_.length;l+=1)y[l]=mr(pr(r,_,l));let h=r[0],t=[];for(let l=0;l<h.length;l+=1)t[l]=_r(gr(r,h,l));const c=l=>fe(t[l],1,1,()=>{t[l]=null});return{c(){e=ee("ul");for(let l=0;l<y.length;l+=1)y[l].c();u=ge();for(let l=0;l<t.length;l+=1)t[l].c();g=tt(),M(e,"class","taps svelte-bzko04")},m(l,i){ae(l,e,i);for(let s=0;s<y.length;s+=1)y[s]&&y[s].m(e,null);ae(l,u,i);for(let s=0;s<t.length;s+=1)t[s]&&t[s].m(l,i);ae(l,g,i),m=!0},p(l,[i]){if(i&7){_=l[0];let s;for(s=0;s<_.length;s+=1){const n=pr(l,_,s);y[s]?y[s].p(n,i):(y[s]=mr(n),y[s].c(),y[s].m(e,null))}for(;s<y.length;s+=1)y[s].d(1);y.length=_.length}if(i&3){h=l[0];let s;for(s=0;s<h.length;s+=1){const n=gr(l,h,s);t[s]?(t[s].p(n,i),le(t[s],1)):(t[s]=_r(n),t[s].c(),le(t[s],1),t[s].m(g.parentNode,g))}for(Le(),s=h.length;s<t.length;s+=1)c(s);Be()}},i(l){if(!m){for(let i=0;i<h.length;i+=1)le(t[i]);m=!0}},o(l){t=t.filter(Boolean);for(let i=0;i<t.length;i+=1)fe(t[i]);m=!1},d(l){l&&se(e),Bt(y,l),l&&se(u),Bt(t,l),l&&se(g)}}}function nu(r,e,u){let g;De(r,tn,y=>u(1,g=y));let{items:m=[]}=e;const _=y=>()=>Xe(tn,g=y,g);return r.$$set=y=>{"items"in y&&u(0,m=y.items)},[m,g,_]}class ru extends Ae{constructor(e){super(),Ee(this,e,nu,iu,xe,{items:0})}}const Ts={isDrawingMode:!0,color:en[0],width:5},Je=mt(Ts),su=()=>Je.set(Ts),au=()=>{const r=Yt(ze);Je.set({...Yt(Je),isDrawingMode:!0}),r.freeDrawingBrush=new gt.fabric.PencilBrush(r),r.freeDrawingBrush.color=Yt(Je).color,r.freeDrawingBrush.width=Yt(Je).width},ou=()=>{const r=Yt(ze);r.isDrawingMode=!1,su()},lu="/assets/selection-8a4a36ee.svg",cu="/assets/eraser-4d1d20f1.svg";function yr(r,e,u){const g=r.slice();return g[7]=e[u],g}function br(r,e,u){const g=r.slice();return g[10]=e[u],g[12]=u,g}function Cr(r){let e,u,g,m=r[10]+"",_,y,h,t,c;function l(){return r[5](r[10])}return{c(){e=ee("li"),u=ee("button"),g=ee("div"),_=Ke(m),y=ge(),M(g,"class","pen-width svelte-1sbusi2"),M(g,"style",`
                  width: ${10+(r[12]+1)*8}px; 
                  height: ${10+(r[12]+1)*8}px; 
                  `),M(u,"class","svelte-1sbusi2"),M(e,"class",h=et(r[0].isDrawingMode&&r[0].width===r[10]?"active round-border":"")+" svelte-1sbusi2")},m(i,s){ae(i,e,s),q(e,u),q(u,g),q(g,_),q(e,y),t||(c=ce(u,"click",l),t=!0)},p(i,s){r=i,s&1&&h!==(h=et(r[0].isDrawingMode&&r[0].width===r[10]?"active round-border":"")+" svelte-1sbusi2")&&M(e,"class",h)},d(i){i&&se(e),t=!1,c()}}}function wr(r){let e,u,g,m,_,y,h;function t(){return r[6](r[7])}return{c(){e=ee("li"),u=ee("button"),g=ee("div"),m=ge(),M(g,"class","pen-color svelte-1sbusi2"),M(g,"style",`background-color:${r[7]}`),M(u,"class","svelte-1sbusi2"),M(e,"class",_=et(`pen-color-wrapper ${r[0].isDrawingMode&&r[7]===r[0].color?"active round-border":""} `)+" svelte-1sbusi2")},m(c,l){ae(c,e,l),q(e,u),q(u,g),q(e,m),y||(h=ce(u,"click",t),y=!0)},p(c,l){r=c,l&1&&_!==(_=et(`pen-color-wrapper ${r[0].isDrawingMode&&r[7]===r[0].color?"active round-border":""} `)+" svelte-1sbusi2")&&M(e,"class",_)},d(c){c&&se(e),y=!1,h()}}}function hu(r){let e,u,g,m,_,y,h,t,c,l,i,s,n,o,f,a,d,p,v,b,C,w,S,E=r[2],P=[];for(let Z=0;Z<E.length;Z+=1)P[Z]=Cr(br(r,E,Z));let N=en,K=[];for(let Z=0;Z<N.length;Z+=1)K[Z]=wr(yr(r,N,Z));return{c(){e=ee("div"),u=ee("div"),u.innerHTML=`<h2 class="svelte-1sbusi2">그림을 그려보세요!</h2> 
    <span>펜 색상을 선택해서 그려보세요.</span> 
    <span>지우고 싶은것을 선택후 지우개를 클릭하면 지워집니다.</span>`,g=ge(),m=ee("div"),_=ee("div"),y=ee("div"),h=ee("ul"),t=ee("li"),c=ee("button"),l=ee("img"),n=ge(),o=ee("li"),f=ee("button"),a=ee("img"),p=ge();for(let Z=0;Z<P.length;Z+=1)P[Z].c();v=ge(),b=ee("div"),C=ee("ul");for(let Z=0;Z<K.length;Z+=1)K[Z].c();M(u,"class","header svelte-1sbusi2"),Jt(l.src,i=lu)||M(l,"src",i),M(l,"aria-hidden",""),M(l,"alt","선택"),M(l,"width","30"),M(c,"class",s=et(r[0].isDrawingMode?"":"active")+" svelte-1sbusi2"),M(c,"aria-label","선택 모드"),M(t,"class","svelte-1sbusi2"),Jt(a.src,d=cu)||M(a,"src",d),M(a,"aria-hidden",""),M(a,"alt","삭제"),M(a,"width","25"),M(f,"aria-label","삭제"),M(f,"class","svelte-1sbusi2"),M(o,"class","svelte-1sbusi2"),M(h,"class","option-wrapper svelte-1sbusi2"),M(_,"class","option-container svelte-1sbusi2"),M(C,"class","option-wrapper svelte-1sbusi2"),M(b,"class","pen-container svelte-1sbusi2"),M(m,"class","sub-container svelte-1sbusi2"),M(e,"class","container svelte-1sbusi2")},m(Z,W){ae(Z,e,W),q(e,u),q(e,g),q(e,m),q(m,_),q(_,y),q(y,h),q(h,t),q(t,c),q(c,l),q(h,n),q(h,o),q(o,f),q(f,a),q(h,p);for(let U=0;U<P.length;U+=1)P[U]&&P[U].m(h,null);q(m,v),q(m,b),q(b,C);for(let U=0;U<K.length;U+=1)K[U]&&K[U].m(C,null);w||(S=[ce(c,"click",r[3]),ce(f,"click",r[4])],w=!0)},p(Z,[W]){if(W&1&&s!==(s=et(Z[0].isDrawingMode?"":"active")+" svelte-1sbusi2")&&M(c,"class",s),W&5){E=Z[2];let U;for(U=0;U<E.length;U+=1){const te=br(Z,E,U);P[U]?P[U].p(te,W):(P[U]=Cr(te),P[U].c(),P[U].m(h,null))}for(;U<P.length;U+=1)P[U].d(1);P.length=E.length}if(W&1){N=en;let U;for(U=0;U<N.length;U+=1){const te=yr(Z,N,U);K[U]?K[U].p(te,W):(K[U]=wr(te),K[U].c(),K[U].m(C,null))}for(;U<K.length;U+=1)K[U].d(1);K.length=N.length}},i:ye,o:ye,d(Z){Z&&se(e),Bt(P,Z),Bt(K,Z),w=!1,Me(S)}}}function uu(r,e,u){let g,m;De(r,Je,l=>u(0,g=l)),De(r,ze,l=>u(1,m=l));const _=[5,11,17];Ht(()=>{st(ct,"그리기 탭 진입"),au()}),_s(()=>{Xe(ze,m.isDrawingMode=!1,m),ou()});const y=()=>Xe(Je,g.isDrawingMode=!1,g),h=()=>{m.getObjects().forEach(l=>{(!l.itemType||l.itemType==="photo")&&m.remove(l)}),m.discardActiveObject()},t=l=>{Xe(Je,g.isDrawingMode=!0,g),Xe(Je,g.width=l,g)},c=l=>{Xe(Je,g.isDrawingMode=!0,g),Xe(Je,g.color=l,g)};return r.$$.update=()=>{r.$$.dirty&1&&g&&(Xe(ze,m.freeDrawingBrush.color=g.color,m),Xe(ze,m.freeDrawingBrush.width=g.width,m),Xe(ze,m.isDrawingMode=g.isDrawingMode,m))},[g,m,_,y,h,t,c]}class fu extends Ae{constructor(e){super(),Ee(this,e,uu,hu,xe,{})}}function du(r){let e,u,g;return u=new ru({props:{items:r[0]}}),{c(){e=ee("div"),be(u.$$.fragment),M(e,"class","container svelte-14gkii")},m(m,_){ae(m,e,_),ve(u,e,null),g=!0},p:ye,i(m){g||(le(u.$$.fragment,m),g=!0)},o(m){fe(u.$$.fragment,m),g=!1},d(m){m&&se(e),_e(u)}}}function gu(r){return[[{label:"꾸미기",value:nt.Decorate,component:zh},{label:"배경",value:nt.Background,component:jh},{label:"사진",value:nt.Photo,component:Wh},{label:"드로잉",value:nt.Drawing,component:fu},{label:"저장",value:nt.Save,component:tu}]]}class pu extends Ae{constructor(e){super(),Ee(this,e,gu,du,xe,{})}}function Sr(r){let e;return{c(){e=ee("a"),e.innerHTML='<img alt="Hits" src="https://hits.sh/devjeans.dev-hee.com.svg?view=today-total&amp;style=for-the-badge&amp;color=f1c164&amp;labelColor=284d8e"/>',M(e,"href","https://hits.sh/devjeans.dev-hee.com/"),M(e,"class","svelte-f0rdiy")},m(u,g){ae(u,e,g)},d(u){u&&se(e)}}}function mu(r){let e,u,g,m,_,y,h,t,c,l,i,s,n,o;const f=r[4].default,a=It(f,r,r[3],null);let d=!r[1]&&Sr();return{c(){e=ee("header"),u=ee("h1"),g=Ke(r[0]),m=ge(),_=ee("main"),a&&a.c(),h=ge(),t=ee("footer"),c=ee("span"),c.innerHTML='Instagram: <a href="https://www.instagram.com/dev_hee/" class="svelte-f0rdiy">@dev_hee</a>',l=ge(),i=ee("span"),i.innerHTML='Blog: <a href="https://velog.io/@heelieben" class="svelte-f0rdiy">@pigme</a>',s=ge(),d&&d.c(),M(e,"class","svelte-f0rdiy"),M(_,"style",y=`width: ${r[2]}`),M(_,"class","svelte-f0rdiy"),M(t,"style",n=`width: ${r[2]}`),M(t,"class","svelte-f0rdiy")},m(p,v){ae(p,e,v),q(e,u),q(u,g),ae(p,m,v),ae(p,_,v),a&&a.m(_,null),ae(p,h,v),ae(p,t,v),q(t,c),q(t,l),q(t,i),q(t,s),d&&d.m(t,null),o=!0},p(p,[v]){(!o||v&1)&&Ot(g,p[0]),a&&a.p&&(!o||v&8)&&Rt(a,f,p,p[3],o?Ft(f,p[3],v,null):Lt(p[3]),null),(!o||v&4&&y!==(y=`width: ${p[2]}`))&&M(_,"style",y),p[1]?d&&(d.d(1),d=null):d||(d=Sr(),d.c(),d.m(t,null)),(!o||v&4&&n!==(n=`width: ${p[2]}`))&&M(t,"style",n)},i(p){o||(le(a,p),o=!0)},o(p){fe(a,p),o=!1},d(p){p&&se(e),p&&se(m),p&&se(_),a&&a.d(p),p&&se(h),p&&se(t),d&&d.d()}}}function vu(r,e,u){let g,m;De(r,jt,t=>u(2,m=t));let{$$slots:_={},$$scope:y}=e,{title:h=""}=e;return r.$$set=t=>{"title"in t&&u(0,h=t.title),"$$scope"in t&&u(3,y=t.$$scope)},u(1,g=window.location.hostname==="localhost"),[h,g,m,y,_]}class _u extends Ae{constructor(e){super(),Ee(this,e,vu,mu,xe,{title:0})}}function yu(r){let e,u,g,m;return g=new pu({}),{c(){e=ee("div"),e.innerHTML='<canvas id="canvas" width="2400" height="2400" style="border:1px solid #ccc"></canvas>',u=ge(),be(g.$$.fragment),M(e,"class","svelte-6rw8tu"),Re(e,"isDisableCanvas",r[0])},m(_,y){ae(_,e,y),ae(_,u,y),ve(g,_,y),m=!0},p(_,y){(!m||y&1)&&Re(e,"isDisableCanvas",_[0])},i(_){m||(le(g.$$.fragment,_),m=!0)},o(_){fe(g.$$.fragment,_),m=!1},d(_){_&&se(e),_&&se(u),_e(g,_)}}}function bu(r){let e,u;return e=new _u({props:{title:"~개발진스 짤 만들어 쓰기~",$$slots:{default:[yu]},$$scope:{ctx:r}}}),{c(){be(e.$$.fragment)},m(g,m){ve(e,g,m),u=!0},p(g,[m]){const _={};m&129&&(_.$$scope={dirty:m,ctx:g}),e.$set(_)},i(g){u||(le(e.$$.fragment,g),u=!0)},o(g){fe(e.$$.fragment,g),u=!1},d(g){_e(e,g)}}}function Cu(r,e,u){let g,m,_,y,h;De(r,ze,l=>u(1,m=l)),De(r,tn,l=>u(2,_=l)),De(r,gi,l=>u(3,y=l)),De(r,jt,l=>u(4,h=l));const t=()=>window.innerWidth<600?window.innerWidth:600;return Ht(()=>{Xe(ze,m=new gt.fabric.Canvas("canvas"),m),Xe(jt,h=t(),h),m.setWidth(h*m.getZoom()),m.setHeight(h*m.getZoom()),gt.fabric.Image.fromURL(Ql,function(l){l.scaleToWidth(h),l.scaleToWidth(h),l.selectable=!1,l.set("itemType","bunny"),m.add(l),m.renderAll()},{crossOrigin:"anonymous"})}),r.$$.update=()=>{if(r.$$.dirty&4&&u(0,g=_!==nt.Photo&&_!==nt.Drawing),r.$$.dirty&3&&(g||m.renderAll()),r.$$.dirty&10&&m&&(m.setBackgroundImage(null,m.renderAll.bind(m)),m.setBackgroundColor(y,()=>{m.renderAll()})),r.$$.dirty&6&&m&&_){const l=m.getObjects();m.discardActiveObject(),_===nt.Background?l.filter(s=>s.itemType!=="background").forEach(s=>{s.opacity=.5}):l.filter(s=>s.itemType!=="background").forEach(s=>{s.opacity=1}),m.renderAll()}},[g,m,_,y]}class wu extends Ae{constructor(e){super(),Ee(this,e,Cu,bu,xe,{})}}function Su(r){let e,u;return e=new wu({}),{c(){be(e.$$.fragment)},m(g,m){ve(e,g,m),u=!0},p:ye,i(g){u||(le(e.$$.fragment,g),u=!0)},o(g){fe(e.$$.fragment,g),u=!1},d(g){_e(e,g)}}}class Tu extends Ae{constructor(e){super(),Ee(this,e,null,Su,xe,{})}}function xs(r,e){return function(){return r.apply(e,arguments)}}const{toString:Os}=Object.prototype,{getPrototypeOf:_n}=Object,yn=(r=>e=>{const u=Os.call(e);return r[u]||(r[u]=u.slice(8,-1).toLowerCase())})(Object.create(null)),ot=r=>(r=r.toLowerCase(),e=>yn(e)===r),Ci=r=>e=>typeof e===r,{isArray:Wt}=Array,Zt=Ci("undefined");function xu(r){return r!==null&&!Zt(r)&&r.constructor!==null&&!Zt(r.constructor)&&pt(r.constructor.isBuffer)&&r.constructor.isBuffer(r)}const Es=ot("ArrayBuffer");function Ou(r){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(r):e=r&&r.buffer&&Es(r.buffer),e}const Eu=Ci("string"),pt=Ci("function"),As=Ci("number"),bn=r=>r!==null&&typeof r=="object",Au=r=>r===!0||r===!1,ai=r=>{if(yn(r)!=="object")return!1;const e=_n(r);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in r)&&!(Symbol.iterator in r)},ku=ot("Date"),Du=ot("File"),Pu=ot("Blob"),Mu=ot("FileList"),Iu=r=>bn(r)&&pt(r.pipe),Fu=r=>{const e="[object FormData]";return r&&(typeof FormData=="function"&&r instanceof FormData||Os.call(r)===e||pt(r.toString)&&r.toString()===e)},Ru=ot("URLSearchParams"),Lu=r=>r.trim?r.trim():r.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function $t(r,e,{allOwnKeys:u=!1}={}){if(r===null||typeof r>"u")return;let g,m;if(typeof r!="object"&&(r=[r]),Wt(r))for(g=0,m=r.length;g<m;g++)e.call(null,r[g],g,r);else{const _=u?Object.getOwnPropertyNames(r):Object.keys(r),y=_.length;let h;for(g=0;g<y;g++)h=_[g],e.call(null,r[h],h,r)}}function ks(r,e){e=e.toLowerCase();const u=Object.keys(r);let g=u.length,m;for(;g-- >0;)if(m=u[g],e===m.toLowerCase())return m;return null}const Ds=(()=>typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global)(),Ps=r=>!Zt(r)&&r!==Ds;function nn(){const{caseless:r}=Ps(this)&&this||{},e={},u=(g,m)=>{const _=r&&ks(e,m)||m;ai(e[_])&&ai(g)?e[_]=nn(e[_],g):ai(g)?e[_]=nn({},g):Wt(g)?e[_]=g.slice():e[_]=g};for(let g=0,m=arguments.length;g<m;g++)arguments[g]&&$t(arguments[g],u);return e}const Bu=(r,e,u,{allOwnKeys:g}={})=>($t(e,(m,_)=>{u&&pt(m)?r[_]=xs(m,u):r[_]=m},{allOwnKeys:g}),r),ju=r=>(r.charCodeAt(0)===65279&&(r=r.slice(1)),r),Nu=(r,e,u,g)=>{r.prototype=Object.create(e.prototype,g),r.prototype.constructor=r,Object.defineProperty(r,"super",{value:e.prototype}),u&&Object.assign(r.prototype,u)},Hu=(r,e,u,g)=>{let m,_,y;const h={};if(e=e||{},r==null)return e;do{for(m=Object.getOwnPropertyNames(r),_=m.length;_-- >0;)y=m[_],(!g||g(y,r,e))&&!h[y]&&(e[y]=r[y],h[y]=!0);r=u!==!1&&_n(r)}while(r&&(!u||u(r,e))&&r!==Object.prototype);return e},Wu=(r,e,u)=>{r=String(r),(u===void 0||u>r.length)&&(u=r.length),u-=e.length;const g=r.indexOf(e,u);return g!==-1&&g===u},Xu=r=>{if(!r)return null;if(Wt(r))return r;let e=r.length;if(!As(e))return null;const u=new Array(e);for(;e-- >0;)u[e]=r[e];return u},Uu=(r=>e=>r&&e instanceof r)(typeof Uint8Array<"u"&&_n(Uint8Array)),zu=(r,e)=>{const g=(r&&r[Symbol.iterator]).call(r);let m;for(;(m=g.next())&&!m.done;){const _=m.value;e.call(r,_[0],_[1])}},Yu=(r,e)=>{let u;const g=[];for(;(u=r.exec(e))!==null;)g.push(u);return g},Vu=ot("HTMLFormElement"),Gu=r=>r.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(u,g,m){return g.toUpperCase()+m}),Tr=(({hasOwnProperty:r})=>(e,u)=>r.call(e,u))(Object.prototype),qu=ot("RegExp"),Ms=(r,e)=>{const u=Object.getOwnPropertyDescriptors(r),g={};$t(u,(m,_)=>{e(m,_,r)!==!1&&(g[_]=m)}),Object.defineProperties(r,g)},Ku=r=>{Ms(r,(e,u)=>{if(pt(r)&&["arguments","caller","callee"].indexOf(u)!==-1)return!1;const g=r[u];if(pt(g)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+u+"'")})}})},Ju=(r,e)=>{const u={},g=m=>{m.forEach(_=>{u[_]=!0})};return Wt(r)?g(r):g(String(r).split(e)),u},Qu=()=>{},Zu=(r,e)=>(r=+r,Number.isFinite(r)?r:e),Ni="abcdefghijklmnopqrstuvwxyz",xr="0123456789",Is={DIGIT:xr,ALPHA:Ni,ALPHA_DIGIT:Ni+Ni.toUpperCase()+xr},$u=(r=16,e=Is.ALPHA_DIGIT)=>{let u="";const{length:g}=e;for(;r--;)u+=e[Math.random()*g|0];return u};function ef(r){return!!(r&&pt(r.append)&&r[Symbol.toStringTag]==="FormData"&&r[Symbol.iterator])}const tf=r=>{const e=new Array(10),u=(g,m)=>{if(bn(g)){if(e.indexOf(g)>=0)return;if(!("toJSON"in g)){e[m]=g;const _=Wt(g)?[]:{};return $t(g,(y,h)=>{const t=u(y,m+1);!Zt(t)&&(_[h]=t)}),e[m]=void 0,_}}return g};return u(r,0)},G={isArray:Wt,isArrayBuffer:Es,isBuffer:xu,isFormData:Fu,isArrayBufferView:Ou,isString:Eu,isNumber:As,isBoolean:Au,isObject:bn,isPlainObject:ai,isUndefined:Zt,isDate:ku,isFile:Du,isBlob:Pu,isRegExp:qu,isFunction:pt,isStream:Iu,isURLSearchParams:Ru,isTypedArray:Uu,isFileList:Mu,forEach:$t,merge:nn,extend:Bu,trim:Lu,stripBOM:ju,inherits:Nu,toFlatObject:Hu,kindOf:yn,kindOfTest:ot,endsWith:Wu,toArray:Xu,forEachEntry:zu,matchAll:Yu,isHTMLForm:Vu,hasOwnProperty:Tr,hasOwnProp:Tr,reduceDescriptors:Ms,freezeMethods:Ku,toObjectSet:Ju,toCamelCase:Gu,noop:Qu,toFiniteNumber:Zu,findKey:ks,global:Ds,isContextDefined:Ps,ALPHABET:Is,generateString:$u,isSpecCompliantForm:ef,toJSONObject:tf};function we(r,e,u,g,m){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=r,this.name="AxiosError",e&&(this.code=e),u&&(this.config=u),g&&(this.request=g),m&&(this.response=m)}G.inherits(we,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:G.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const Fs=we.prototype,Rs={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(r=>{Rs[r]={value:r}});Object.defineProperties(we,Rs);Object.defineProperty(Fs,"isAxiosError",{value:!0});we.from=(r,e,u,g,m,_)=>{const y=Object.create(Fs);return G.toFlatObject(r,y,function(t){return t!==Error.prototype},h=>h!=="isAxiosError"),we.call(y,r.message,e,u,g,m),y.cause=r,y.name=r.name,_&&Object.assign(y,_),y};const nf=null;function rn(r){return G.isPlainObject(r)||G.isArray(r)}function Ls(r){return G.endsWith(r,"[]")?r.slice(0,-2):r}function Or(r,e,u){return r?r.concat(e).map(function(m,_){return m=Ls(m),!u&&_?"["+m+"]":m}).join(u?".":""):e}function rf(r){return G.isArray(r)&&!r.some(rn)}const sf=G.toFlatObject(G,{},null,function(e){return/^is[A-Z]/.test(e)});function wi(r,e,u){if(!G.isObject(r))throw new TypeError("target must be an object");e=e||new FormData,u=G.toFlatObject(u,{metaTokens:!0,dots:!1,indexes:!1},!1,function(f,a){return!G.isUndefined(a[f])});const g=u.metaTokens,m=u.visitor||l,_=u.dots,y=u.indexes,t=(u.Blob||typeof Blob<"u"&&Blob)&&G.isSpecCompliantForm(e);if(!G.isFunction(m))throw new TypeError("visitor must be a function");function c(o){if(o===null)return"";if(G.isDate(o))return o.toISOString();if(!t&&G.isBlob(o))throw new we("Blob is not supported. Use a Buffer instead.");return G.isArrayBuffer(o)||G.isTypedArray(o)?t&&typeof Blob=="function"?new Blob([o]):Buffer.from(o):o}function l(o,f,a){let d=o;if(o&&!a&&typeof o=="object"){if(G.endsWith(f,"{}"))f=g?f:f.slice(0,-2),o=JSON.stringify(o);else if(G.isArray(o)&&rf(o)||(G.isFileList(o)||G.endsWith(f,"[]"))&&(d=G.toArray(o)))return f=Ls(f),d.forEach(function(v,b){!(G.isUndefined(v)||v===null)&&e.append(y===!0?Or([f],b,_):y===null?f:f+"[]",c(v))}),!1}return rn(o)?!0:(e.append(Or(a,f,_),c(o)),!1)}const i=[],s=Object.assign(sf,{defaultVisitor:l,convertValue:c,isVisitable:rn});function n(o,f){if(!G.isUndefined(o)){if(i.indexOf(o)!==-1)throw Error("Circular reference detected in "+f.join("."));i.push(o),G.forEach(o,function(d,p){(!(G.isUndefined(d)||d===null)&&m.call(e,d,G.isString(p)?p.trim():p,f,s))===!0&&n(d,f?f.concat(p):[p])}),i.pop()}}if(!G.isObject(r))throw new TypeError("data must be an object");return n(r),e}function Er(r){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(r).replace(/[!'()~]|%20|%00/g,function(g){return e[g]})}function Cn(r,e){this._pairs=[],r&&wi(r,this,e)}const Bs=Cn.prototype;Bs.append=function(e,u){this._pairs.push([e,u])};Bs.toString=function(e){const u=e?function(g){return e.call(this,g,Er)}:Er;return this._pairs.map(function(m){return u(m[0])+"="+u(m[1])},"").join("&")};function af(r){return encodeURIComponent(r).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function js(r,e,u){if(!e)return r;const g=u&&u.encode||af,m=u&&u.serialize;let _;if(m?_=m(e,u):_=G.isURLSearchParams(e)?e.toString():new Cn(e,u).toString(g),_){const y=r.indexOf("#");y!==-1&&(r=r.slice(0,y)),r+=(r.indexOf("?")===-1?"?":"&")+_}return r}class of{constructor(){this.handlers=[]}use(e,u,g){return this.handlers.push({fulfilled:e,rejected:u,synchronous:g?g.synchronous:!1,runWhen:g?g.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){G.forEach(this.handlers,function(g){g!==null&&e(g)})}}const Ar=of,Ns={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},lf=typeof URLSearchParams<"u"?URLSearchParams:Cn,cf=typeof FormData<"u"?FormData:null,hf=typeof Blob<"u"?Blob:null,uf=(()=>{let r;return typeof navigator<"u"&&((r=navigator.product)==="ReactNative"||r==="NativeScript"||r==="NS")?!1:typeof window<"u"&&typeof document<"u"})(),ff=(()=>typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),$e={isBrowser:!0,classes:{URLSearchParams:lf,FormData:cf,Blob:hf},isStandardBrowserEnv:uf,isStandardBrowserWebWorkerEnv:ff,protocols:["http","https","file","blob","url","data"]};function df(r,e){return wi(r,new $e.classes.URLSearchParams,Object.assign({visitor:function(u,g,m,_){return $e.isNode&&G.isBuffer(u)?(this.append(g,u.toString("base64")),!1):_.defaultVisitor.apply(this,arguments)}},e))}function gf(r){return G.matchAll(/\w+|\[(\w*)]/g,r).map(e=>e[0]==="[]"?"":e[1]||e[0])}function pf(r){const e={},u=Object.keys(r);let g;const m=u.length;let _;for(g=0;g<m;g++)_=u[g],e[_]=r[_];return e}function Hs(r){function e(u,g,m,_){let y=u[_++];const h=Number.isFinite(+y),t=_>=u.length;return y=!y&&G.isArray(m)?m.length:y,t?(G.hasOwnProp(m,y)?m[y]=[m[y],g]:m[y]=g,!h):((!m[y]||!G.isObject(m[y]))&&(m[y]=[]),e(u,g,m[y],_)&&G.isArray(m[y])&&(m[y]=pf(m[y])),!h)}if(G.isFormData(r)&&G.isFunction(r.entries)){const u={};return G.forEachEntry(r,(g,m)=>{e(gf(g),m,u,0)}),u}return null}const mf={"Content-Type":void 0};function vf(r,e,u){if(G.isString(r))try{return(e||JSON.parse)(r),G.trim(r)}catch(g){if(g.name!=="SyntaxError")throw g}return(u||JSON.stringify)(r)}const Si={transitional:Ns,adapter:["xhr","http"],transformRequest:[function(e,u){const g=u.getContentType()||"",m=g.indexOf("application/json")>-1,_=G.isObject(e);if(_&&G.isHTMLForm(e)&&(e=new FormData(e)),G.isFormData(e))return m&&m?JSON.stringify(Hs(e)):e;if(G.isArrayBuffer(e)||G.isBuffer(e)||G.isStream(e)||G.isFile(e)||G.isBlob(e))return e;if(G.isArrayBufferView(e))return e.buffer;if(G.isURLSearchParams(e))return u.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let h;if(_){if(g.indexOf("application/x-www-form-urlencoded")>-1)return df(e,this.formSerializer).toString();if((h=G.isFileList(e))||g.indexOf("multipart/form-data")>-1){const t=this.env&&this.env.FormData;return wi(h?{"files[]":e}:e,t&&new t,this.formSerializer)}}return _||m?(u.setContentType("application/json",!1),vf(e)):e}],transformResponse:[function(e){const u=this.transitional||Si.transitional,g=u&&u.forcedJSONParsing,m=this.responseType==="json";if(e&&G.isString(e)&&(g&&!this.responseType||m)){const y=!(u&&u.silentJSONParsing)&&m;try{return JSON.parse(e)}catch(h){if(y)throw h.name==="SyntaxError"?we.from(h,we.ERR_BAD_RESPONSE,this,null,this.response):h}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:$e.classes.FormData,Blob:$e.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};G.forEach(["delete","get","head"],function(e){Si.headers[e]={}});G.forEach(["post","put","patch"],function(e){Si.headers[e]=G.merge(mf)});const wn=Si,_f=G.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),yf=r=>{const e={};let u,g,m;return r&&r.split(`
`).forEach(function(y){m=y.indexOf(":"),u=y.substring(0,m).trim().toLowerCase(),g=y.substring(m+1).trim(),!(!u||e[u]&&_f[u])&&(u==="set-cookie"?e[u]?e[u].push(g):e[u]=[g]:e[u]=e[u]?e[u]+", "+g:g)}),e},kr=Symbol("internals");function zt(r){return r&&String(r).trim().toLowerCase()}function oi(r){return r===!1||r==null?r:G.isArray(r)?r.map(oi):String(r)}function bf(r){const e=Object.create(null),u=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let g;for(;g=u.exec(r);)e[g[1]]=g[2];return e}function Cf(r){return/^[-_a-zA-Z]+$/.test(r.trim())}function Hi(r,e,u,g,m){if(G.isFunction(g))return g.call(this,e,u);if(m&&(e=u),!!G.isString(e)){if(G.isString(g))return e.indexOf(g)!==-1;if(G.isRegExp(g))return g.test(e)}}function wf(r){return r.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,u,g)=>u.toUpperCase()+g)}function Sf(r,e){const u=G.toCamelCase(" "+e);["get","set","has"].forEach(g=>{Object.defineProperty(r,g+u,{value:function(m,_,y){return this[g].call(this,e,m,_,y)},configurable:!0})})}class Ti{constructor(e){e&&this.set(e)}set(e,u,g){const m=this;function _(h,t,c){const l=zt(t);if(!l)throw new Error("header name must be a non-empty string");const i=G.findKey(m,l);(!i||m[i]===void 0||c===!0||c===void 0&&m[i]!==!1)&&(m[i||t]=oi(h))}const y=(h,t)=>G.forEach(h,(c,l)=>_(c,l,t));return G.isPlainObject(e)||e instanceof this.constructor?y(e,u):G.isString(e)&&(e=e.trim())&&!Cf(e)?y(yf(e),u):e!=null&&_(u,e,g),this}get(e,u){if(e=zt(e),e){const g=G.findKey(this,e);if(g){const m=this[g];if(!u)return m;if(u===!0)return bf(m);if(G.isFunction(u))return u.call(this,m,g);if(G.isRegExp(u))return u.exec(m);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,u){if(e=zt(e),e){const g=G.findKey(this,e);return!!(g&&this[g]!==void 0&&(!u||Hi(this,this[g],g,u)))}return!1}delete(e,u){const g=this;let m=!1;function _(y){if(y=zt(y),y){const h=G.findKey(g,y);h&&(!u||Hi(g,g[h],h,u))&&(delete g[h],m=!0)}}return G.isArray(e)?e.forEach(_):_(e),m}clear(e){const u=Object.keys(this);let g=u.length,m=!1;for(;g--;){const _=u[g];(!e||Hi(this,this[_],_,e,!0))&&(delete this[_],m=!0)}return m}normalize(e){const u=this,g={};return G.forEach(this,(m,_)=>{const y=G.findKey(g,_);if(y){u[y]=oi(m),delete u[_];return}const h=e?wf(_):String(_).trim();h!==_&&delete u[_],u[h]=oi(m),g[h]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const u=Object.create(null);return G.forEach(this,(g,m)=>{g!=null&&g!==!1&&(u[m]=e&&G.isArray(g)?g.join(", "):g)}),u}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,u])=>e+": "+u).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...u){const g=new this(e);return u.forEach(m=>g.set(m)),g}static accessor(e){const g=(this[kr]=this[kr]={accessors:{}}).accessors,m=this.prototype;function _(y){const h=zt(y);g[h]||(Sf(m,y),g[h]=!0)}return G.isArray(e)?e.forEach(_):_(e),this}}Ti.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);G.freezeMethods(Ti.prototype);G.freezeMethods(Ti);const at=Ti;function Wi(r,e){const u=this||wn,g=e||u,m=at.from(g.headers);let _=g.data;return G.forEach(r,function(h){_=h.call(u,_,m.normalize(),e?e.status:void 0)}),m.normalize(),_}function Ws(r){return!!(r&&r.__CANCEL__)}function ei(r,e,u){we.call(this,r??"canceled",we.ERR_CANCELED,e,u),this.name="CanceledError"}G.inherits(ei,we,{__CANCEL__:!0});function Tf(r,e,u){const g=u.config.validateStatus;!u.status||!g||g(u.status)?r(u):e(new we("Request failed with status code "+u.status,[we.ERR_BAD_REQUEST,we.ERR_BAD_RESPONSE][Math.floor(u.status/100)-4],u.config,u.request,u))}const xf=$e.isStandardBrowserEnv?function(){return{write:function(u,g,m,_,y,h){const t=[];t.push(u+"="+encodeURIComponent(g)),G.isNumber(m)&&t.push("expires="+new Date(m).toGMTString()),G.isString(_)&&t.push("path="+_),G.isString(y)&&t.push("domain="+y),h===!0&&t.push("secure"),document.cookie=t.join("; ")},read:function(u){const g=document.cookie.match(new RegExp("(^|;\\s*)("+u+")=([^;]*)"));return g?decodeURIComponent(g[3]):null},remove:function(u){this.write(u,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}();function Of(r){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(r)}function Ef(r,e){return e?r.replace(/\/+$/,"")+"/"+e.replace(/^\/+/,""):r}function Xs(r,e){return r&&!Of(e)?Ef(r,e):e}const Af=$e.isStandardBrowserEnv?function(){const e=/(msie|trident)/i.test(navigator.userAgent),u=document.createElement("a");let g;function m(_){let y=_;return e&&(u.setAttribute("href",y),y=u.href),u.setAttribute("href",y),{href:u.href,protocol:u.protocol?u.protocol.replace(/:$/,""):"",host:u.host,search:u.search?u.search.replace(/^\?/,""):"",hash:u.hash?u.hash.replace(/^#/,""):"",hostname:u.hostname,port:u.port,pathname:u.pathname.charAt(0)==="/"?u.pathname:"/"+u.pathname}}return g=m(window.location.href),function(y){const h=G.isString(y)?m(y):y;return h.protocol===g.protocol&&h.host===g.host}}():function(){return function(){return!0}}();function kf(r){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(r);return e&&e[1]||""}function Df(r,e){r=r||10;const u=new Array(r),g=new Array(r);let m=0,_=0,y;return e=e!==void 0?e:1e3,function(t){const c=Date.now(),l=g[_];y||(y=c),u[m]=t,g[m]=c;let i=_,s=0;for(;i!==m;)s+=u[i++],i=i%r;if(m=(m+1)%r,m===_&&(_=(_+1)%r),c-y<e)return;const n=l&&c-l;return n?Math.round(s*1e3/n):void 0}}function Dr(r,e){let u=0;const g=Df(50,250);return m=>{const _=m.loaded,y=m.lengthComputable?m.total:void 0,h=_-u,t=g(h),c=_<=y;u=_;const l={loaded:_,total:y,progress:y?_/y:void 0,bytes:h,rate:t||void 0,estimated:t&&y&&c?(y-_)/t:void 0,event:m};l[e?"download":"upload"]=!0,r(l)}}const Pf=typeof XMLHttpRequest<"u",Mf=Pf&&function(r){return new Promise(function(u,g){let m=r.data;const _=at.from(r.headers).normalize(),y=r.responseType;let h;function t(){r.cancelToken&&r.cancelToken.unsubscribe(h),r.signal&&r.signal.removeEventListener("abort",h)}G.isFormData(m)&&($e.isStandardBrowserEnv||$e.isStandardBrowserWebWorkerEnv)&&_.setContentType(!1);let c=new XMLHttpRequest;if(r.auth){const n=r.auth.username||"",o=r.auth.password?unescape(encodeURIComponent(r.auth.password)):"";_.set("Authorization","Basic "+btoa(n+":"+o))}const l=Xs(r.baseURL,r.url);c.open(r.method.toUpperCase(),js(l,r.params,r.paramsSerializer),!0),c.timeout=r.timeout;function i(){if(!c)return;const n=at.from("getAllResponseHeaders"in c&&c.getAllResponseHeaders()),f={data:!y||y==="text"||y==="json"?c.responseText:c.response,status:c.status,statusText:c.statusText,headers:n,config:r,request:c};Tf(function(d){u(d),t()},function(d){g(d),t()},f),c=null}if("onloadend"in c?c.onloadend=i:c.onreadystatechange=function(){!c||c.readyState!==4||c.status===0&&!(c.responseURL&&c.responseURL.indexOf("file:")===0)||setTimeout(i)},c.onabort=function(){c&&(g(new we("Request aborted",we.ECONNABORTED,r,c)),c=null)},c.onerror=function(){g(new we("Network Error",we.ERR_NETWORK,r,c)),c=null},c.ontimeout=function(){let o=r.timeout?"timeout of "+r.timeout+"ms exceeded":"timeout exceeded";const f=r.transitional||Ns;r.timeoutErrorMessage&&(o=r.timeoutErrorMessage),g(new we(o,f.clarifyTimeoutError?we.ETIMEDOUT:we.ECONNABORTED,r,c)),c=null},$e.isStandardBrowserEnv){const n=(r.withCredentials||Af(l))&&r.xsrfCookieName&&xf.read(r.xsrfCookieName);n&&_.set(r.xsrfHeaderName,n)}m===void 0&&_.setContentType(null),"setRequestHeader"in c&&G.forEach(_.toJSON(),function(o,f){c.setRequestHeader(f,o)}),G.isUndefined(r.withCredentials)||(c.withCredentials=!!r.withCredentials),y&&y!=="json"&&(c.responseType=r.responseType),typeof r.onDownloadProgress=="function"&&c.addEventListener("progress",Dr(r.onDownloadProgress,!0)),typeof r.onUploadProgress=="function"&&c.upload&&c.upload.addEventListener("progress",Dr(r.onUploadProgress)),(r.cancelToken||r.signal)&&(h=n=>{c&&(g(!n||n.type?new ei(null,r,c):n),c.abort(),c=null)},r.cancelToken&&r.cancelToken.subscribe(h),r.signal&&(r.signal.aborted?h():r.signal.addEventListener("abort",h)));const s=kf(l);if(s&&$e.protocols.indexOf(s)===-1){g(new we("Unsupported protocol "+s+":",we.ERR_BAD_REQUEST,r));return}c.send(m||null)})},li={http:nf,xhr:Mf};G.forEach(li,(r,e)=>{if(r){try{Object.defineProperty(r,"name",{value:e})}catch{}Object.defineProperty(r,"adapterName",{value:e})}});const If={getAdapter:r=>{r=G.isArray(r)?r:[r];const{length:e}=r;let u,g;for(let m=0;m<e&&(u=r[m],!(g=G.isString(u)?li[u.toLowerCase()]:u));m++);if(!g)throw g===!1?new we(`Adapter ${u} is not supported by the environment`,"ERR_NOT_SUPPORT"):new Error(G.hasOwnProp(li,u)?`Adapter '${u}' is not available in the build`:`Unknown adapter '${u}'`);if(!G.isFunction(g))throw new TypeError("adapter is not a function");return g},adapters:li};function Xi(r){if(r.cancelToken&&r.cancelToken.throwIfRequested(),r.signal&&r.signal.aborted)throw new ei(null,r)}function Pr(r){return Xi(r),r.headers=at.from(r.headers),r.data=Wi.call(r,r.transformRequest),["post","put","patch"].indexOf(r.method)!==-1&&r.headers.setContentType("application/x-www-form-urlencoded",!1),If.getAdapter(r.adapter||wn.adapter)(r).then(function(g){return Xi(r),g.data=Wi.call(r,r.transformResponse,g),g.headers=at.from(g.headers),g},function(g){return Ws(g)||(Xi(r),g&&g.response&&(g.response.data=Wi.call(r,r.transformResponse,g.response),g.response.headers=at.from(g.response.headers))),Promise.reject(g)})}const Mr=r=>r instanceof at?r.toJSON():r;function Nt(r,e){e=e||{};const u={};function g(c,l,i){return G.isPlainObject(c)&&G.isPlainObject(l)?G.merge.call({caseless:i},c,l):G.isPlainObject(l)?G.merge({},l):G.isArray(l)?l.slice():l}function m(c,l,i){if(G.isUndefined(l)){if(!G.isUndefined(c))return g(void 0,c,i)}else return g(c,l,i)}function _(c,l){if(!G.isUndefined(l))return g(void 0,l)}function y(c,l){if(G.isUndefined(l)){if(!G.isUndefined(c))return g(void 0,c)}else return g(void 0,l)}function h(c,l,i){if(i in e)return g(c,l);if(i in r)return g(void 0,c)}const t={url:_,method:_,data:_,baseURL:y,transformRequest:y,transformResponse:y,paramsSerializer:y,timeout:y,timeoutMessage:y,withCredentials:y,adapter:y,responseType:y,xsrfCookieName:y,xsrfHeaderName:y,onUploadProgress:y,onDownloadProgress:y,decompress:y,maxContentLength:y,maxBodyLength:y,beforeRedirect:y,transport:y,httpAgent:y,httpsAgent:y,cancelToken:y,socketPath:y,responseEncoding:y,validateStatus:h,headers:(c,l)=>m(Mr(c),Mr(l),!0)};return G.forEach(Object.keys(r).concat(Object.keys(e)),function(l){const i=t[l]||m,s=i(r[l],e[l],l);G.isUndefined(s)&&i!==h||(u[l]=s)}),u}const Us="1.3.4",Sn={};["object","boolean","number","function","string","symbol"].forEach((r,e)=>{Sn[r]=function(g){return typeof g===r||"a"+(e<1?"n ":" ")+r}});const Ir={};Sn.transitional=function(e,u,g){function m(_,y){return"[Axios v"+Us+"] Transitional option '"+_+"'"+y+(g?". "+g:"")}return(_,y,h)=>{if(e===!1)throw new we(m(y," has been removed"+(u?" in "+u:"")),we.ERR_DEPRECATED);return u&&!Ir[y]&&(Ir[y]=!0,console.warn(m(y," has been deprecated since v"+u+" and will be removed in the near future"))),e?e(_,y,h):!0}};function Ff(r,e,u){if(typeof r!="object")throw new we("options must be an object",we.ERR_BAD_OPTION_VALUE);const g=Object.keys(r);let m=g.length;for(;m-- >0;){const _=g[m],y=e[_];if(y){const h=r[_],t=h===void 0||y(h,_,r);if(t!==!0)throw new we("option "+_+" must be "+t,we.ERR_BAD_OPTION_VALUE);continue}if(u!==!0)throw new we("Unknown option "+_,we.ERR_BAD_OPTION)}}const sn={assertOptions:Ff,validators:Sn},lt=sn.validators;class pi{constructor(e){this.defaults=e,this.interceptors={request:new Ar,response:new Ar}}request(e,u){typeof e=="string"?(u=u||{},u.url=e):u=e||{},u=Nt(this.defaults,u);const{transitional:g,paramsSerializer:m,headers:_}=u;g!==void 0&&sn.assertOptions(g,{silentJSONParsing:lt.transitional(lt.boolean),forcedJSONParsing:lt.transitional(lt.boolean),clarifyTimeoutError:lt.transitional(lt.boolean)},!1),m!==void 0&&sn.assertOptions(m,{encode:lt.function,serialize:lt.function},!0),u.method=(u.method||this.defaults.method||"get").toLowerCase();let y;y=_&&G.merge(_.common,_[u.method]),y&&G.forEach(["delete","get","head","post","put","patch","common"],o=>{delete _[o]}),u.headers=at.concat(y,_);const h=[];let t=!0;this.interceptors.request.forEach(function(f){typeof f.runWhen=="function"&&f.runWhen(u)===!1||(t=t&&f.synchronous,h.unshift(f.fulfilled,f.rejected))});const c=[];this.interceptors.response.forEach(function(f){c.push(f.fulfilled,f.rejected)});let l,i=0,s;if(!t){const o=[Pr.bind(this),void 0];for(o.unshift.apply(o,h),o.push.apply(o,c),s=o.length,l=Promise.resolve(u);i<s;)l=l.then(o[i++],o[i++]);return l}s=h.length;let n=u;for(i=0;i<s;){const o=h[i++],f=h[i++];try{n=o(n)}catch(a){f.call(this,a);break}}try{l=Pr.call(this,n)}catch(o){return Promise.reject(o)}for(i=0,s=c.length;i<s;)l=l.then(c[i++],c[i++]);return l}getUri(e){e=Nt(this.defaults,e);const u=Xs(e.baseURL,e.url);return js(u,e.params,e.paramsSerializer)}}G.forEach(["delete","get","head","options"],function(e){pi.prototype[e]=function(u,g){return this.request(Nt(g||{},{method:e,url:u,data:(g||{}).data}))}});G.forEach(["post","put","patch"],function(e){function u(g){return function(_,y,h){return this.request(Nt(h||{},{method:e,headers:g?{"Content-Type":"multipart/form-data"}:{},url:_,data:y}))}}pi.prototype[e]=u(),pi.prototype[e+"Form"]=u(!0)});const ci=pi;class Tn{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let u;this.promise=new Promise(function(_){u=_});const g=this;this.promise.then(m=>{if(!g._listeners)return;let _=g._listeners.length;for(;_-- >0;)g._listeners[_](m);g._listeners=null}),this.promise.then=m=>{let _;const y=new Promise(h=>{g.subscribe(h),_=h}).then(m);return y.cancel=function(){g.unsubscribe(_)},y},e(function(_,y,h){g.reason||(g.reason=new ei(_,y,h),u(g.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const u=this._listeners.indexOf(e);u!==-1&&this._listeners.splice(u,1)}static source(){let e;return{token:new Tn(function(m){e=m}),cancel:e}}}const Rf=Tn;function Lf(r){return function(u){return r.apply(null,u)}}function Bf(r){return G.isObject(r)&&r.isAxiosError===!0}const an={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(an).forEach(([r,e])=>{an[e]=r});const jf=an;function zs(r){const e=new ci(r),u=xs(ci.prototype.request,e);return G.extend(u,ci.prototype,e,{allOwnKeys:!0}),G.extend(u,e,null,{allOwnKeys:!0}),u.create=function(m){return zs(Nt(r,m))},u}const je=zs(wn);je.Axios=ci;je.CanceledError=ei;je.CancelToken=Rf;je.isCancel=Ws;je.VERSION=Us;je.toFormData=wi;je.AxiosError=we;je.Cancel=je.CanceledError;je.all=function(e){return Promise.all(e)};je.spread=Lf;je.isAxiosError=Bf;je.mergeConfig=Nt;je.AxiosHeaders=at;je.formToJSON=r=>Hs(G.isHTMLForm(r)?new FormData(r):r);je.HttpStatusCode=jf;je.default=je;const Nf=je;Nf.defaults.withCredentials=!0;new Tu({target:document.getElementById("app")});
